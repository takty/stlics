var N=class{#e=-1;#t="";userObject=null;solverObject=null;setIndex(e){this.#e=e}setName(e){this.#t=e}index(){return this.#e}name(){return this.#t}};var w=class u extends N{static#e=Number.MIN_VALUE;#t;#r;#i=u.#e;#n=[];constructor(e,t){super(),this.#t=e,this.#r=t}toString(){let e=this.name(),t=e?`(${e})`:"",r=this.isEmpty()?"<empty>":""+this.value();return`x${this.index()}${t} = ${r}`}size(){return this.#n.length}at(e){return this.#n.at(e)}has(e){return this.#n.includes(e)}indexOf(e){return this.#n.indexOf(e)}neighbors(){let e=[];for(let t of this.#n)for(let r of t)r!==this&&e.push(r);return e}[Symbol.iterator](){return this.#n[Symbol.iterator]()}owner(){return this.#t}connect(e){if(this.#n.includes(e))throw new RangeError;this.#n.push(e)}disconnect(e){if(!this.#n.includes(e))throw new RangeError;this.#n=this.#n.filter(t=>t!==e)}domain(e){if(e===void 0)return this.#r;this.#r=e,this.clear()}assign(e){this.#i=e}clear(){this.assign(u.#e)}value(){return this.#i}isEmpty(){return this.value()===u.#e}};var z=class{random(){return this.at(Math.floor(Math.random()*this.size()))}};var k=class extends z{#e;#t;constructor(e,t){super(),this.#e=e|0,this.#t=t|0}contains(e){return this.#e<=e&&e<=this.#t}indexOf(e){return this.#e<=e&&e<=this.#t?e-this.#e:-1}size(){return this.#t-this.#e+1}at(e){return this.#e+e}[Symbol.iterator](){let e=this.#e,t=this.#t;return{next(){return e<=t?{value:e++,done:!1}:{value:null,done:!0}}}}};var T=class extends z{#e;constructor(e){super(),this.#e=[...e]}contains(e){return this.#e.includes(e)}indexOf(e){return this.#e.indexOf(e)}size(){return this.#e.length}at(e){return this.#e[e]}[Symbol.iterator](){return this.#e[Symbol.iterator]()}};var F=class{},L=class extends F{degree(...e){return this.isSatisfied(...e)}},A=class extends F{isSatisfied(...e){let t=this.degree(...e);return 0<t&&t<1?0:t}};var b=class u extends N{static UNDEFINED=-1;rel;constructor(e){super(),this.rel=e}relation(){return this.rel}isFuzzy(){return this.rel instanceof A}toString(){let e=this.name(),t=e?`(${e})`:"",r=this.degree(),n=r===u.UNDEFINED?"UNDEFINED":""+r;return`c${this.index()}${t} = ${n}`}};var _=class extends b{#e=[];constructor(e,t){super(e),this.#e=[t]}size(){return 1}at(e){return this.#e.at(e)}has(e){return e===this.#e[0]}indexOf(e){return e===this.#e[0]?0:-1}neighbors(){let e=[];for(let t of this.#e[0])t!==this&&e.push(t);return e}[Symbol.iterator](){return this.#e[Symbol.iterator]()}emptyVariableSize(){return this.#e[0].isEmpty()?1:0}isDefined(){return!this.#e[0].isEmpty()}isSatisfied(){return this.#e[0].isEmpty()?b.UNDEFINED:this.rel.isSatisfied(this.#e[0].value())?1:0}degree(){return this.#e[0].isEmpty()?b.UNDEFINED:this.rel.degree(this.#e[0].value())}highestConsistencyDegree(){let e=this.degree();if(e!==b.UNDEFINED)return e;let t=0,r=n=>{let i=this.rel.degree(n);return i>t&&(t=i),t===1};for(let n of this.#e[0].domain())if(r(n))break;return t}lowestConsistencyDegree(){let e=this.degree();if(e!==b.UNDEFINED)return e;let t=1,r=n=>{let i=this.rel.degree(n);return i<t&&(t=i),t===0};for(let n of this.#e[0].domain())if(r(n))break;return t}};var I=class extends b{#e=[];constructor(e,t,r){super(e),this.#e=[t,r]}size(){return 2}at(e){return this.#e.at(e)}has(e){return this.#e[0]===e||this.#e[1]===e}indexOf(e){return e===this.#e[0]?0:e===this.#e[1]?1:-1}neighbors(){let e=[];for(let t of this.#e)for(let r of t)r!==this&&e.push(r);return e}[Symbol.iterator](){return this.#e[Symbol.iterator]()}emptyVariableSize(){let e=0;return this.#e[0].isEmpty()&&++e,this.#e[1].isEmpty()&&++e,e}isDefined(){return!this.#e[0].isEmpty()&&!this.#e[1].isEmpty()}isSatisfied(){return this.#e[0].isEmpty()||this.#e[1].isEmpty()?b.UNDEFINED:this.rel.isSatisfied(this.#e[0].value(),this.#e[1].value())?1:0}degree(){return this.#e[0].isEmpty()||this.#e[1].isEmpty()?b.UNDEFINED:this.rel.degree(this.#e[0].value(),this.#e[1].value())}highestConsistencyDegree(){let e=this.degree();if(e!==b.UNDEFINED)return e;let t=0,r=(a,l)=>{let m=this.rel.degree(a,l);return m>t&&(t=m),t===1},n=this.#e[0].value(),i=this.#e[1].value(),s=this.#e[0].domain(),o=this.#e[1].domain();if(this.#e[0].isEmpty()&&!this.#e[1].isEmpty()){for(let a of s)if(r(a,i))break}else if(!this.#e[0].isEmpty()&&this.#e[1].isEmpty()){for(let a of o)if(r(n,a))break}else for(let a of s)for(let l of o)if(r(a,l))break;return t}lowestConsistencyDegree(){let e=this.degree();if(e!==b.UNDEFINED)return e;let t=1,r=(a,l)=>{let m=this.rel.degree(a,l);return m<t&&(t=m),t===0},n=this.#e[0].value(),i=this.#e[1].value(),s=this.#e[0].domain(),o=this.#e[1].domain();if(this.#e[0].isEmpty()&&!this.#e[1].isEmpty()){for(let a of s)if(r(a,i))break}else if(!this.#e[0].isEmpty()&&this.#e[1].isEmpty()){for(let a of o)if(r(n,a))break}else for(let a of s)for(let l of o)if(r(a,l))break;return t}};var R=class extends b{#e=[];constructor(e,t,r,n){super(e),this.#e=[t,r,n]}size(){return 3}at(e){return this.#e.at(e)}has(e){return this.#e[0]===e||this.#e[1]===e||this.#e[2]===e}indexOf(e){return e===this.#e[0]?0:e===this.#e[1]?1:e===this.#e[2]?2:-1}neighbors(){let e=[];for(let t of this.#e)for(let r of t)r!==this&&e.push(r);return e}[Symbol.iterator](){return this.#e[Symbol.iterator]()}emptyVariableSize(){let e=0;return this.#e[0].isEmpty()&&++e,this.#e[1].isEmpty()&&++e,this.#e[2].isEmpty()&&++e,e}isDefined(){return!this.#e[0].isEmpty()&&!this.#e[1].isEmpty()&&!this.#e[2].isEmpty()}isSatisfied(){return this.#e[0].isEmpty()||this.#e[1].isEmpty()||this.#e[2].isEmpty()?b.UNDEFINED:this.rel.isSatisfied(this.#e[0].value(),this.#e[1].value(),this.#e[2].value())?1:0}degree(){return this.#e[0].isEmpty()||this.#e[1].isEmpty()||this.#e[2].isEmpty()?b.UNDEFINED:this.rel.degree(this.#e[0].value(),this.#e[1].value(),this.#e[2].value())}highestConsistencyDegree(){let e=this.degree();if(e!==b.UNDEFINED)return e;let t=0,r=(m,h,c)=>{let d=this.rel.degree(m,h,c);return d>t&&(t=d),t===1},n=this.#e[0].value(),i=this.#e[1].value(),s=this.#e[2].value(),o=this.#e[0].domain(),a=this.#e[1].domain(),l=this.#e[2].domain();if(this.#e[0].isEmpty()&&!this.#e[1].isEmpty()&&!this.#e[2].isEmpty()){for(let m of o)if(r(m,i,s))break}else if(!this.#e[0].isEmpty()&&this.#e[1].isEmpty()&&!this.#e[2].isEmpty()){for(let m of a)if(r(n,m,s))break}else if(!this.#e[0].isEmpty()&&!this.#e[1].isEmpty()&&this.#e[2].isEmpty()){for(let m of l)if(r(n,i,m))break}else if(this.#e[0].isEmpty()&&this.#e[1].isEmpty()&&!this.#e[2].isEmpty()){for(let m of o)for(let h of a)if(r(m,h,s))break}else if(this.#e[0].isEmpty()&&!this.#e[1].isEmpty()&&this.#e[2].isEmpty()){for(let m of o)for(let h of l)if(r(m,i,h))break}else if(!this.#e[0].isEmpty()&&this.#e[1].isEmpty()&&this.#e[2].isEmpty()){for(let m of a)for(let h of l)if(r(n,m,h))break}else for(let m of o)for(let h of a)for(let c of l)if(r(m,h,c))break;return t}lowestConsistencyDegree(){let e=this.degree();if(e!==b.UNDEFINED)return e;let t=1,r=(m,h,c)=>{let d=this.rel.degree(m,h,c);return d<t&&(t=d),t===0},n=this.#e[0].value(),i=this.#e[1].value(),s=this.#e[2].value(),o=this.#e[0].domain(),a=this.#e[1].domain(),l=this.#e[2].domain();if(this.#e[0].isEmpty()&&!this.#e[1].isEmpty()&&!this.#e[2].isEmpty()){for(let m of o)if(r(m,i,s))break}else if(!this.#e[0].isEmpty()&&this.#e[1].isEmpty()&&!this.#e[2].isEmpty()){for(let m of a)if(r(n,m,s))break}else if(!this.#e[0].isEmpty()&&!this.#e[1].isEmpty()&&this.#e[2].isEmpty()){for(let m of l)if(r(n,i,m))break}else if(this.#e[0].isEmpty()&&this.#e[1].isEmpty()&&!this.#e[2].isEmpty()){for(let m of o)for(let h of a)if(r(m,h,s))break}else if(this.#e[0].isEmpty()&&!this.#e[1].isEmpty()&&this.#e[2].isEmpty()){for(let m of o)for(let h of l)if(r(m,i,h))break}else if(!this.#e[0].isEmpty()&&this.#e[1].isEmpty()&&this.#e[2].isEmpty()){for(let m of a)for(let h of l)if(r(n,m,h))break}else for(let m of o)for(let h of a)for(let c of l)if(r(m,h,c))break;return t}};var M=class extends b{#e;#t;constructor(e,...t){super(e),this.#e=[...t],this.#t=new Array(this.#e.length)}size(){return this.#e.length}at(e){return this.#e.at(e)}has(e){return this.#e.includes(e)}indexOf(e){return this.#e.indexOf(e)}neighbors(){let e=[];for(let t of this.#e)for(let r of t)r!==this&&e.push(r);return e}[Symbol.iterator](){return this.#e[Symbol.iterator]()}emptyVariableSize(){let e=0;for(let t of this.#e)e+=t.isEmpty()?1:0;return e}isDefined(){for(let e of this.#e)if(e.isEmpty())return!1;return!0}isSatisfied(){for(let e=0;e<this.#e.length;++e){let t=this.#e[e];if(t.isEmpty())return b.UNDEFINED;this.#t[e]=t.value()}return this.rel.isSatisfied(...this.#t)?1:0}degree(){for(let e=0;e<this.#e.length;++e){let t=this.#e[e];if(t.isEmpty())return b.UNDEFINED;this.#t[e]=t.value()}return this.rel.degree(...this.#t)}highestConsistencyDegree(){let e=this.degree();if(e!==b.UNDEFINED)return e;let t=new Array(this.emptyVariableSize()),r=0;for(let n=0;n<this.#e.length;++n){let i=this.#e[n];i.isEmpty()?t[r++]=n:this.#t[n]=i.value()}return this.checkHCD(t,0,0)}lowestConsistencyDegree(){let e=this.degree();if(e!==b.UNDEFINED)return e;let t=new Array(this.emptyVariableSize()),r=0;for(let n=0;n<this.#e.length;++n){let i=this.#e[n];i.isEmpty()?t[r++]=n:this.#t[n]=i.value()}return this.checkLCD(t,0,1)}checkHCD(e,t,r){let n=e[t],i=this.#e[n].domain();if(t===e.length-1)for(let s of i){this.#t[n]=s;let o=this.rel.degree(...this.#t);if(o>r&&(r=o),r===1)break}else for(let s of i)this.#t[n]=s,r=this.checkHCD(e,t+1,r);return r}checkLCD(e,t,r){let n=e[t],i=this.#e[n].domain();if(t===e.length-1)for(let s of i){this.#t[n]=s;let o=this.rel.degree(...this.#t);if(o<r&&(r=o),r===0)break}else for(let s of i)this.#t[n]=s,r=this.checkLCD(e,t+1,r);return r}};var U=class{#e=(e,t)=>new w(e,t);#t=(e,t)=>t.length===1?new _(e,t[0]):t.length===2?new I(e,t[0],t[1]):t.length===3?new R(e,t[0],t[1],t[2]):new M(e,...t);#r=!1;#i=[];#n=[];setVariableFactory(e){this.#e=e}setConstraintFactory(e){this.#t=e}addVariable(e){e.setIndex(this.#i.length),this.#i.push(e)}createDomain(e){return"values"in e?new T(e.values):"min"in e&&"max"in e?new k(e.min,e.max):null}createVariable(e){if("variable"in e){let t=this.#e(this,e.variable.domain());return this.addVariable(t),t.setName(t.name()),t.assign(t.value()),t}else{if(e.value!==void 0&&!e.domain.contains(e.value))throw new Error;let t=this.#e(this,e.domain);return this.addVariable(t),e.name&&t.setName(e.name),e.value&&t.assign(e.value),t}}createConstraint(e){for(let r of e.variables)if(r.owner()!==this)return null;let t=this.#t(e.relation,e.variables);t.setIndex(this.#n.length),this.#n.push(t);for(let r of e.variables)r.connect(t);return t.isFuzzy()&&(this.#r=!0),"name"in e&&t.setName(e.name),t}removeConstraint(e){let t=this.#n.indexOf(e);this.#n.splice(t,1);for(let r=t;r<this.#n.length;++r)this.#n[r].setIndex(r);for(let r of e)r.disconnect(e);this.#r=!1;for(let r of this.#n)if(r.isFuzzy()){this.#r=!0;break}}clearAllVariables(){for(let e of this.#i)e.clear()}reverseVariables(){this.#i.reverse();for(let e=0;e<this.#i.length;++e)this.#i[e].setIndex(e)}sortVariables(e){this.#i.sort(e);for(let t=0;t<this.#i.length;++t)this.#i[t].setIndex(t)}variables(){return this.#i}variableSize(){return this.#i.length}variableAt(e){return this.#i[e]}variableOf(e){for(let t of this.#i)if(t.name()===e)return t;return null}hasVariable(e){return this.#i.includes(e)}constraints(){return this.#n}constraintSize(){return this.#n.length}constraintAt(e){return this.#n[e]}constraintOf(e){for(let t of this.#n)if(t.name()===e)return t;return null}hasConstraint(e){return this.#n.includes(e)}constraintsBetween(e,t){let r=[];for(let n of e)n.has(t)&&r.push(n);return r}isFuzzy(){return this.#r}constraintDensity(){return this.#n.length/this.#i.length}emptyVariableSize(){let e=0;for(let t of this.#i)e+=t.isEmpty()?1:0;return e}hasEmptyDomain(){for(let e of this.#i)if(e.domain().size()===0)return!0;return!1}degree(){let e=1;for(let t of this.#n){let r=t.degree();if(r===b.UNDEFINED)return r;r<e&&(e=r)}return e}constraintsWithDegree(){let e=[],t=1;for(let r of this.#n){let n=r.degree();n<t?(t=n,e.length=0,e.push(r)):n-t<Number.MIN_VALUE*10&&e.push(r)}return[e,t]}averageDegree(){let e=0;for(let t of this.#n)e+=t.degree();return e/this.#n.length}ratio(){return this.satisfiedConstraintSize()/this.#n.length}satisfiedConstraintSize(){let e=0;for(let t of this.#n)e+=t.isSatisfied()===1?1:0;return e}violatingConstraintSize(){return this.#n.length-this.satisfiedConstraintSize()}satisfiedConstraints(){let e=[];for(let t of this.#n)t.isSatisfied()===1&&e.push(t);return e}violatingConstraints(){let e=[];for(let t of this.#n)t.isSatisfied()!==1&&e.push(t);return e}};var de=class extends w{#e;constructor(e,t,r){super(e,t),this.#e=r}assign(e){super.assign(e),this.#e&&this.#e(this,e)}},O=class extends w{#e;constructor(e){super(e.owner(),e.domain()),this.#e=e,this.setName(e.name()),this.assign(e.value())}assign(e){this.#e.assign(e)}domain(e){if(e===void 0)return this.#e.domain();this.#e.domain(e)}value(){return this.#e.value()}};var $=class{#e=!0;#t=e=>console.log(e);#r=()=>!1;#i=Number.MAX_SAFE_INTEGER;#n=null;#s=.8;#a=null;#o=0;#l=0;#u=-1;#m=0;initialize(){this.#o=this.#n===null?Number.MAX_VALUE:Date.now()+this.#n,this.#l=0}check(e=null){if(e!==null&&this.#s!==null&&this.#s<=e)return this.outputDebugString("Stop: Current evaluation value is above the target"),!0;if(this.#i<this.#l++)return this.outputDebugString("Stop: Number of iterations has reached the limit"),!1;if(this.#o<Date.now())return this.outputDebugString("Stop: Time limit has been reached"),!1;if(e!==null&&this.#a!==null)if(e!==-1&&this.#u===e){if(this.#m++>this.#a)return this.outputDebugString("Stop: Evaluation value has not changed for a certain number of times"),!1}else this.#u=e,this.#m=0;return null}solutionFound(e,t){return this.#r(e,t)}outputDebugString(e){this.#e&&this.#t(e)}isDebugMode(){return this.#e}isTargetAssigned(){return this.#s!==null}getTarget(){return this.#s}setIterationLimit(e=null){this.#i=e===null?Number.MAX_SAFE_INTEGER:e}setTimeLimit(e=null){this.#n=e}setTarget(e=null){this.#s=e}setSameEvaluationLimit(e=null){this.#a=e}setListener(e){this.#r=e}setDebugMode(e){this.#e=e}setDebugOutput(e){this.#t=e}};var p=class{pro;monitor=new $;constructor(e){this.pro=e}setMonitor(e){this.monitor=e}getMonitor(){return this.monitor}name(){return""}exec(){return!1}solve(){return this.exec()}};var ie=class u{static#e=Number.MIN_SAFE_INTEGER;#t;#r=0;constructor(e){this.#t=new Array(e),this.#t.fill(u.#e)}prunedSize(){return this.#r}prune(e,t){if(this.#t[e]===u.#e)++this.#r;else throw new Error;this.#t[e]=t}isEmpty(){return this.#t.length===this.#r}isPruned(e){return this.#t[e]!==u.#e}recover(e){for(let t=0;t<this.#t.length;++t)this.#t[t]===e&&(this.#t[t]=u.#e,--this.#r)}recoverAll(){this.#t.fill(u.#e),this.#r=0}};function x(u){for(let e of u)e.solverObject=new ie(e.domain().size())}function D(u){for(let e of u)e.solverObject=null}function v(u,e){for(let t of u)t.solverObject.recover(e)}function y(u){let e=0,t=Number.MAX_VALUE;for(let r=0;r<u.length;++r){let n=u[r];if(!n.isEmpty())continue;let s=n.domain().size()-n.solverObject.prunedSize();s<t&&(t=s,e=r)}return e}var E=class{#e;#t;constructor(e){if("assignment"in e)this.#e=e.assignment.variable(),this.#t=e.assignment.value();else if("variable"in e)this.#e=e.variable,this.#t=e.value??e.variable.value();else throw new RangeError}apply(){this.#e.assign(this.#t)}toString(){return`v${this.#e.index()} <- ${this.#t}`}value(){return this.#t}variable(){return this.#e}};var f=class u{static fromVariables(e){let t=new u;return t.setVariables(e),t}#e=[];constructor(){}setProblem(e){this.#e.length=0;for(let t of e.variables())this.#e.push(new E({variable:t,value:t.value()}))}setAssignmentList(e){this.#e.length=0;for(let t of e)this.#e.push(new E({variable:t.variable(),value:t.value()}))}setVariables(e){this.#e.length=0;for(let t of e)this.#e.push(new E({variable:t,value:t.value()}))}addVariable(e,t=null){this.#e.push(new E({variable:e,value:t}))}apply(){for(let e of this.#e)e.apply()}clear(){this.#e.length=0}isEmpty(){return this.#e.length===0}size(){return this.#e.length}differenceSize(){let e=0;for(let t of this.#e)t.variable().value()!==t.value()&&++e;return e}at(e){return this.#e[e]}[Symbol.iterator](){return this.#e[Symbol.iterator]()}random(){return this.#e[Math.floor(Math.random()*this.#e.length)]}};var j=class extends L{#e;#t;constructor(e,t){super(),this.#t=e,this.#e=t}isSatisfied(...e){let t=this.#t.degree(...e);return 0<t&&t<this.#e?0:t}};function C(u,e){let t=[];for(let r=0;r<e.length;++r){t.push(new Array(e.length));for(let n=0;n<e.length;++n)n<r&&(t[r][n]=u.constraintsBetween(e[n],e[r]))}return t}function St(u){let e=new Array(u.variableSize());for(let t of u.variables())e[t.index()]=we(u,t);return e}function we(u,e){let t=new Array(u.variableSize());t.fill(Number.MAX_VALUE);let r=new Set;r.add(e),t[e.index()]=0,pe(u,e,t,0,r);let n=0,i=0;for(let s=0;s<t.length;++s)t[s]!==Number.MAX_VALUE&&s!==e.index()&&(++n,i+=t[s]);return n===0?0:i/n}function pe(u,e,t,r,n){let i=[];for(let s of e)for(let o of s)t[o.index()]===Number.MAX_VALUE&&(i.push(o),t[o.index()]=r+1);for(let s of i)n.add(s);for(let s of i)pe(u,s,t,r+1,n)}function xt(u){let e=[];for(let t of u.variables())e.push(t.domain());return e}function Dt(u,e){for(let t=0;t<e.length;++t)u.variableAt(t).domain(e[t])}function yt(u,e){for(let t of u.constraints()){if(t.size()!==1)continue;let r=t.at(0),n=r.value();for(let i of r.domain())r.assign(i),e.push(t.degree());r.assign(n)}return e}function Ct(u,e){let t=new se;for(let r of u.variables())t.createVariable({variable:r});for(let r of u.constraints()){let n=[];for(let s of r)n.push(t.variableAt(s.index()));let i=r.relation();r.isFuzzy()&&(i=new j(i,e)),t.createConstraint({relation:i,variables:n})}return t}var se=class extends U{createVariable(e){let t=new O(e.variable);return this.addVariable(t),t}};var B=class extends p{#e;#t=[];#r=new f;#i=!0;constructor(e){super(e),this.#e=[...this.pro.variables()],this.#t=C(this.pro,this.#e)}name(){return"Forward Checking"}setUsingMinimumRemainingValuesHeuristics(e){this.#i=e}exec(){this.monitor.initialize(),x(this.#e),this.pro.clearAllVariables();let e=this.#n(0);return this.#r.apply(),D(this.#e),e===!0}#n(e){if(e===this.pro.variableSize()){let s=this.pro.ratio();return this.#r.setProblem(this.pro),this.monitor.outputDebugString(`	Evaluation ${s}`),this.monitor.solutionFound(this.#r,s),!0}let t=null;if((t=this.monitor.check())!==null)return t;let r=this.#e[this.#i?y(this.#e):e],n=r.domain(),i=r.solverObject;for(let s=0,o=n.size();s<o;++s)if(!(i.isPruned(s)||(r.assign(n.at(s)),this.#l(r)))){if(this.#s(e,r)&&(t=this.#n(e+1),t!==null))break;v(this.#e,e)}return t===null&&(v(this.#e,e),r.clear()),t}#s(e,t){for(let r of this.#e){if(!r.isEmpty())continue;let n=this.#a(t.index(),r.index()),i=r.solverObject,s=r.domain();for(let o of n)if(o.emptyVariableSize()===1&&!this.#o(e,r,s,i,o))return!1}return!0}#a(e,t){return e<t?this.#t[t][e]:this.#t[e][t]}#o(e,t,r,n,i){for(let s=0,o=r.size();s<o;++s)n.isPruned(s)||(t.assign(r.at(s)),i.isSatisfied()===0&&n.prune(s,e));return t.clear(),!n.isEmpty()}#l(e){let t=0;for(let r of e)r.isSatisfied()===0&&++t;return t}};var W=class extends p{#e;#t=[];#r=new f;#i=!0;#n=0;constructor(e){super(e),this.#e=[...this.pro.variables()],this.#t=C(this.pro,this.#e)}name(){return"Forward Checking for Max CSPs"}setUsingMinimumRemainingValuesHeuristics(e){this.#i=e}exec(){this.monitor.initialize(),this.#n=this.pro.constraintSize(),x(this.#e),this.pro.clearAllVariables();let e=this.#s(0);return this.#r.apply(),D(this.#e),e===!0}#s(e,t=0){if(e===this.pro.variableSize()){let o=this.pro.ratio();return this.#r.setProblem(this.pro),this.monitor.outputDebugString(`	Evaluation ${o}`),t<this.#n&&(this.#n=t,this.monitor.solutionFound(this.#r,o))?!0:this.monitor.check(o)}let r=null;if((r=this.monitor.check())!==null)return r;let n=this.#e[this.#i?y(this.#e):e],i=n.domain(),s=n.solverObject;for(let o=0,a=i.size();o<a;++o){if(s.isPruned(o))continue;n.assign(i.at(o));let l=t+this.#u(n);if(!(this.#n<=l)){if((t+1<this.#n||this.#a(e,n))&&(r=this.#s(e+1,l),r!==null))break;v(this.#e,e)}}return r===null&&(v(this.#e,e),n.clear()),r}#a(e,t){for(let r of this.#e){if(!r.isEmpty())continue;let n=this.#o(t.index(),r.index()),i=r.solverObject,s=r.domain();for(let o of n)if(o.emptyVariableSize()===1&&!this.#l(e,r,s,i,o))return!1}return!0}#o(e,t){return e<t?this.#t[t][e]:this.#t[e][t]}#l(e,t,r,n,i){for(let s=0,o=r.size();s<o;++s)n.isPruned(s)||(t.assign(r.at(s)),i.isSatisfied()===0&&n.prune(s,e));return t.clear(),!n.isEmpty()}#u(e){let t=0;for(let r of e)r.isSatisfied()===0&&++t;return t}};var G=class extends p{#e=!1;constructor(e,t=!1){super(e),t&&this.pro.clearAllVariables()}name(){return"Local Changes"}exec(){this.pro.emptyVariableSize()===0&&this.pro.clearAllVariables(),this.#e=!1;let e=new Set,t=new Set;for(let s of this.pro.variables())(s.isEmpty()?t:e).add(s);this.monitor.initialize();let r=new f,n=this.#t(new Set,e,t),i=this.pro.ratio();return this.monitor.outputDebugString(`Evaluation: ${i}`),n&&(r.setProblem(this.pro),this.monitor.solutionFound(r,i))?!0:n}#t(e,t,r){{this.monitor.outputDebugString(`X1 ${e.size}, X2' ${t.size}, X3' ${r.size}`);let n=this.monitor.check(this.pro.degree());if(n!==null)return this.#e=!0,n;if(r.size===0)return!0;let i=r.values().next().value,s=this.#r(e,t,i,Ee(i));return!s||this.#e?s:(t=ge(t,i),r=ve(r,i),this.#t(e,t,r))}}#r(e,t,r,n){if(n.size){let i=n.values().next().value,s=f.fromVariables(t);r.assign(i);let o=this.#i(e,t,r,i);return o||this.#e?o:(r.clear(),s.apply(),this.#r(e,t,r,ve(n,i)))}return!1}#i(e,t,r,n){if(!this.#n(e,r,n))return!1;let i=e.union(t);if(this.#n(i,r,n))return!0;let s=this.#s(i,r,n);return e=ge(e,r),t=t.difference(s),this.#t(e,t,s)}#n(e,t,r){let n=new Set;for(let s of e){let o=this.pro.constraintsBetween(t,s);for(let a of o)n.add(a)}let i=t.value();t.assign(r);for(let s of n)if(s.isSatisfied()!==1)return t.assign(i),!1;return t.assign(i),!0}#s(e,t,r){let n=new Set,i=new Set;for(let o of e)for(let a of this.pro.constraintsBetween(t,o))i.add(a);let s=t.value();t.assign(r);for(let o of i)if(o.isSatisfied()!==1)for(let a of o)n.add(a);return t.assign(s),n.delete(t),n}};function ge(u,e){return new Set(u).add(e)}function ve(u,e){let t=new Set(u);return t.delete(e),t}function Ee(u){return new Set(u.domain())}var H=class extends p{#e=!1;constructor(e,t=!1){super(e),t&&this.pro.clearAllVariables()}name(){return"Local Changes Ex"}exec(){this.pro.emptyVariableSize()===0&&this.pro.clearAllVariables(),this.#e=!1;let e=new Set,t=new Set;for(let s of this.pro.variables())(s.isEmpty()?t:e).add(s);this.monitor.initialize();let r=new f,n=this.#t(new Set,e,t),i=this.pro.ratio();return this.monitor.outputDebugString(`Evaluation: ${i}`),n&&(r.setProblem(this.pro),this.monitor.solutionFound(r,i))?!0:n}#t(e,t,r){for(t=new Set(t),r=new Set(r);;){this.monitor.outputDebugString(`X1 ${e.size}, X2' ${t.size}, X3' ${r.size}`);let n=this.monitor.check(this.pro.degree());if(n!==null)return this.#e=!0,n;if(r.size===0)return!0;let i=r.values().next().value,s=this.#r(e,t,i);if(!s||this.#e)return s;t.add(i),r.delete(i)}}#r(e,t,r){for(let n of r.domain()){let i=f.fromVariables(t);r.assign(n);let s=this.#i(e,t,r);if(s||this.#e)return s;r.clear(),i.apply()}return!1}#i(e,t,r){if(!this.#n(e,r,r.value()))return!1;let n=e.union(t);if(this.#n(n,r,r.value()))return!0;let i=this.#s(n,r,r.value());return e=Ne(e,r),t=t.difference(i),this.#t(e,t,i)}#n(e,t,r){let n=new Set;for(let s of e){let o=this.pro.constraintsBetween(t,s);for(let a of o)n.add(a)}let i=t.value();t.assign(r);for(let s of n)if(s.isSatisfied()!==1)return t.assign(i),!1;return t.assign(i),!0}#s(e,t,r){let n=new Set,i=new Set;for(let o of e)for(let a of this.pro.constraintsBetween(t,o))i.add(a);let s=t.value();t.assign(r);for(let o of i)if(o.isSatisfied()!==1)for(let a of o)n.add(a);return t.assign(s),n.delete(t),n}};function Ne(u,e){return new Set(u).add(e)}var Y=class extends p{#e=!0;#t;constructor(e){super(e),this.#t=new Array(this.pro.constraintSize()),this.#t.fill(1)}name(){return"Breakout"}setRandomness(e){this.#e=e}exec(){for(let s of this.pro.variables())s.isEmpty()&&s.assign(s.domain().at(0));let e=this.pro.ratio(),t=new f,r=e;this.monitor.initialize();let n=new f,i=null;for(;;){let s=this.pro.violatingConstraints(),o=this.pro.ratio();if(this.monitor.outputDebugString(`Evaluation: ${o}`),r<o&&(t.setProblem(this.pro),r=o,this.monitor.solutionFound(t,r)))return!0;if((i=this.monitor.check(o))!==null)break;this.#r(s,n)}return i===!1&&!this.monitor.isTargetAssigned()&&e<r&&(t.apply(),i=!0),i}#r(e,t){if(this.#i(this.#n(e),t),0<t.size()){let r=this.#e?t.random():t.at(0);r.apply(),t.clear(),this.monitor.outputDebugString("	"+r)}else{for(let r of e)this.#t[r.index()]+=1;this.monitor.outputDebugString("Breakout")}}#i(e,t){let r=0;for(let n of e){let i=n.value(),s=0;for(let o of n)s+=(1-o.isSatisfied())*this.#t[o.index()];e:for(let o of n.domain()){if(i===o)continue;n.assign(o);let a=s;for(let l of n)if(a-=(1-l.isSatisfied())*this.#t[l.index()],a<r)continue e;r<a?(r=a,t.clear(),t.addVariable(n,o)):r!==0&&t.addVariable(n,o)}n.assign(i)}}#n(e){let t=new Set;for(let r of e)for(let n of r)t.add(n);return Array.from(t)}};var q=class extends p{#e=[];#t=[];constructor(e){super(e)}name(){return"GENET"}exec(){if(!this.#r())throw new Error;let e=[...Array(this.#e.length).keys()],t=this.pro.ratio(),r=new f,n=t;this.monitor.initialize();let i=null;for(;;){let s=this.pro.ratio();if(this.monitor.outputDebugString(`Evaluation: ${s}`),n<s&&(r.setProblem(this.pro),n=s,this.monitor.solutionFound(r,n)))return!0;if((i=this.monitor.check(s))!==null)break;this.#i(e)}return i===!1&&!this.monitor.isTargetAssigned()&&t<n&&(r.apply(),i=!0),i}#r(){this.monitor.outputDebugString("Start of Network Generation");let e=[];for(let t of this.pro.variables()){if(t.domain().size()===0)return!1;this.#e.push(new oe(t))}for(let t of this.pro.constraints())if(t.size()===1){let r=t.at(0),n=this.#e[r.index()];for(let i of n){let s=r.value();r.assign(i._value),t.isSatisfied()!==1&&e.push(new J(t,i)),r.assign(s)}}else{let r=t.at(0),n=t.at(1),i=this.#e[r.index()],s=this.#e[n.index()];for(let o of i){let a=r.value();r.assign(o._value);for(let l of s){let m=n.value();n.assign(l._value),t.isSatisfied()!==1&&e.push(new J(t,o,l)),n.assign(m)}r.assign(a)}}for(let t of this.#e)for(let r of t._neurons)r.lockConnections();return this.#t=e,this.monitor.outputDebugString("End of Network Generation"),!0}#i(e){let t=!1;for(let r of this.#n(e))this.#e[r].setActivityMaximumInput()&&(t=!0);if(t)for(let r of this.#e)r.applyToVariable();else for(let r of this.#t)r.refreshWeight()}#n(e){for(let t=e.length;t>1;--t){let r=le(t),n=e[t-1];e[t-1]=e[r],e[r]=n}return e}},oe=class{#e;#t=0;#r=[];_neurons=[];constructor(e){this.#e=e;for(let t of e.domain())this._neurons.push(new ae(t));this.#i(le(this._neurons.length))}#i(e){for(let t of this._neurons)t._isActive=!1;this._neurons[e]._isActive=!0,this.#t=e}applyToVariable(){this.#e.assign(this._neurons[this.#t]._value)}setActivityMaximumInput(){this.#r.length=0;let e=Number.NEGATIVE_INFINITY,t=!1;for(let r=0;r<this._neurons.length;++r){let n=this._neurons[r].getInput();e<=n&&(e<n&&(e=n,this.#r.length=0,t=!1),this.#r.push(r),this.#t===r&&(t=!0))}return t||this.#r.length===0?!1:(this.#i(this.#r[le(this.#r.length)]),!0)}[Symbol.iterator](){return this._neurons[Symbol.iterator]()}},J=class{#e;#t;#r;_weight;constructor(e,t,r=null){this.#e=e,this.#t=t,this.#r=r,this._weight=e.isSatisfied()-1,this.#t.addConnection(this),this.#r&&this.#r.addConnection(this)}getNeuron(e){return e===this.#t?this.#r:e===this.#r?this.#t:null}refreshWeight(){!this.#t._isActive||this.#r!==null&&!this.#r._isActive||(this.#e.size()===1?this._weight+=this.#e.relation().isSatisfied(this.#t._value)-1:this._weight+=this.#e.relation().isSatisfied(this.#t._value,this.#r._value)-1)}},ae=class{#e=[];#t=[];_value;_isActive=!1;constructor(e){this._value=e}addConnection(e){this.#t.push(e)}lockConnections(){this.#e=[...this.#t],this.#t=null}getInput(){let e=0;for(let t of this.#e){let r=t.getNeuron(this);e+=t._weight*(r===null||r._isActive?1:0)}return e}};function le(u){return Math.floor(Math.random()*Math.floor(u))}var K=class extends p{#e=!0;#t;#r=new Set;#i=new Set;#n=[];#s=[];constructor(e){super(e);for(let t of this.pro.constraints())this.#n.push(new ue(t)),this.#s.push(null);this.#t=new Array(this.pro.constraintSize()),this.#t.fill(1)}name(){return"SRS3 for Crisp CSPs"}setRandomness(e){this.#e=e}exec(){for(let i of this.pro.variables())i.isEmpty()&&i.assign(i.domain().at(0));let e=this.pro.degree(),t=new f,r=e;this.monitor.initialize();let n=null;for(;;){let i=this.pro.violatingConstraints(),s=this.pro.ratio();if(this.monitor.outputDebugString(`Evaluation: ${s}`),r<s&&(t.setProblem(this.pro),r=s,this.monitor.solutionFound(t,r)))return!0;if((n=this.monitor.check(s))!==null)break;for(let a of this.#n)a.clear();let o=new Set;for(let a of i){let l=this.#n[a.index()];o.add(l)}this.#a(o)}return n===!1&&!this.monitor.isTargetAssigned()&&e<r&&(t.apply(),n=!0),n}#a(e){this.monitor.outputDebugString("SRS"),this.#r.clear(),this.#i.clear();for(let t of e)this.#i.add(t);for(;e.size&&this.#i.size;){let t=this.#h(this.#i);this.#i.delete(t),this.#l(t.constraint())?e.delete(t)||(t.parent()&&this.#l(t.parent().constraint())?this.#u(t,e):this.#o(t)):this.#o(t)}return e.size===0}#o(e){this.monitor.outputDebugString("Spread"),this.#r.add(e);for(let t of this.#m(e))!this.#r.has(t)&&!this.#i.has(t)&&(t.clear(),e.append(t),this.#i.add(t))}#l(e){this.monitor.outputDebugString("Repair"),this.#t[e.index()]+=1;let t=new f,r=0;for(let n of e){let i=n.value(),s=0;for(let o of n)s+=(1-o.isSatisfied())*this.#t[o.index()];e:for(let o of n.domain()){if(i===o||(n.assign(o),e.isSatisfied()!==1))continue;let a=s;for(let l of n)if(a-=(1-l.isSatisfied())*this.#t[l.index()],a<r)continue e;r<a?(r=a,t.clear(),t.addVariable(n,o)):r!==0&&t.addVariable(n,o)}n.assign(i)}if(0<t.size()){let n=this.#e?t.random():t.at(0);return n.apply(),this.monitor.outputDebugString("	"+n),!0}return!1}#u(e,t){this.monitor.outputDebugString("Shrink");let r=e,n=!1;for(;;){if(r=r.parent(),t.delete(r)){n=!0;break}if(!r.parent()||!this.#l(r.parent().constraint()))break}let i=[];r.getDescendants(i),r.clear();for(let s of i)this.#i.delete(s),this.#r.delete(s);n||this.#i.add(r)}#m(e){let t=e.constraint(),r=t.index();if(this.#s[r]===null){let n=[];for(let i of t.neighbors())n.push(this.#n[i.index()]);this.#s[r]=n}return this.#s[r]}#h(e){let t=this.#b(this.#f(e));return this.#e?t[Math.floor(Math.random()*t.length)]:t[0]}#b(e){let t=Number.MAX_VALUE,r=[];for(let n of e){let i=this.#t[n.constraint().index()];i<t?(t=i,r.length=0,r.push(n)):i===t&&r.push(n)}return r}#f(e){let t=Number.MAX_VALUE,r=[];for(let n of e){let i=n.depth();i<t?(t=i,r.length=0,r.push(n)):i===t&&r.push(n)}return r}},ue=class{#e;#t=0;#r=null;#i=[];constructor(e){this.#e=e}append(e){e.#r=this,e.#t=this.#t+1,this.#i.push(e)}clear(){this.#r=null,this.#t=0;for(let e of this.#i)e.clear();this.#i.length=0}constraint(){return this.#e}depth(){return this.#t}parent(){return this.#r}getDescendants(e){e.push(this);for(let t of this.#i)t.getDescendants(e)}};var Q=class extends p{#e;#t=[];#r=new f;#i=!0;#n=0;#s=!1;#a=new Set;#o;#l=[];#u=!1;constructor(e){super(e),this.#e=[...this.pro.variables()],this.#t=C(this.pro,this.#e),this.#o=new Array(this.pro.variableSize()),this.#l=this.pro.constraints().filter(t=>t.size()===1)}name(){return"Full Checking for Fuzzy CSPs"}setUsingMinimumRemainingValuesHeuristics(e){this.#i=e}setIntensivePruning(e){this.#u=e}exec(){this.monitor.initialize(),this.#n=0,x(this.#e);let e=null;for(;e===null;){if(!this.#m()){e=!1;break}this.pro.clearAllVariables(),e=this.#h(0),this.#r.apply(),this.#s=!1}return D(this.#e),e===!0}#m(){for(let e of this.#l){let t=e.at(0),r=t.value(),n=t.domain(),i=t.solverObject;for(let s=0,o=n.size();s<o;++s)t.assign(n.at(s)),e.degree()<=this.#n&&i.prune(s,-1);if(t.assign(r),i.isEmpty())return!1}return!0}#h(e,t=1){if(e===this.pro.variableSize()){let o=this.pro.degree();return this.#r.setProblem(this.pro),this.monitor.outputDebugString(`	Evaluation ${o}`),this.#n<o&&(this.#n=o,this.#s=!0,this.monitor.solutionFound(this.#r,o))?!0:this.monitor.check(o)}let r=null;if((r=this.monitor.check())!==null)return r;let n=this.#e[this.#i?y(this.#e):e],i=n.domain(),s=n.solverObject;this.#o[e]=n;for(let o=0,a=i.size();o<a;++o){if(s.isPruned(o))continue;n.assign(i.at(o));let l=Math.min(t,this.#v(n));if(!(l<=this.#n)){if(this.#b(e,n)&&(r=this.#h(e+1,l),r!==null||this.#s))break;v(this.#e,e)}}return r===null&&(v(this.#e,e),n.clear()),r}#b(e,t){for(let r of this.#e){if(!r.isEmpty())continue;let n=this.#f(t.index(),r.index()),i=r.solverObject,s=r.domain();for(let o of n){let a=o.emptyVariableSize();if(a===1){if(!this.#c(e,r,s,i,o))return!1}else if(this.#u){if(a===2){if(!this.#d(e,r,s,i,o))return!1}else if(a===3){if(!this.#p(e,r,s,i,o))return!1}else if(a>3&&!this.#g(e,r,s,i,o,a))return!1}}}return!0}#f(e,t){return e<t?this.#t[t][e]:this.#t[e][t]}#c(e,t,r,n,i){for(let s=0,o=r.size();s<o;++s)n.isPruned(s)||(t.assign(r.at(s)),i.degree()<=this.#n&&n.prune(s,e));return t.clear(),!n.isEmpty()}#d(e,t,r,n,i){let s=null;for(let l of i)if(l.isEmpty()&&l!==t){s=l;break}let o=s.domain(),a=s.solverObject;e:for(let l=0,m=r.size();l<m;++l)if(!n.isPruned(l)){t.assign(r.at(l));for(let h=0,c=o.size();h<c;++h)if(!a.isPruned(h)&&(s.assign(o.at(h)),i.degree()>this.#n))continue e;n.prune(l,e)}return s.clear(),t.clear(),!n.isEmpty()}#p(e,t,r,n,i){let s=null,o=null;for(let c of i)if(c.isEmpty()&&c!==t)if(s===null)s=c;else{o=c;break}let a=s.domain(),l=o.domain(),m=s.solverObject,h=o.solverObject;e:for(let c=0,d=r.size();c<d;++c)if(!n.isPruned(c)){t.assign(r.at(c));for(let g=0,S=a.size();g<S;++g)if(!m.isPruned(g)){s.assign(a.at(g));for(let V=0,Ce=l.size();V<Ce;++V)if(!h.isPruned(V)&&(o.assign(l.at(V)),i.degree()>this.#n))continue e}n.prune(c,e)}return o.clear(),s.clear(),t.clear(),!n.isEmpty()}#g(e,t,r,n,i,s){let o=new Array(s-1),a=0;for(let m of i)m.isEmpty()&&m!==t&&(o[a++]=m);let l=new Array(o.length);e:for(let m=0,h=r.size();m<h;++m)if(!n.isPruned(m)){t.assign(r.at(m)),l.fill(0);t:for(;;){let c=!1;for(let d=0;d<o.length;++d){let g=o[d].domain();if(o[d].solverObject.isPruned(l[d])){c=!0;break}o[d].assign(g.at(l[d]))}if(!c&&i.degree()>this.#n)continue e;for(let d=0;d<o.length&&(l[d]+=1,!(l[d]<o[d].domain().size()));++d)if(l[d]=0,d===o.length-1)break t}n.prune(m,e)}for(let m of o)m.clear();return t.clear(),!n.isEmpty()}#v(e){let t=Number.MAX_VALUE;this.#a.clear();for(let r of this.#e){if(r===e||r.isEmpty())continue;let n=this.#f(e.index(),r.index());for(let i of n)if(!this.#a.has(i)){let s=i.degree();s!==b.UNDEFINED&&s<t&&(t=s),this.#a.add(i)}}return t}};var Z=class extends p{#e;#t=[];#r=new f;#i=!0;#n=0;#s=!1;constructor(e){super(e),this.#e=[...this.pro.variables()],this.#t=C(this.pro,this.#e)}name(){return"Forward Checking for Fuzzy CSPs"}setUsingMinimumRemainingValuesHeuristics(e){this.#i=e}exec(){this.monitor.initialize(),this.#n=0,x(this.#e);let e=null;for(;e===null;)this.pro.clearAllVariables(),e=this.#a(0),this.#r.apply(),this.#s=!1;return D(this.#e),e===!0}#a(e,t=1){if(e===this.pro.variableSize()){let o=this.pro.degree();return this.#r.setProblem(this.pro),this.monitor.outputDebugString(`	Evaluation ${o}`),this.#n<o&&(this.#n=o,this.#s=!0,this.monitor.solutionFound(this.#r,o))?!0:this.monitor.check(o)}let r=null;if((r=this.monitor.check())!==null)return r;let n=this.#e[this.#i?y(this.#e):e],i=n.domain(),s=n.solverObject;for(let o=0,a=i.size();o<a;++o){if(s.isPruned(o))continue;n.assign(i.at(o));let l=Math.min(t,this.#m(n));if(!(l<=this.#n)){if(this.#o(e,n)&&(r=this.#a(e+1,l),r!==null||this.#s))break;v(this.#e,e)}}return r===null&&(v(this.#e,e),n.clear()),r}#o(e,t){for(let r of this.#e){if(!r.isEmpty())continue;let n=this.#l(t.index(),r.index()),i=r.solverObject,s=r.domain();for(let o of n)if(o.emptyVariableSize()===1&&!this.#u(e,r,s,i,o))return!1}return!0}#l(e,t){return e<t?this.#t[t][e]:this.#t[e][t]}#u(e,t,r,n,i){for(let s=0,o=r.size();s<o;++s)n.isPruned(s)||(t.assign(r.at(s)),i.degree()<=this.#n&&n.prune(s,e));return t.clear(),!n.isEmpty()}#m(e){let t=Number.MAX_VALUE;for(let r of e){let n=r.degree();n!==b.UNDEFINED&&n<t&&(t=n)}return t}};var X=class extends p{#e=0;#t=0;#r=0;constructor(e){super(e),this.#n()}name(){return"Flexible Local Changes"}#i(e,t){let r=new Map;for(let s of t)if(s.isDefined())for(let o of s)r.has(o)?r.set(o,(r.get(o)??0)+1):r.set(o,1);let n=[...e];n.sort((s,o)=>{let a=0,l=0;return r.has(s)&&(a=r.get(s)??0),r.has(o)&&(l=r.get(o)??0),a<l?1:a>l?-1:0});let i=new Set;for(let s of n){let o=!1;for(let a of t)if(a.isDefined()){o=!0;break}if(!o)break;s.clear(),i.add(s)}return i}#n(){let e=1,t=0;for(let r of this.pro.variables())for(let n of r){let i=n.lowestConsistencyDegree(),s=n.highestConsistencyDegree();i<e&&(e=i),s>t&&(t=s)}this.#t=e,this.#e=t}#s(e,t,r,n,i,s,o){let a=this.#i(t,s),l=Ve(e,r),m=t.difference(a);return this.#o(l,m,a,n,Math.min(i,n),o)}#a(e,t,r,n,i,s){let o=this.#t;if(r.domain().size()===0)return o;let a=f.fromVariables(t),l=r.domain().at(0),m=f.fromVariables(t);for(let h=0;h<r.domain().size()&&o<i;++h){let c=r.domain().at(h);r.assign(c);let d=Math.min(n,this.#u(e,r,o,s));if(d>Math.max(o,s)){let g=new Set,S=Math.min(Math.min(d,i),this.#m(e,t,r,d,i,g));if(S>o&&(o=S,l=c,a=f.fromVariables(t)),g.size){let V=this.#s(e,t,r,d,i,g,Math.max(s,o));if(this.#r!==-1)return o;V>o&&(o=V,l=c,a=f.fromVariables(t)),m.apply()}}}return a.apply(),r.assign(l),o}#o(e,t,r,n,i,s){{this.monitor.outputDebugString(`X1 ${e.size}, X2' ${t.size}, X3' ${r.size}`);let o=this.monitor.check(this.pro.degree());if(o!==null)return this.#r=o?1:0,i;if(r.size===0)return i;let a=r.values().next().value,l=this.#a(e,t,a,n,i,s);return this.#r!==-1?i:l<s?this.#t:(t=Ve(t,a),r=ze(r,a),this.#o(e,t,r,n,l,s))}}#l(e,t){let r=new Set;for(let i of e)for(let s of i)r.add(s);let n=1;for(let i of r){let s=i.degree();s!==b.UNDEFINED&&s<n&&(n=s)}for(let i of this.pro.constraints())i.lowestConsistencyDegree()<this.#e&&t.add(i);return n}#u(e,t,r,n){let i=1,s=new Set;for(let o of e){let a=this.pro.constraintsBetween(o,t);for(let l of a)s.add(l)}for(let o of s){let a=o.degree();if(a!==b.UNDEFINED&&(a<i&&(i=a),i<=r||i<=n))return i}return i}#m(e,t,r,n,i,s){let o=1,a=new Set;for(let l of e){let m=this.pro.constraintsBetween(l,r);for(let h of m)a.add(h)}for(let l of t){let m=this.pro.constraintsBetween(l,r);for(let h of m)a.add(h)}for(let l of a){let m=l.degree();m!==b.UNDEFINED&&m<o&&(o=m)}for(let l of a){let m=l.degree();m!==b.UNDEFINED&&(m<n||m<i)&&s.add(l)}return o}exec(){this.monitor.initialize(),this.#r=-1;let e=this.pro.degree();this.pro.emptyVariableSize()===0&&this.pro.clearAllVariables();let t=new Set,r=new Set,n=new Set;for(let c of this.pro.variables())(c.isEmpty()?n:r).add(c);let i=new Set,s=this.#l(r,i),o,a=null;n.size===0?(o=s,a=f.fromVariables(r)):o=this.#t;let l=this.#i(r,i).union(n),m=r.difference(l),h=this.#o(t,m,l,this.#e,this.#e,o);return h<o&&a!==null&&a.apply(),h=this.pro.degree(),h>e&&h>0&&(this.#r!==0||this.targetDeg===null)}};function Ve(u,e){return new Set(u).add(e)}function ze(u,e){let t=new Set(u);return t.delete(e),t}var ee=class extends p{#e=0;#t=0;#r=0;constructor(e){super(e),this.#n()}name(){return"Flexible Local Changes Ex"}#i(e,t){let r=new Map;for(let s of t)if(s.isDefined())for(let o of s)r.has(o)?r.set(o,(r.get(o)??0)+1):r.set(o,1);let n=[...e];n.sort((s,o)=>{let a=0,l=0;return r.has(s)&&(a=r.get(s)??0),r.has(o)&&(l=r.get(o)??0),a<l?1:a>l?-1:0});let i=new Set;for(let s of n){let o=!1;for(let a of t)if(a.isDefined()){o=!0;break}if(!o)break;s.clear(),i.add(s)}return i}#n(){let e=1,t=0;for(let r of this.pro.variables())for(let n of r){let i=n.lowestConsistencyDegree(),s=n.highestConsistencyDegree();i<e&&(e=i),s>t&&(t=s)}this.#t=e,this.#e=t}#s(e,t,r,n,i,s,o){let a=this.#i(t,s),l=Ae(e,r),m=t.difference(a);return this.#o(l,m,a,n,Math.min(i,n),o)}#a(e,t,r,n,i,s){let o=this.#t;if(r.domain().size()===0)return o;let a=f.fromVariables(t),l=r.domain().at(0),m=f.fromVariables(t);for(let h=0;h<r.domain().size()&&o<i;++h){let c=r.domain().at(h);r.assign(c);let d=Math.min(n,this.#u(e,r,o,s));if(d>Math.max(o,s)){let g=new Set,S=Math.min(Math.min(d,i),this.#m(e,t,r,d,i,g));if(S>o&&(o=S,l=c,a=f.fromVariables(t)),g.size){let V=this.#s(e,t,r,d,i,g,Math.max(s,o));if(this.#r!==-1)return o;V>o&&(o=V,l=c,a=f.fromVariables(t)),m.apply()}}}return a.apply(),r.assign(l),o}#o(e,t,r,n,i,s){for(t=new Set(t),r=new Set(r);;){this.monitor.outputDebugString(`X1 ${e.size}, X2' ${t.size}, X3' ${r.size}`);let o=this.monitor.check(this.pro.degree());if(o!==null)return this.#r=o?1:0,i;if(r.size===0)return i;let a=r.values().next().value,l=this.#a(e,t,a,n,i,s);if(this.#r!==-1)return i;if(l<s)return this.#t;t.add(a),r.delete(a),i=l}}#l(e,t){let r=new Set;for(let i of e)for(let s of i)r.add(s);let n=1;for(let i of r){let s=i.degree();s!==b.UNDEFINED&&s<n&&(n=s)}for(let i of this.pro.constraints())i.lowestConsistencyDegree()<this.#e&&t.add(i);return n}#u(e,t,r,n){let i=1,s=new Set;for(let o of e){let a=this.pro.constraintsBetween(o,t);for(let l of a)s.add(l)}for(let o of s){let a=o.degree();if(a!==b.UNDEFINED&&(a<i&&(i=a),i<=r||i<=n))return i}return i}#m(e,t,r,n,i,s){let o=1,a=new Set;for(let l of e){let m=this.pro.constraintsBetween(l,r);for(let h of m)a.add(h)}for(let l of t){let m=this.pro.constraintsBetween(l,r);for(let h of m)a.add(h)}for(let l of a){let m=l.degree();m!==b.UNDEFINED&&m<o&&(o=m)}for(let l of a){let m=l.degree();m!==b.UNDEFINED&&(m<n||m<i)&&s.add(l)}return o}exec(){this.monitor.initialize(),this.#r=-1;let e=this.pro.degree();this.pro.emptyVariableSize()===0&&this.pro.clearAllVariables();let t=new Set,r=new Set,n=new Set;for(let c of this.pro.variables())(c.isEmpty()?n:r).add(c);let i=new Set,s=this.#l(r,i),o,a=null;n.size===0?(o=s,a=f.fromVariables(r)):o=this.#t;let l=this.#i(r,i).union(n),m=r.difference(l),h=this.#o(t,m,l,this.#e,this.#e,o);return h<o&&a!==null&&a.apply(),h=this.pro.degree(),h>e&&h>0&&(this.#r!==0||this.targetDeg===null)}};function Ae(u,e){return new Set(u).add(e)}var te=class extends p{#e=!0;#t;constructor(e){super(e),this.#t=new Array(this.pro.constraintSize()),this.#t.fill(1)}name(){return"Fuzzy Breakout"}setRandomness(e){this.#e=e}exec(){for(let s of this.pro.variables())s.isEmpty()&&s.assign(s.domain().at(0));let e=this.pro.degree(),t=new f,r=e;this.monitor.initialize();let n=new f,i=null;for(;;){let[s,o]=this.pro.constraintsWithDegree();if(this.monitor.outputDebugString(`Evaluation: ${o}`),r<o&&(t.setProblem(this.pro),r=o,this.monitor.solutionFound(t,r)))return!0;if((i=this.monitor.check(o))!==null)break;this.#r(s,n)}return i===!1&&!this.monitor.isTargetAssigned()&&e<r&&(t.apply(),i=!0),i}#r(e,t){if(this.#i(this.#n(e),t),0<t.size()){let r=this.#e?t.random():t.at(0);r.apply(),t.clear(),this.monitor.outputDebugString("	"+r)}else{for(let r of e)this.#t[r.index()]+=1;this.monitor.outputDebugString("Breakout")}}#i(e,t){let r=0;for(let n of e){let i=n.value(),s=0;for(let o of n)s+=(1-o.degree())*this.#t[o.index()];e:for(let o of n.domain()){if(i===o)continue;n.assign(o);let a=s;for(let l of n)if(a-=(1-l.degree())*this.#t[l.index()],a<r)continue e;r<a?(r=a,t.clear(),t.addVariable(n,o)):r!==0&&t.addVariable(n,o)}n.assign(i)}}#n(e){let t=new Set;for(let r of e)for(let n of r)t.add(n);return Array.from(t)}};var re=class extends p{#e=[];#t=[];#r;constructor(e,t=1){super(e),this.#r=t}name(){return"Fuzzy GENET"}exec(){if(!this.#i())throw new Error;let e=[...Array(this.#e.length).keys()],t=this.pro.degree(),r=new f,n=t;this.monitor.initialize();let i=null;for(;;){let s=this.pro.degree();if(this.monitor.outputDebugString(`Evaluation: ${s}`),n<s&&(r.setProblem(this.pro),n=s,this.monitor.solutionFound(r,n)))return!0;if((i=this.monitor.check(s))!==null)break;this.#n(e)}return i===!1&&!this.monitor.isTargetAssigned()&&t<n&&(r.apply(),i=!0),i}#i(){this.monitor.outputDebugString("Start of Network Generation");let e=[];for(let t of this.pro.variables()){if(t.domain().size()===0)return!1;this.#e.push(new me(t))}for(let t of this.pro.constraints())if(t.size()===1){let r=t.at(0),n=this.#e[r.index()];for(let i of n){let s=r.value();r.assign(i._value),t.degree()<=this.#r&&e.push(new ne(t,i)),r.assign(s)}}else{let r=t.at(0),n=t.at(1),i=this.#e[r.index()],s=this.#e[n.index()];for(let o of i){let a=r.value();r.assign(o._value);for(let l of s){let m=n.value();n.assign(l._value),t.degree()<=this.#r&&e.push(new ne(t,o,l)),n.assign(m)}r.assign(a)}}for(let t of this.#e)for(let r of t._neurons)r.lockConnections();return this.#t=e,this.monitor.outputDebugString("End of Network Generation"),!0}#n(e){let t=!1;for(let r of this.#s(e))this.#e[r].setActivityMaximumInput()&&(t=!0);if(t)for(let r of this.#e)r.applyToVariable();else for(let r of this.#t)r.refreshWeight()}#s(e){for(let t=e.length;t>1;--t){let r=fe(t),n=e[t-1];e[t-1]=e[r],e[r]=n}return e}},me=class{#e;#t=0;#r=[];_neurons=[];constructor(e){this.#e=e;for(let t of e.domain())this._neurons.push(new he(t));this.#i(fe(this._neurons.length))}#i(e){for(let t of this._neurons)t._isActive=!1;this._neurons[e]._isActive=!0,this.#t=e}applyToVariable(){this.#e.assign(this._neurons[this.#t]._value)}setActivityMaximumInput(){this.#r.length=0;let e=Number.NEGATIVE_INFINITY,t=!1;for(let r=0;r<this._neurons.length;++r){let n=this._neurons[r].getInput();e<=n&&(e<n&&(e=n,this.#r.length=0,t=!1),this.#r.push(r),this.#t===r&&(t=!0))}return t||this.#r.length===0?!1:(this.#i(this.#r[fe(this.#r.length)]),!0)}[Symbol.iterator](){return this._neurons[Symbol.iterator]()}},ne=class{#e;#t;#r;_weight;constructor(e,t,r=null){this.#e=e,this.#t=t,this.#r=r,this._weight=e.degree()-1,this.#t.addConnection(this),this.#r&&this.#r.addConnection(this)}getNeuron(e){return e===this.#t?this.#r:e===this.#r?this.#t:null}refreshWeight(){!this.#t._isActive||this.#r!==null&&!this.#r._isActive||(this.#e.size()===1?this._weight+=this.#e.relation().degree(this.#t._value)-1:this._weight+=this.#e.relation().degree(this.#t._value,this.#r._value)-1)}},he=class{#e=[];#t=[];_value;_isActive=!1;constructor(e){this._value=e}addConnection(e){this.#t.push(e)}lockConnections(){this.#e=[...this.#t],this.#t=null}getInput(){let e=0;for(let t of this.#e){let r=t.getNeuron(this);e+=t._weight*(r===null||r._isActive?1:0)}return e}};function fe(u){return Math.floor(Math.random()*Math.floor(u))}var P=class extends p{#e=!0;#t;#r=new Set;#i=new Set;#n=[];#s=[];constructor(e){super(e);for(let t of this.pro.constraints())this.#n.push(new be(t)),this.#s.push(null);this.#t=new Array(this.pro.constraintSize()),this.#t.fill(1)}name(){return"SRS3"}setRandomness(e){this.#e=e}exec(){for(let i of this.pro.variables())i.isEmpty()&&i.assign(i.domain().at(0));let e=this.pro.degree(),t=new f,r=e;this.monitor.initialize();let n=null;for(;;){let[i,s]=this.pro.constraintsWithDegree();if(this.monitor.outputDebugString(`Evaluation: ${s}`),r<s&&(t.setProblem(this.pro),r=s,this.monitor.solutionFound(t,r)))return!0;if((n=this.monitor.check(s))!==null)break;for(let a of this.#n)a.clear();let o=new Set;for(let a of i){let l=this.#n[a.index()];o.add(l)}this.#a(o)}return n===!1&&!this.monitor.isTargetAssigned()&&e<r&&(t.apply(),n=!0),n}#a(e){this.monitor.outputDebugString("SRS"),this.#r.clear(),this.#i.clear();for(let t of e)this.#i.add(t);for(;e.size&&this.#i.size;){let t=this.#h(this.#i);this.#i.delete(t),this.#l(t.constraint())?e.delete(t)||(t.parent()&&this.#l(t.parent().constraint())?this.#u(t,e):this.#o(t)):this.#o(t)}return e.size===0}#o(e){this.monitor.outputDebugString("Spread"),this.#r.add(e);for(let t of this.#m(e))!this.#r.has(t)&&!this.#i.has(t)&&(t.clear(),e.append(t),this.#i.add(t))}#l(e){this.monitor.outputDebugString("Repair"),this.#t[e.index()]+=1;let t=e.degree(),r=new f,n=0;for(let i of e){let s=i.value(),o=0;for(let a of i)o+=(1-a.degree())*this.#t[a.index()];e:for(let a of i.domain()){if(s===a||(i.assign(a),e.degree()<=t))continue;let l=o;for(let m of i)if(l-=(1-m.degree())*this.#t[m.index()],l<n)continue e;n<l?(n=l,r.clear(),r.addVariable(i,a)):n!==0&&r.addVariable(i,a)}i.assign(s)}if(0<r.size()){let i=this.#e?r.random():r.at(0);return i.apply(),this.monitor.outputDebugString("	"+i),!0}return!1}#u(e,t){this.monitor.outputDebugString("Shrink");let r=e,n=!1;for(;;){if(r=r.parent(),t.delete(r)){n=!0;break}if(!r.parent()||!this.#l(r.parent().constraint()))break}let i=[];r.getDescendants(i),r.clear();for(let s of i)this.#i.delete(s),this.#r.delete(s);n||this.#i.add(r)}#m(e){let t=e.constraint(),r=t.index();if(this.#s[r]===null){let n=[];for(let i of t.neighbors())n.push(this.#n[i.index()]);this.#s[r]=n}return this.#s[r]}#h(e){let t=this.#b(this.#f(e));return this.#e?t[Math.floor(Math.random()*t.length)]:t[0]}#b(e){let t=Number.MAX_VALUE,r=[];for(let n of e){let i=this.#t[n.constraint().index()];i<t?(t=i,r.length=0,r.push(n)):i===t&&r.push(n)}return r}#f(e){let t=Number.MAX_VALUE,r=[];for(let n of e){let i=n.depth();i<t?(t=i,r.length=0,r.push(n)):i===t&&r.push(n)}return r}},be=class{#e;#t=0;#r=null;#i=[];constructor(e){this.#e=e}append(e){e.#r=this,e.#t=this.#t+1,this.#i.push(e)}clear(){this.#r=null,this.#t=0;for(let e of this.#i)e.clear();this.#i.length=0}constraint(){return this.#e}depth(){return this.#t}parent(){return this.#r}getDescendants(e){e.push(this);for(let t of this.#i)t.getDescendants(e)}};function Pe(u,e,t=r=>console.log(r)){t("Start Post-Stabilization");let r,n=0;do{t("	Post-Stabilization: count "+n++),r=!1;let i=u.degree(),s=u.variables();for(let o=0;o<s.length;++o){let a=s[o],l=a.value(),m=e.at(o);l!==m.value()&&(m.apply(),i<=u.degree()?r=!0:a.assign(l))}}while(r);return t("Finish Post-Stabilization"),r}function Se(u,e){return new ce(u,e)}var ce=class extends p{#e;constructor(e,t){super(e),this.#e=t,this.setMonitor(t.getMonitor())}name(){return this.#e.name()+" + PF"}exec(){let e=0,t=0;this.monitor.isDebugMode()&&(e=this.pro.isFuzzy()?this.pro.degree():this.pro.ratio(),t=this.pro.emptyVariableSize());let r=new f;r.setProblem(this.pro);let n=this.#e.exec();return n&&Pe(this.pro,r,this.monitor.outputDebugString.bind(this.monitor)),this.monitor.outputDebugString(`Solver result: ${n?"Success":"Failure"}`),this.monitor.outputDebugString(`Evaluation: ${e} -> ${this.pro.isFuzzy()?this.pro.degree():this.pro.ratio()}`),this.monitor.outputDebugString(`Empty variable size: ${t} -> ${this.pro.emptyVariableSize()}`),n}};var xe=class u{static crispSolverNames(){return["Forward Checking","Max Forward Checking","Local Changes","Local Changes Ex","Breakout","GENET","Crisp SRS3"]}static fuzzySolverNames(){return["Full Checking","Fuzzy Forward Checking","Flexible Local Changes","Flexible Local Changes Ex","Fuzzy Breakout","Fuzzy GENET","SRS3","SRS3 PF"]}static async createSolver(e,t){let r=await u.createCrispSolver(e,t);if(r)return r;let n=await u.createFuzzySolver(e,t);return n||null}static async createCrispSolver(e,t){switch(e.replaceAll(" ","")){case"ForwardChecking":case"forward-checking":return new B(t);case"MaxForwardChecking":case"max-forward-checking":return new W(t);case"LocalChanges":case"local-changes":return new G(t);case"LocalChangesEx":case"local-changes-ex":return new H(t);case"Breakout":case"breakout":return new Y(t);case"GENET":case"genet":return new q(t);case"CrispSRS3":case"crisp-srs3":return new K(t)}return null}static async createFuzzySolver(e,t){switch(e.replaceAll(" ","")){case"FullChecking":case"full-checking":return new Q(t);case"FuzzyForwardChecking":case"fuzzy-forward-checking":return new Z(t);case"FlexibleLocalChanges":case"flexible-local-changes":return new X(t);case"FlexibleLocalChangesEx":case"flexible-local-changes-ex":return new ee(t);case"FuzzyBreakout":case"fuzzy-breakout":return new te(t);case"FuzzyGENET":case"fuzzy-genet":return new re(t);case"SRS3":case"srs3":return new P(t);case"SRS3PF":case"SRS3_PF":case"srs3-pf":return Se(t,new P(t))}return null}};var De=class u{static#e(e,t){for(let r of t.domain())if(t.assign(r),e.isSatisfied()===1)return!0;return!1}static#t(e,t,r){let n=t.value(),i=r.value(),s=t.domain(),o=[],a=e.constraintsBetween(t,r);e:for(let l of s){t.assign(l);for(let m of a)if(m.size()===2&&!u.#e(m,r))continue e;o.push(l)}if(t.assign(n),r.assign(i),o.length!==s.size()){let l=e.createDomain({values:o});return t.domain(l),console.log(s.size()+" -> "+l.size()),!0}return!1}static apply(e){let t=[];for(let r of e.constraints())r.size()===2&&t.push(r);for(;t.length;){let r=t.pop(),n=r.at(0),i=r.at(1);if(u.#t(e,n,i))for(let s of e.constraints())s.size()===2&&s.at(1)===n&&s.at(0)!==i&&t.unshift(s)}}};function Kr(u,e){for(let t of u.variables()){let r=t.domain(),n=t.value(),i=[];for(let s of t)if(s.size()===1){for(let o of r)t.assign(o),e<=s.degree()&&i.push(o);u.removeConstraint(s)}if(t.assign(n),i.length===0)return!1;t.domain(u.createDomain({values:i}))}return!0}function Qr(u){for(let e of u.variables()){let t=e.domain(),r=e.value(),n=[];for(let i of e)if(i.size()===1){for(let s of t)e.assign(s),i.isSatisfied()===1&&n.push(s);u.removeConstraint(i)}if(e.assign(r),n.length===0)return!1;e.domain(u.createDomain({values:n}))}return!0}var ye=class{#e;#t;#r=[];#i=[];#n=0;constructor(e=30,t=3){this.#e=e,this.#t=t,this.#o()}#s(e,t){this.#r[this.#n]=e,this.#i[this.#n]=t,--this.#n===-1&&(this.#n=this.#r.length-1)}#a(){let e=new Array(this.#e),t=new Array(this.#e);e:for(let r=1;r<=this.#e;++r){let n=this.#n+1;for(let s=0;s<r;++s)s+n===this.#r.length&&(n-=this.#r.length),e[s]=this.#r[s+n],t[s]=this.#i[s+n];let i=r;for(let s=0;s<this.#t-1;++s){n=this.#n+1;for(let o=0;o<r;++o)if(i+o+n>=this.#r.length&&(n-=this.#r.length),this.#r[i+o+n]!==e[o]||this.#i[i+o+n]!==t[o])continue e;i+=r}return r}return 0}#o(){this.#r=new Array(this.#e*this.#t),this.#i=new Array(this.#e*this.#t),this.#r.fill(-1),this.#i.fill(-1),this.#n=this.#r.length-1}checkLoop(e,t){return this.#s(e,t),this.#a()}clear(){this.#r.fill(-1),this.#i.fill(-1)}iterationCount(){return this.#t}loopLength(){return this.#e}values(){return this.#i.slice()}variableIndices(){return this.#r.slice()}};export{De as AC3,E as Assignment,f as AssignmentList,Y as Breakout,b as Constraint,_ as Constraint1,I as Constraint2,R as Constraint3,M as ConstraintN,L as CrispRelation,K as CrispSRS3,z as Domain,T as DomainArbitrary,ie as DomainPruner,k as DomainRanged,N as Element,X as FlexibleLocalChanges,ee as FlexibleLocalChangesEx,B as ForwardChecking,Q as FullChecking,te as FuzzyBreakout,Z as FuzzyForwardChecking,re as FuzzyGENET,A as FuzzyRelation,q as GENET,O as ImaginaryVariable,G as LocalChanges,H as LocalChangesEx,ye as LoopDetector,W as MaxForwardChecking,$ as Monitor,de as ObservableVariable,ce as PostStabilizerWrapper,U as Problem,F as Relation,P as SRS3,p as Solver,xe as SolverFactory,w as Variable,Qr as applyNodeConsistencyToCrispProblem,Kr as applyNodeConsistencyToProblem,Pe as applyPostStabilization,x as assignDomainPruner,we as averagePathLength,St as averagePathLengths,C as createRelatedConstraintTable,xt as domains,y as indexOfVariableWithMRV,yt as possibleDegreesOfUnaryConstraints,v as recover,Dt as setDomains,Ct as toViewAsCrispProblem,D as unassignDomainPruner,Se as wrapWithPostStabilizer};
//# sourceMappingURL=stlics.min.js.map

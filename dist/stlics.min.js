var S=class{#t=-1;#e="";userObject=null;solverObject=null;setIndex(t){this.#t=t}setName(t){this.#e=t}index(){return this.#t}name(){return this.#e}};var _=class m extends S{static#t=Number.MIN_VALUE;#e;#i;#r=m.#t;#s=[];constructor(t,e){super(),this.#e=t,this.#i=e}toString(){let t=this.name(),e=t?`(${t})`:"",i=this.isEmpty()?"<empty>":""+this.value();return`x${this.index()}${e} = ${i}`}size(){return this.#s.length}at(t){return this.#s.at(t)}has(t){return this.#s.includes(t)}indexOf(t){return this.#s.indexOf(t)}neighbors(){let t=[];for(let e of this.#s)for(let i of e)i!==this&&t.push(i);return t}[Symbol.iterator](){return this.#s[Symbol.iterator]()}owner(){return this.#e}connect(t){if(this.#s.includes(t))throw new RangeError;this.#s.push(t)}disconnect(t){if(!this.#s.includes(t))throw new RangeError;this.#s=this.#s.filter(e=>e!==t)}domain(t){if(t===void 0)return this.#i;this.#i=t,this.clear()}assign(t){this.#r=t}clear(){this.assign(m.#t)}value(){return this.#r}isEmpty(){return this.value()===m.#t}};var w=class{random(){return this.at(Math.floor(Math.random()*this.size()))}};var y=class extends w{#t;#e;constructor(t,e){super(),this.#t=t|0,this.#e=e|0}contains(t){return this.#t<=t&&t<=this.#e}indexOf(t){return this.#t<=t&&t<=this.#e?t-this.#t:-1}size(){return this.#e-this.#t+1}at(t){return this.#t+t}[Symbol.iterator](){let t=this.#t,e=this.#e;return{next(){return t<=e?{value:t++,done:!1}:{value:null,done:!0}}}}};var z=class extends w{#t;constructor(t){super(),this.#t=[...t]}contains(t){return this.#t.includes(t)}indexOf(t){return this.#t.indexOf(t)}size(){return this.#t.length}at(t){return this.#t[t]}[Symbol.iterator](){return this.#t[Symbol.iterator]()}};var c=class m extends S{static UNDEFINED=-1;rel;constructor(t){super(),this.rel=t}crispRelation(){return this.rel}fuzzyRelation(){return this.rel}isFuzzy(){return"satisfactionDegree"in this.rel}toString(){let t=this.name(),e=t?`(${t})`:"",i=this.satisfactionDegree(),r=i===m.UNDEFINED?"UNDEFINED":""+i;return`c${this.index()}${e} = ${r}`}};var E=class extends c{#t=[];constructor(t,e){super(t),this.#t=[e]}size(){return 1}at(t){return this.#t.at(t)}has(t){return t===this.#t[0]}indexOf(t){return t===this.#t[0]?0:-1}neighbors(){let t=[];for(let e of this.#t[0])e!==this&&t.push(e);return t}[Symbol.iterator](){return this.#t[Symbol.iterator]()}emptyVariableSize(){return this.#t[0].isEmpty()?1:0}isDefined(){return!this.#t[0].isEmpty()}isSatisfied(){return this.#t[0].isEmpty()?c.UNDEFINED:this.crispRelation().isSatisfied(this.#t[0].value())?1:0}satisfactionDegree(){return this.#t[0].isEmpty()?c.UNDEFINED:this.fuzzyRelation().satisfactionDegree(this.#t[0].value())}highestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==c.UNDEFINED)return t;let e=0;for(let i of this.#t[0].domain()){let r=this.fuzzyRelation().satisfactionDegree(i);if(r>e&&(e=r),e===1)break}return e}lowestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==c.UNDEFINED)return t;let e=1;for(let i of this.#t[0].domain()){let r=this.fuzzyRelation().satisfactionDegree(i);if(r<e&&(e=r),e===0)break}return e}};var N=class extends c{#t=[];constructor(t,e,i){super(t),this.#t=[e,i]}size(){return 2}at(t){return this.#t.at(t)}has(t){return this.#t[0]===t||this.#t[1]===t}indexOf(t){return t===this.#t[0]?0:t===this.#t[1]?1:-1}neighbors(){let t=[];for(let e of this.#t[0])e!==this&&t.push(e);for(let e of this.#t[1])e!==this&&t.push(e);return t}[Symbol.iterator](){return this.#t[Symbol.iterator]()}emptyVariableSize(){let t=0;return this.#t[0].isEmpty()&&++t,this.#t[1].isEmpty()&&++t,t}isDefined(){return!this.#t[0].isEmpty()&&!this.#t[1].isEmpty()}isSatisfied(){return this.#t[0].isEmpty()||this.#t[1].isEmpty()?c.UNDEFINED:this.crispRelation().isSatisfied(this.#t[0].value(),this.#t[1].value())?1:0}satisfactionDegree(){return this.#t[0].isEmpty()||this.#t[1].isEmpty()?c.UNDEFINED:this.fuzzyRelation().satisfactionDegree(this.#t[0].value(),this.#t[1].value())}highestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==c.UNDEFINED)return t;let e=0,i=this.#t[0].value(),r=this.#t[1].value(),n=this.#t[0].domain(),s=this.#t[1].domain();if(this.#t[0].isEmpty()&&!this.#t[1].isEmpty())for(let o of n){let a=this.fuzzyRelation().satisfactionDegree(o,r);if(a>e&&(e=a),e===1)break}else if(!this.#t[0].isEmpty()&&this.#t[1].isEmpty())for(let o of s){let a=this.fuzzyRelation().satisfactionDegree(i,o);if(a>e&&(e=a),e===1)break}else for(let o of n)for(let a of s){let u=this.fuzzyRelation().satisfactionDegree(o,a);if(u>e&&(e=u),e===1)break}return e}lowestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==c.UNDEFINED)return t;let e=1,i=this.#t[0].value(),r=this.#t[1].value(),n=this.#t[0].domain(),s=this.#t[1].domain();if(this.#t[0].isEmpty()&&!this.#t[1].isEmpty())for(let o of n){let a=this.fuzzyRelation().satisfactionDegree(o,r);if(a<e&&(e=a),e===0)break}else if(!this.#t[0].isEmpty()&&this.#t[1].isEmpty())for(let o of s){let a=this.fuzzyRelation().satisfactionDegree(i,o);if(a<e&&(e=a),e===0)break}else for(let o of n)for(let a of s){let u=this.fuzzyRelation().satisfactionDegree(o,a);if(u<e&&(e=u),e===0)break}return e}};var A=class extends c{#t=[];constructor(t,e,i,r){super(t),this.#t=[e,i,r]}size(){return 3}at(t){return this.#t.at(t)}has(t){return this.#t[0]===t||this.#t[1]===t||this.#t[2]===t}indexOf(t){return t===this.#t[0]?0:t===this.#t[1]?1:t===this.#t[2]?2:-1}neighbors(){let t=[];for(let e of this.#t[0])e!==this&&t.push(e);for(let e of this.#t[1])e!==this&&t.push(e);for(let e of this.#t[2])e!==this&&t.push(e);return t}[Symbol.iterator](){return this.#t[Symbol.iterator]()}emptyVariableSize(){let t=0;return this.#t[0].isEmpty()&&++t,this.#t[1].isEmpty()&&++t,this.#t[2].isEmpty()&&++t,t}isDefined(){return!this.#t[0].isEmpty()&&!this.#t[1].isEmpty()&&!this.#t[2].isEmpty()}isSatisfied(){return this.#t[0].isEmpty()||this.#t[1].isEmpty()||this.#t[2].isEmpty()?c.UNDEFINED:this.crispRelation().isSatisfied(this.#t[0].value(),this.#t[1].value(),this.#t[2].value())?1:0}satisfactionDegree(){return this.#t[0].isEmpty()||this.#t[1].isEmpty()||this.#t[2].isEmpty()?c.UNDEFINED:this.fuzzyRelation().satisfactionDegree(this.#t[0].value(),this.#t[1].value(),this.#t[2].value())}highestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==c.UNDEFINED)return t;let e=1,i=this.#t[0].value(),r=this.#t[1].value(),n=this.#t[2].value(),s=this.#t[0].domain(),o=this.#t[1].domain(),a=this.#t[2].domain();if(this.#t[0].isEmpty()&&!this.#t[1].isEmpty()&&!this.#t[2].isEmpty())for(let u of s){let l=this.fuzzyRelation().satisfactionDegree(u,r,n);if(l>e&&(e=l),e===1)break}else if(!this.#t[0].isEmpty()&&this.#t[1].isEmpty()&&!this.#t[2].isEmpty())for(let u of o){let l=this.fuzzyRelation().satisfactionDegree(i,u,n);if(l>e&&(e=l),e===1)break}else if(!this.#t[0].isEmpty()&&!this.#t[1].isEmpty()&&this.#t[2].isEmpty())for(let u of a){let l=this.fuzzyRelation().satisfactionDegree(i,r,u);if(l>e&&(e=l),e===1)break}else if(this.#t[0].isEmpty()&&this.#t[1].isEmpty()&&!this.#t[2].isEmpty())for(let u of s)for(let l of o){let h=this.fuzzyRelation().satisfactionDegree(u,l,n);if(h>e&&(e=h),e===1)break}else if(this.#t[0].isEmpty()&&!this.#t[1].isEmpty()&&this.#t[2].isEmpty())for(let u of s)for(let l of a){let h=this.fuzzyRelation().satisfactionDegree(u,r,l);if(h>e&&(e=h),e===1)break}else if(!this.#t[0].isEmpty()&&this.#t[1].isEmpty()&&this.#t[2].isEmpty())for(let u of o)for(let l of a){let h=this.fuzzyRelation().satisfactionDegree(i,u,l);if(h>e&&(e=h),e===1)break}else for(let u of s)for(let l of o)for(let h of a){let b=this.fuzzyRelation().satisfactionDegree(u,l,h);if(b>e&&(e=b),e===1)break}return e}lowestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==c.UNDEFINED)return t;let e=1,i=this.#t[0].value(),r=this.#t[1].value(),n=this.#t[2].value(),s=this.#t[0].domain(),o=this.#t[1].domain(),a=this.#t[2].domain();if(this.#t[0].isEmpty()&&!this.#t[1].isEmpty()&&!this.#t[2].isEmpty())for(let u of s){let l=this.fuzzyRelation().satisfactionDegree(u,r,n);if(l<e&&(e=l),e===0)break}else if(!this.#t[0].isEmpty()&&this.#t[1].isEmpty()&&!this.#t[2].isEmpty())for(let u of o){let l=this.fuzzyRelation().satisfactionDegree(i,u,n);if(l<e&&(e=l),e===0)break}else if(!this.#t[0].isEmpty()&&!this.#t[1].isEmpty()&&this.#t[2].isEmpty())for(let u of a){let l=this.fuzzyRelation().satisfactionDegree(i,r,u);if(l<e&&(e=l),e===0)break}else if(this.#t[0].isEmpty()&&this.#t[1].isEmpty()&&!this.#t[2].isEmpty())for(let u of s)for(let l of o){let h=this.fuzzyRelation().satisfactionDegree(u,l,n);if(h<e&&(e=h),e===0)break}else if(this.#t[0].isEmpty()&&!this.#t[1].isEmpty()&&this.#t[2].isEmpty())for(let u of s)for(let l of a){let h=this.fuzzyRelation().satisfactionDegree(u,r,l);if(h<e&&(e=h),e===0)break}else if(!this.#t[0].isEmpty()&&this.#t[1].isEmpty()&&this.#t[2].isEmpty())for(let u of o)for(let l of a){let h=this.fuzzyRelation().satisfactionDegree(i,u,l);if(h<e&&(e=h),e===0)break}else for(let u of s)for(let l of o)for(let h of a){let b=this.fuzzyRelation().satisfactionDegree(u,l,h);if(b<e&&(e=b),e===0)break}return e}};var L=class extends c{#t;#e;constructor(t,...e){super(t),this.#t=[...e],this.#e=new Array(this.#t.length)}size(){return this.#t.length}at(t){return this.#t.at(t)}has(t){return this.#t.includes(t)}indexOf(t){return this.#t.indexOf(t)}neighbors(){let t=[];for(let e of this.#t)for(let i of e)i!==this&&t.push(i);return t}[Symbol.iterator](){return this.#t[Symbol.iterator]()}emptyVariableSize(){let t=0;for(let e of this.#t)e.isEmpty()&&++t;return t}isDefined(){for(let t of this.#t)if(t.isEmpty())return!1;return!0}isSatisfied(){for(let t=0;t<this.#t.length;++t){let e=this.#t[t];if(e.isEmpty())return-1;this.#e[t]=e.value()}return this.crispRelation().isSatisfied(...this.#e)?1:0}satisfactionDegree(){for(let t=0;t<this.#t.length;++t){let e=this.#t[t];if(e.isEmpty())return c.UNDEFINED;this.#e[t]=e.value()}return this.fuzzyRelation().satisfactionDegree(...this.#e)}highestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==c.UNDEFINED)return t;let e=new Array(this.emptyVariableSize()),i=0;for(let r=0;r<this.#t.length;++r){let n=this.#t[r];n.isEmpty()?e[i++]=r:this.#e[r]=n.value()}return this.checkHCD(e,0,0)}lowestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==c.UNDEFINED)return t;let e=new Array(this.emptyVariableSize()),i=0;for(let r=0;r<this.#t.length;++r){let n=this.#t[r];n.isEmpty()?e[i++]=r:this.#e[r]=n.value()}return this.checkLCD(e,0,1)}checkHCD(t,e,i){let r=t[e],n=this.#t[r].domain();if(e===t.length-1)for(let s of n){this.#e[r]=s;let o=this.fuzzyRelation().satisfactionDegree(...this.#e);if(o>i&&(i=o),i===1)break}else for(let s of n)this.#e[r]=s,i=this.checkLCD(t,e+1,i);return i}checkLCD(t,e,i){let r=t[e],n=this.#t[r].domain();if(e===t.length-1)for(let s of n){this.#e[r]=s;let o=this.fuzzyRelation().satisfactionDegree(...this.#e);if(o<i&&(i=o),i===0)break}else for(let s of n)this.#e[r]=s,i=this.checkLCD(t,e+1,i);return i}};var O=class{#t=(t,e)=>new _(t,e);#e=(t,e)=>e.length===1?new E(t,e[0]):e.length===2?new N(t,e[0],e[1]):e.length===3?new A(t,e[0],e[1],e[2]):new L(t,...e);#i=!1;#r=[];#s=[];setVariableFactory(t){this.#t=t}setConstraintFactory(t){this.#e=t}addVariable(t){t.setIndex(this.#r.length),this.#r.push(t)}createDomain(t){return"values"in t?new z(t.values):"min"in t&&"max"in t?new y(t.min,t.max):null}createVariable(t){if("variable"in t){let e=this.#t(this,t.variable.domain());return this.addVariable(e),e.setName(e.name()),e.assign(e.value()),e}else{if(t.value!==void 0&&!t.domain.contains(t.value))throw new Error;let e=this.#t(this,t.domain);return this.addVariable(e),t.name&&e.setName(t.name),t.value&&e.assign(t.value),e}}createConstraint(t){for(let i of t.variables)if(i.owner()!==this)return null;let e=this.#e(t.relation,t.variables);e.setIndex(this.#s.length),this.#s.push(e);for(let i of t.variables)i.connect(e);return e.isFuzzy()&&(this.#i=!0),"name"in t&&e.setName(t.name),e}removeConstraint(t){let e=this.#s.indexOf(t);this.#s.splice(e,1);for(let i=e;i<this.#s.length;++i)this.#s[i].setIndex(i);for(let i of t)i.disconnect(t);this.#i=!1;for(let i of this.#s)if(i.isFuzzy()){this.#i=!0;break}}clearAllVariables(){for(let t of this.#r)t.clear()}reverseVariables(){this.#r.reverse();for(let t=0;t<this.#r.length;++t)this.#r[t].setIndex(t)}sortVariables(t){this.#r.sort(t);for(let e=0;e<this.#r.length;++e)this.#r[e].setIndex(e)}variableSize(){return this.#r.length}variableAt(t){return this.#r[t]}variableOf(t){for(let e of this.#r)if(e.name()===t)return e;return null}hasVariable(t){return this.#r.includes(t)}variables(){return this.#r}constraintSize(){return this.#s.length}constraintAt(t){return this.#s[t]}constraintOf(t){for(let e of this.#s)if(e.name()===t)return e;return null}hasConstraint(t){return this.#s.includes(t)}constraints(){return this.#s}constraintsBetween(t,e){let i=[];for(let r of t)r.has(e)&&i.push(r);return i}constraintsWithWorstSatisfactionDegree(){let t=[],e=1;for(let i of this.#s){let r=i.satisfactionDegree();r<e?(e=r,t.length=0,t.push(i)):r-e<Number.MIN_VALUE*10&&t.push(i)}return[t,e]}worstSatisfactionDegree(){let t=1;for(let e of this.#s){let i=e.satisfactionDegree();if(i===c.UNDEFINED)return c.UNDEFINED;i<t&&(t=i)}return t}averageSatisfactionDegree(){let t=0;for(let e of this.#s)t+=e.satisfactionDegree();return t=t/this.#s.length,t}emptyVariableSize(){let t=0;for(let e of this.#r)e.isEmpty()&&t++;return t}constraintDensity(){return this.constraintSize()/this.variableSize()}hasEmptyDomain(){for(let t of this.#r)if(t.domain().size()===0)return!0;return!1}isFuzzy(){return this.#i}};var P=class extends O{createConstraint(t){if("satisfactionDegree"in t.relation)throw new Error;return super.createConstraint(t)}isFuzzy(){return!1}satisfiedConstraintRate(){return this.satisfiedConstraintSize()/this.constraintSize()}satisfiedConstraintSize(){let t=0;for(let e of this.constraints())e.isSatisfied()===1&&++t;return t}violatingConstraints(){let t=[];for(let e of this.constraints())e.isSatisfied()===0&&t.push(e);return t}violatingConstraintSize(){let t=0;for(let e of this.constraints())e.isSatisfied()===0&&++t;return t}};var ot=class extends _{#t;constructor(t,e,i){super(t,e),this.#t=i}assign(t){super.assign(t),this.#t&&this.#t(this,t)}},k=class extends _{#t;constructor(t){super(t.owner(),t.domain()),this.#t=t,this.setName(t.name()),this.assign(t.value())}assign(t){this.#t.assign(t)}domain(t){if(t===void 0)return this.#t.domain();this.#t.domain(t)}value(){return this.#t.value()}};var d=class{_debug=!0;#t=t=>console.log(t);_pro;_iterLimit=null;_timeLimit=null;_targetDeg=.8;#e=[];constructor(t){this._pro=t}name(){return""}exec(){return!1}setIterationLimit(t=null){this._iterLimit=t}setTimeLimit(t=null){this._timeLimit=t}setTargetRate(t=null){this._targetDeg=t}solve(){return this.exec()}addListener(t){this.#e.push(t)}removeListener(t){this.#e.splice(this.#e.indexOf(t),1)}foundSolution(t,e){let i=!1;for(let r of this.#e)r.foundSolution(t,e)&&(i=!0);return i}setDebugMode(t){this._debug=t}setDebugOutput(t){this.#t=t}_debugOutput(t){this._debug&&this.#t(t)}};var C=class{#t;#e;constructor(t){if("assignment"in t)this.#t=t.assignment.variable(),this.#e=t.assignment.value();else if("variable"in t)this.#t=t.variable,this.#e=t.value??t.variable.value();else throw new RangeError}apply(){this.#t.assign(this.#e)}toString(){return`v${this.#t.index()} <- ${this.#e}`}value(){return this.#e}variable(){return this.#t}};var f=class m{static fromVariables(t){let e=new m;return e.setVariables(t),e}#t=[];constructor(){}setProblem(t){this.#t.length=0;for(let e of t.variables())this.#t.push(new C({variable:e,value:e.value()}))}setAssignmentList(t){this.#t.length=0;for(let e of t)this.#t.push(new C({variable:e.variable(),value:e.value()}))}setVariables(t){this.#t.length=0;for(let e of t)this.#t.push(new C({variable:e,value:e.value()}))}addVariable(t,e=null){this.#t.push(new C({variable:t,value:e}))}apply(){for(let t of this.#t)t.apply()}clear(){this.#t.length=0}isEmpty(){return this.#t.length===0}size(){return this.#t.length}differenceSize(){let t=0;for(let e of this.#t)e.variable().value()!==e.value()&&++t;return t}at(t){return this.#t[t]}[Symbol.iterator](){return this.#t[Symbol.iterator]()}random(){return this.#t[Math.floor(Math.random()*this.#t.length)]}};var v=class m{static#t=-1;#e;#i=0;constructor(t){this.#e=new Array(t),this.#e.fill(m.#t)}hiddenSize(){return this.#i}hide(t,e){this.#e[t]===m.#t&&++this.#i,this.#e[t]=e}isEmpty(){return this.#e.length===this.#i}isValueHidden(t){return this.#e[t]!==m.#t}reveal(t){for(let e=0;e<this.#e.length;++e)this.#e[e]===t&&(this.#e[e]=m.#t,--this.#i)}revealAll(){this.#e.fill(m.#t),this.#i=0}};var T=class extends d{#t;#e=new f;#i=[];#r=!1;#s=0;#n=0;constructor(t){super(t),this.#t=[...this._pro.variables()];for(let e of this.#t)e.solverObject=new v(e.domain().size());this.#o()}name(){return"Forward Checking"}setTargetRate(){}setUsingMinimumRemainingValuesHeuristics(t){this.#r=t}#o(){this.#i=[];for(let t=0;t<this.#t.length;++t){this.#i.push(new Array(this.#t.length));for(let e=0;e<this.#t.length;++e)e<t&&(this.#i[t][e]=this._pro.constraintsBetween(this.#t[e],this.#t[t]))}}#a(t,e){return t<e?this.#i[e][t]:this.#i[t][e]}#u(t,e){for(let i of this.#t){if(!i.isEmpty())continue;let r=i.domain(),n=i.solverObject,s=this.#a(e,i.index());for(let o of s)if(o.emptyVariableSize()===1){for(let a=0,u=r.size();a<u;++a)n.isValueHidden(a)||(i.assign(r.at(a)),o.isSatisfied()===0&&n.hide(a,t));if(i.clear(),n.isEmpty())return!1}}return!0}#l(){let t=0,e=Number.MAX_VALUE;for(let i=0;i<this.#t.length;++i){let r=this.#t[i];if(!r.isEmpty())continue;let s=r.domain().size()-r.solverObject.hiddenSize();s<e&&(e=s,t=i)}return t}#m(t){if(this._iterLimit&&this._iterLimit<this.#s++||this.#n<Date.now())return!1;if(t===this._pro.variableSize())return this.#e.setProblem(this._pro),!0;let e=this.#r?this.#l():t,i=this.#t[e],r=i.domain(),n=i.solverObject;for(let s=0,o=r.size();s<o;++s)if(!n.isValueHidden(s)){if(i.assign(r.at(s)),this.#u(t,e)&&this.#m(t+1))return!0;for(let a of this.#t)a.solverObject.reveal(t)}return i.clear(),!1}exec(){this.#n=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#s=0,this._pro.clearAllVariables();let t=this.#m(0);t||(this._iterLimit&&this._iterLimit<this.#s&&this._debugOutput("stop: number of iterations has reached the limit"),this.#n<Date.now()&&this._debugOutput("stop: time limit has been reached"));for(let e of this.#e)e.apply(),e.variable().solverObject.revealAll();return t}};var R=class extends d{#t;#e=new f;#i;#r=0;#s=new Set;#n=[];#o=0;#a=0;constructor(t){super(t),this.#t=[...this._pro.variables()];for(let e of this.#t)e.solverObject=new v(e.domain().size());this.#i=this._pro.constraintSize()}name(){return"Forward Checking for Max CSPs"}#u(t,e){if(this._iterLimit&&this._iterLimit<this.#o++||this.#a<Date.now())return!1;let i=this._pro;if(t===i.variableSize()){let o=i.violatingConstraintSize();return o<this.#i&&(this.#i=o,this.#e.setProblem(this._pro),this._debugOutput(`   refreshed ${this.#i}`),(this._targetDeg??1)<=i.satisfiedConstraintRate())}let r=this.#t[t],n=r.domain(),s=r.solverObject;for(let o=0,a=n.size();o<a;++o)if(!s.isValueHidden(o)&&(r.assign(n.at(o)),this.#r=e+this.#m(t,r),!(this.#r>this.#i))){if(this.#l(t)&&this.#u(t+1,this.#r))return!0;for(let u of this.#t)u.solverObject.reveal(t)}return r.clear(),!1}#l(t){let e=this.#t[t];for(let i=t+1;i<this.#t.length;++i){let r=this.#t[i];this.#n=this._pro.constraintsBetween(e,r);for(let n of this.#n)if(n.emptyVariableSize()===1&&this.#h(r,n,t)&&r.solverObject.isEmpty())return!1}return!0}#m(t,e){let i=0;this.#s.clear();for(let r=0;r<t;++r){this.#n=this._pro.constraintsBetween(e,this.#t[r]);for(let n of this.#n)this.#s.has(n)||(n.isSatisfied()===0&&++i,this.#s.add(n))}return i}#h(t,e,i){let r=!1,n=t.domain(),s=t.solverObject;for(let o=0,a=n.size();o<a;++o)s.isValueHidden(o)||(t.assign(n.at(o)),e.isSatisfied()===0&&this.#r+1>this.#i&&(s.hide(o,i),r=!0));return r}exec(){this.#a=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#o=0,this._pro.clearAllVariables();let t=this.#u(0,0);t?this._debugOutput("stop: current degree is above the target"):(this._iterLimit&&this._iterLimit<this.#o&&this._debugOutput("stop: number of iterations has reached the limit"),this.#a<Date.now()&&this._debugOutput("stop: time limit has been reached"));for(let e of this.#e)e.apply(),e.variable().solverObject.revealAll();return t}};var I=class m extends d{static#t(t,e){return new Set(t).add(e)}static#e(t,e){let i=new Set(t);return i.delete(e),i}#i=0;#r=0;#s=!1;constructor(t,e=!1){super(t),e&&this._pro.clearAllVariables()}name(){return"Local Changes"}#n(t,e,i){let r=new Set,n=new Set;for(let o of t){let a=this._pro.constraintsBetween(e,o);for(let u of a)n.add(u)}let s=e.value();e.assign(i);for(let o of n)if(o.isSatisfied()===0)for(let a of o)r.add(a);return e.assign(s),r.delete(e),r}#o(t,e,i){let r=new Set;for(let s of t){let o=this._pro.constraintsBetween(e,s);for(let a of o)r.add(a)}let n=e.value();e.assign(i);for(let s of r)if(s.isSatisfied()===0)return e.assign(n),!1;return e.assign(n),!0}#a(t,e,i,r){if(!this.#o(t,i,r))return!1;let n=t.union(e);if(this.#o(n,i,r))return!0;let s=this.#n(n,i,r),o=n.difference(s);this.#o(o,i,r)||this._debugOutput("bug");for(let a of s)a.clear();return t=m.#t(t,i),e=e.difference(s),this.#l(t,e,s)}#u(t,e,i,r){if(r.size===0)return!1;let n=r.values().next().value,s=f.fromVariables(e);i.assign(n);let o=this.#a(t,e,i,n);return o||this.#s?o:(i.clear(),s.apply(),this.#u(t,e,i,m.#e(r,n)))}#l(t,e,i){if(this._debugOutput(`X1 ${t.size}, X2' ${e.size}, X3' ${i.size}`),(this._targetDeg??1)<=this._pro.satisfiedConstraintRate())return this._debugOutput("stop: current degree is above the target"),this.#s=!0,!0;if(this._iterLimit&&this._iterLimit<this.#i++)return this._debugOutput("stop: number of iterations has reached the limit"),this.#s=!0,!1;if(this.#r<Date.now())return this._debugOutput("stop: time limit has been reached"),this.#s=!0,!1;if(i.size===0)return!0;let r=i.values().next().value,n=new Set;for(let o of r.domain())n.add(o);let s=this.#u(t,e,r,n);return!s||this.#s?s:(e=m.#t(e,r),i=m.#e(i,r),this.#l(t,e,i))}exec(){this.#r=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#i=0,this.#s=!1,this._pro.emptyVariableSize()===0&&this._pro.clearAllVariables();let t=new Set,e=new Set;for(let i of this._pro.variables())(i.isEmpty()?e:t).add(i);return this.#l(new Set,t,e)}};var F=class m extends d{static#t(t,e){return new Set(t).add(e)}#e=0;#i=0;#r=!1;constructor(t,e=!1){super(t),e&&this._pro.clearAllVariables()}name(){return"Local Changes Ex"}#s(t,e,i){let r=new Set,n=new Set;for(let o of t){let a=this._pro.constraintsBetween(e,o);for(let u of a)n.add(u)}let s=e.value();e.assign(i);for(let o of n)if(o.isSatisfied()===0)for(let a of o)r.add(a);return e.assign(s),r.delete(e),r}#n(t,e,i){let r=new Set;for(let s of t){let o=this._pro.constraintsBetween(e,s);for(let a of o)r.add(a)}let n=e.value();e.assign(i);for(let s of r)if(s.isSatisfied()===0)return e.assign(n),!1;return e.assign(n),!0}#o(t,e,i){if(!this.#n(t,i,i.value()))return!1;let r=t.union(e);if(this.#n(r,i,i.value()))return!0;let n=this.#s(r,i,i.value());return t=m.#t(t,i),e=e.difference(n),this.#u(t,e,n)}#a(t,e,i){for(let r of i.domain()){let n=f.fromVariables(e);i.assign(r);let s=this.#o(t,e,i);if(s||this.#r)return s;i.clear(),n.apply()}return!1}#u(t,e,i){for(e=new Set(e),i=new Set(i);;){if(this._debugOutput(`X1 ${t.size}, X2' ${e.size}, X3' ${i.size}`),(this._targetDeg??1)<=this._pro.satisfiedConstraintRate())return this._debugOutput("stop: current degree is above the target"),this.#r=!0,!0;if(this._iterLimit&&this._iterLimit<this.#e++)return this._debugOutput("stop: number of iterations has reached the limit"),this.#r=!0,!1;if(this.#i<Date.now())return this._debugOutput("stop: time limit has been reached"),this.#r=!0,!1;if(i.size===0)return!0;let r=i.values().next().value,n=this.#a(t,e,r);if(!n||this.#r)return n;e.add(r),i.delete(r)}}exec(){this.#i=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#e=0,this.#r=!1,this._pro.emptyVariableSize()===0&&this._pro.clearAllVariables();let t=new Set,e=new Set;for(let i of this._pro.variables())(i.isEmpty()?e:t).add(i);return this.#u(new Set,t,e)}};var M=class extends d{#t=!0;#e;constructor(t){super(t),this.#e=new Array(this._pro.constraintSize()),this.#e.fill(1)}name(){return"Breakout"}setRandomness(t){this.#t=t}#i(t,e){let i=0;for(let r of t){let n=r.value(),s=0;for(let o of r)s+=(1-o.isSatisfied())*this.#e[o.index()];t:for(let o of r.domain()){if(n===o)continue;r.assign(o);let a=s;for(let u of r)if(a-=(1-u.isSatisfied())*this.#e[u.index()],a<i)continue t;a>i?(i=a,e.clear(),e.addVariable(r,o)):i!==0&&e.addVariable(r,o)}r.assign(n)}}#r(t){let e=new Set;for(let i of t)for(let r of i)e.add(r);return Array.from(e)}exec(){let t=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,e=0;for(let n of this._pro.variables())n.isEmpty()&&n.assign(n.domain().at(0));let i=new f,r=this._pro;for(;;){let n=r.violatingConstraints();if((this._targetDeg??1)<=r.satisfiedConstraintRate())return this._debugOutput("stop: current degree is above the target"),!0;if(this._iterLimit&&this._iterLimit<e++)return this._debugOutput("stop: number of iterations has reached the limit"),!1;if(t<Date.now())return this._debugOutput("stop: time limit has been reached"),!1;if(this._debugOutput(n.length+" violations"),this.#i(this.#r(n),i),0<i.size()){let s=this.#t?i.random():i.at(0);s.apply(),i.clear(),this._debugOutput("	"+s)}else{for(let s of n)this.#e[s.index()]+=1;this._debugOutput("breakout")}}}};var j=class m extends d{static nextInt(t){return Math.floor(Math.random()*Math.floor(t))}#t=[];#e=[];constructor(t){super(t)}name(){return"GENET"}#i(){this._debugOutput("network creation start");let t=[];for(let e of this._pro.variables()){if(e.domain().size()===0)return!1;this.#t.push(new Z(e))}for(let e of this._pro.constraints())if(e.size()===1){let i=e.at(0),r=this.#t[i.index()];for(let n=0;n<r.size();++n){let s=i.value();i.assign(r.get(n)._value),e.isSatisfied()===0&&t.push(new U(r.get(n))),i.assign(s)}}else{let i=e.at(0),r=e.at(1),n=this.#t[i.index()],s=this.#t[r.index()];for(let o=0;o<n.size();++o){let a=i.value();i.assign(n.get(o)._value);for(let u=0;u<s.size();++u){let l=r.value();r.assign(s.get(u)._value),e.isSatisfied()===0&&t.push(new U(n.get(o),s.get(u))),r.assign(l)}i.assign(a)}}for(let e of this.#t)for(let i of e._neurons)i.lockConnections();return this.#e=t,this._debugOutput("network creation complete"),!0}#r(t){for(let e=t.length;e>1;--e){let i=m.nextInt(e),r=t[e-1];t[e-1]=t[i],t[i]=r}return t}exec(){if(!this.#i())throw new Error;let t=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,e=0,i=new f,r=[];for(let a=0;a<this.#t.length;++a)r.push(a);let n=this._pro,s=n.satisfiedConstraintRate(),o=!1;for(;;){if(this._iterLimit&&this._iterLimit<e++){this._debugOutput("stop: number of iterations has reached the limit");break}if(t<Date.now()){this._debugOutput("stop: time limit has been reached");break}let a=!1;for(let u of this.#r(r))this.#t[u].setActivityMaximumInput()&&(a=!0);if(a){for(let l of this.#t)l.applyToVariable();let u=n.satisfiedConstraintRate();if(s<u){if(s=u,this._debugOutput(`satisfied constraint rate: ${u}`),i.setProblem(this._pro),this.foundSolution(i,u)){o=!0;break}if(this._targetDeg??1<=s){this._debugOutput("stop: current degree is above the target"),o=!0;break}}}else for(let u of this.#e)u.refreshWeight()}return i.apply(),o}},Z=class m{static nextInt(t){return Math.floor(Math.random()*Math.floor(t))}#t;#e=0;#i=[];_neurons=[];constructor(t){this.#t=t;for(let e of t.domain())this._neurons.push(new X(e));this.#r(m.nextInt(this._neurons.length))}#r(t){for(let e of this._neurons)e._isActive=!1;this._neurons[t]._isActive=!0,this.#e=t}applyToVariable(){this.#t.assign(this._neurons[this.#e]._value)}get(t){return this._neurons[t]}neurons(){return this._neurons}setActivityMaximumInput(){this.#i.length=0;let t=Number.NEGATIVE_INFINITY,e=!1;for(let i=0;i<this._neurons.length;++i){let r=this._neurons[i].getInput();t<=r&&(t<r&&(t=r,this.#i.length=0,e=!1),this.#i.push(i),this.#e===i&&(e=!0))}return e||this.#i.length===0?!1:(this.#r(this.#i[m.nextInt(this.#i.length)]),!0)}size(){return this._neurons.length}},U=class{#t;#e;_weight;constructor(t,e=null){this._weight=-1,this.#t=t,this.#t.addConnection(this),this.#e=e,this.#e&&this.#e.addConnection(this)}getNeuron(t){return t===this.#t?this.#e:t===this.#e?this.#t:null}refreshWeight(){!this.#t._isActive||this.#e!==null&&!this.#e._isActive||(this._weight+=-1)}},X=class{#t=[];#e=[];_value;_isActive=!1;constructor(t){this._value=t}addConnection(t){this.#t.push(t)}lockConnections(){this.#e=[...this.#t],this.#t=null}getInput(){let t=0;for(let e of this.#e){let i=e.getNeuron(this);t+=e._weight*(i===null||i._isActive?1:0)}return t}};var $=class extends d{#t=!0;#e=new Set;#i=new Set;#r=[];#s=[];constructor(t){super(t);for(let e of this._pro.constraints())this.#r.push(new tt(e)),this.#s.push(null)}name(){return"SRS 3 for Crisp CSPs"}setRandomness(t){this.#t=t}#n(t){let e=t.index();return this.#s[e]===null&&(this.#s[e]=t.neighbors()),this.#s[e]}#o(t){this._debugOutput("repair");let e=new f,i=0;for(let r of t){let n=r.value(),s=0;for(let o of r)s+=1-o.isSatisfied();t:for(let o of r.domain()){if(n===o||(r.assign(o),t.isSatisfied()!==1))continue;let a=s;for(let u of r)if(a-=1-u.isSatisfied(),a<i)continue t;a>i?(i=a,e.clear(),e.addVariable(r,o)):i!==0&&e.addVariable(r,o)}r.assign(n)}if(e.size()>0){let r=this.#t?e.random():e.at(0);return r.apply(),this._debugOutput("	"+r),!0}return!1}#a(t,e){let i=[],r=t;for(;;){r=r.parent(),i.length=0,r.getDescendants(i),r.clear();for(let n of e)this.#i.delete(n),this.#e.delete(n);if(e.delete(r)||(this.#i.add(r),r.parent()!==null&&!this.#o(r.parent().getObject())))break}}#u(t){this._debugOutput("spread"),this.#e.add(t);for(let e of this.#n(t.getObject())){let i=this.#r[e.index()];!this.#e.has(i)&&!this.#i.has(i)&&(i.clear(),t.add(i),this.#i.add(i))}}#l(t){this._debugOutput("srs");let e=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,i=0;this.#e.clear(),this.#i.clear();for(let n of t)this.#i.add(n);let r=this._pro;for(;t.size&&this.#i.size;){if((this._targetDeg??1)<=r.satisfiedConstraintRate())return this._debugOutput("stop: current degree is above the target"),!0;if(this._iterLimit&&this._iterLimit<i++)return this._debugOutput("stop: number of iterations has reached the limit"),!1;if(e<Date.now())return this._debugOutput("stop: time limit has been reached"),!1;let n=this.#i.values().next().value;this.#i.delete(n),this.#o(n.getObject())?t.delete(n)||(n.parent()!==null&&this.#o(n.parent().getObject())?this.#a(n,t):this.#u(n)):this.#u(n)}return!1}exec(){let t=this._pro.violatingConstraints(),e=new Set;for(let i of t){let r=this.#r[i.index()];e.add(r)}return this.#l(e)?!0:e.size===0}},tt=class{#t=[];#e;#i;constructor(t){this.#e=null,this.#i=t}add(t){t.#e=this,this.#t.push(t)}clear(){for(let t of this.#t)t.#e=null;this.#t.length=0}getDescendants(t){t.push(this);for(let e of this.#t)e.getDescendants(t)}getObject(){return this.#i}parent(){return this.#e}};var H=class m extends d{static CONTINUE=0;static TERMINATE=1;#t;#e=new f;#i=[];#r=0;#s=0;#n=0;#o=!1;#a=0;#u;#l;#m;#h=!1;constructor(t,e=null){super(t),this.#t=[...this._pro.variables()],this.#u=new Array(this._pro.variableSize()),this.#f(),this.#m=new Array(this._pro.constraintSize());let i=[];for(let r of this._pro.constraints())r.size()===1&&i.push(r);this.#l=[...i],e&&(this.#r=e)}name(){return"Forward Checking for Fuzzy CSPs"}setUsingMinimumRemainingValuesHeuristics(t){this.#o=t}setIncrementStepOfWorstSatisfactionDegree(t){this.#a=t}setIntensivePruning(t){this.#h=t}setTargetRate(t=null){if(this._targetDeg=t,this._targetDeg===null)this.#r=0;else{let e=Number.MIN_VALUE;for(this.#r=this._targetDeg-e;this.#r>=this._targetDeg;)e*=10,this.#r=this._targetDeg-e}}#f(){this.#i=[];for(let t=0;t<this.#t.length;++t){this.#i.push(new Array(this.#t.length));for(let e=0;e<this.#t.length;++e)e<t&&(this.#i[t][e]=this._pro.constraintsBetween(this.#t[e],this.#t[t]))}}#c(t,e){return t<e?this.#i[e][t]:this.#i[t][e]}#b(){for(let t of this.#l){let e=t.at(0),i=e.value(),r=e.domain(),n=e.solverObject;for(let s=0,o=r.size();s<o;++s)e.assign(r.at(s)),t.satisfactionDegree()<=this.#r&&n.hide(s,-1);if(e.assign(i),n.isEmpty())return!1}return!0}#g(t,e,i){let r=e.domain(),n=e.solverObject;for(let s=0,o=r.size();s<o;++s)n.isValueHidden(s)||(e.assign(r.at(s)),i.satisfactionDegree()<=this.#r&&n.hide(s,t));return e.clear(),!n.isEmpty()}#V(t,e,i){let r=e.domain(),n=e.solverObject,s=null;for(let u of i)if(u.isEmpty()&&u!==e){s=u;break}let o=s.domain(),a=s.solverObject;t:for(let u=0,l=r.size();u<l;++u)if(!n.isValueHidden(u)){e.assign(r.at(u));for(let h=0,b=o.size();h<b;++h){if(a.isValueHidden(h))continue;if(s.assign(o.at(h)),i.satisfactionDegree()>this.#r)continue t}n.hide(u,t)}return s.clear(),e.clear(),!n.isEmpty()}#v(t,e,i){let r=e.domain(),n=e.solverObject,s=null,o=null;for(let b of i)if(b.isEmpty()&&b!==e)if(s===null)s=b;else{o=b;break}let a=s.domain(),u=o.domain(),l=s.solverObject,h=o.solverObject;t:for(let b=0,p=r.size();b<p;++b)if(!n.isValueHidden(b)){e.assign(r.at(b));for(let g=0,D=a.size();g<D;++g)if(!l.isValueHidden(g)){s.assign(a.at(g));for(let V=0,ft=u.size();V<ft;++V){if(h.isValueHidden(V))continue;if(o.assign(u.at(V)),i.satisfactionDegree()>this.#r)continue t}}n.hide(b,t)}return o.clear(),s.clear(),e.clear(),!n.isEmpty()}#D(t,e,i,r){let n=e.domain(),s=e.solverObject,o=new Array(r-1),a=0;for(let l of i)l.isEmpty()&&l!==e&&(o[a++]=l);let u=new Array(o.length);t:for(let l=0,h=n.size();l<h;++l)if(!s.isValueHidden(l)){e.assign(n.at(l)),u.fill(0);e:for(;;){let b=!1;for(let p=0;p<o.length;++p){let g=o[p].domain();if(o[p].solverObject.isValueHidden(u[p])){b=!0;break}o[p].assign(g.at(u[p]))}if(!b&&i.satisfactionDegree()>this.#r)continue t;for(let p=0;p<o.length&&(u[p]+=1,!(u[p]<o[p].domain().size()));++p)if(u[p]=0,p===o.length-1)break e}s.hide(l,t)}for(let l of o)l.clear();return e.clear(),!s.isEmpty()}#_(t,e){for(let i of this.#t){if(!i.isEmpty())continue;let r=this.#c(e,i.index());for(let n of r){let s=n.emptyVariableSize();if(s===1){if(!this.#g(t,i,n))return!1}else if(this.#h){if(s===2){if(!this.#V(t,i,n))return!1}else if(s===3){if(!this.#v(t,i,n))return!1}else if(s>3&&!this.#D(t,i,n,s))return!1}}}return!0}#C(t){this.#m.fill(!1);for(let e=0;e<this.#t.length;++e){let i=this.#t[e];if(i===t||i.isEmpty())continue;let r=this.#c(t.index(),e);for(let n of r){if(this.#m[n.index()])continue;let s=n.satisfactionDegree();if(s!==c.UNDEFINED&&s<=this.#r)return!1;this.#m[n.index()]=!0}}return!0}#S(){for(let t=0;t<this.#u.length;++t){let e=this.#u[t].index();for(let i=t+1;i<this.#u.length;++i){let r=this.#u[i],n=this.#c(e,r.index());for(let s of n){let o=r.value(),a=r.domain(),u=r.solverObject;for(let l=0,h=a.size();l<h;++l)u.isValueHidden(l)||(r.assign(a.at(l)),s.satisfactionDegree()<=this.#r&&u.hide(l,t));r.assign(o)}}}}#d(){let t=0,e=Number.MAX_VALUE;for(let i=0;i<this.#t.length;++i){let r=this.#t[i];if(!r.isEmpty())continue;let s=r.domain().size()-r.solverObject.hiddenSize();s<e&&(e=s,t=i)}return t}#p(t){let e=m.CONTINUE,i=this.#o?this.#d():t,r=this.#t[i],n=r.domain(),s=r.solverObject;this.#u[t]=r;for(let o=0,a=n.size();o<a;++o){if(s.isValueHidden(o))continue;if(this._iterLimit&&this._iterLimit<this.#s++||this.#n<Date.now()){e=m.TERMINATE;break}r.assign(n.at(o));for(let l of this.#t)l.solverObject.reveal(t);if(!this.#C(r)||!this.#_(t,i))continue;let u=t+1;if(e=u===this.#t.length-1?this.#w(u):this.#p(u),e===m.TERMINATE)break}if(e===m.CONTINUE)for(let o of this.#t)o.solverObject.reveal(t);return r.clear(),e}#w(t){let e=m.CONTINUE,i=this.#t[this.#o?this.#d():t],r=i.domain(),n=i.solverObject;this.#u[t]=i;for(let s=0,o=r.size();s<o;++s){if(n.isValueHidden(s))continue;if(this._iterLimit&&this._iterLimit<this.#s++||this.#n<Date.now()){e=m.TERMINATE;break}i.assign(r.at(s));let a=this._pro.worstSatisfactionDegree();if(a>this.#r){if(this.#r=a,this.#e.setProblem(this._pro),e=m.TERMINATE,this._targetDeg!==null&&this._targetDeg<=this.#r)break;this.#b(),this.#S()}}return i.clear(),e}exec(){this.#n=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#s=0;for(let e of this.#t)e.solverObject=new v(e.domain().size());if(this._pro.clearAllVariables(),!this.#b())return!1;let t=!1;for(;;){if(this.#p(0)===m.TERMINATE){if(this._iterLimit&&this._iterLimit<this.#s++){this._debugOutput("stop: number of iterations has reached the limit");break}if(this.#n<Date.now()){this._debugOutput("stop: time limit has been reached");break}}if(this.#e.isEmpty())break;if(this._debugOutput(`	found a solution: ${this.#r}`),this.foundSolution(this.#e,this.#r)){t=!0;break}if(this._targetDeg===null)t=!0,this.#r+=this.#a;else if(this._targetDeg<=this.#r){this._debugOutput("stop: current degree is above the target"),t=!0;break}for(let i of this.#t)i.solverObject.revealAll()}this.#e.apply();for(let e of this.#t)e.solverObject=null;return t}};var B=class m extends d{static CONTINUE=0;static TERMINATE=1;#t;#e=new f;#i=[];#r=0;#s=0;#n=0;#o=!1;#a=0;constructor(t,e=null){super(t),this.#t=[...this._pro.variables()],this.#u(),this.#r=Math.max(0,t.worstSatisfactionDegree()),e&&(this.#r=e)}name(){return"Forward Checking for Fuzzy CSPs of Binary Constraints"}setUsingMinimumRemainingValuesHeuristics(t){this.#o=t}setIncrementStepOfWorstSatisfactionDegree(t){this.#a=t}setTargetRate(t=null){if(this._targetDeg=t,this._targetDeg===null)this.#r=0;else{let e=Number.MIN_VALUE;for(this.#r=this._targetDeg-e;this.#r>=this._targetDeg;)e*=10,this.#r=this._targetDeg-e}}#u(){this.#i=[];for(let t=0;t<this.#t.length;++t){this.#i.push(new Array(this.#t.length));for(let e=0;e<this.#t.length;++e)e<t&&(this.#i[t][e]=this._pro.constraintsBetween(this.#t[e],this.#t[t]))}}#l(t,e){return t<e?this.#i[e][t]:this.#i[t][e]}#m(t,e,i){let r=e.domain(),n=e.solverObject;for(let s=0,o=r.size();s<o;++s)n.isValueHidden(s)||(e.assign(r.at(s)),i.satisfactionDegree()<=this.#r&&n.hide(s,t));return e.clear(),!n.isEmpty()}#h(t,e){for(let i of this.#t){if(!i.isEmpty())continue;let r=this.#l(e,i.index());for(let n of r)if(n.size()===2&&!this.#m(t,i,n))return!1}return!0}#f(){let t=0,e=Number.MAX_VALUE;for(let i=0;i<this.#t.length;++i){let r=this.#t[i];if(!r.isEmpty())continue;let s=r.domain().size()-r.solverObject.hiddenSize();s<e&&(e=s,t=i)}return t}#c(t){let e=m.CONTINUE,i=this.#o?this.#f():t,r=this.#t[i],n=r.domain(),s=r.solverObject;for(let o=0,a=n.size();o<a;++o){if(s.isValueHidden(o))continue;if(this._iterLimit&&this._iterLimit<this.#s++||this.#n<Date.now()){e=m.TERMINATE;break}r.assign(n.at(o));for(let l of this.#t)l.solverObject.reveal(t);if(!this.#h(t,i))continue;let u=t+1;if(e=u===this.#t.length-1?this.#b(u):this.#c(u),e===m.TERMINATE)break}if(e===m.CONTINUE)for(let o of this.#t)o.solverObject.reveal(t);return r.clear(),e}#b(t){let e=m.CONTINUE,i=this.#t[this.#o?this.#f():t],r=i.domain(),n=i.solverObject;for(let s=0,o=r.size();s<o;++s){if(n.isValueHidden(s))continue;if(this._iterLimit&&this._iterLimit<this.#s++||this.#n<Date.now()){e=m.TERMINATE;break}i.assign(r.at(s));let a=this._pro.worstSatisfactionDegree();if(a>this.#r&&(this.#r=a,this.#e.setProblem(this._pro),e=m.TERMINATE,this._targetDeg!==null&&this._targetDeg<=this.#r))break}return i.clear(),e}exec(){this.#n=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#s=0;for(let i of this.#t)i.solverObject=new v(i.domain().size());this._pro.clearAllVariables();let t=new f,e=!1;for(;;){if(this.#c(0)===m.TERMINATE){if(this._iterLimit&&this._iterLimit<this.#s++){this._debugOutput("stop: number of iterations has reached the limit");break}if(this.#n<Date.now()){this._debugOutput("stop: time limit has been reached");break}}if(this.#e.isEmpty())break;if(t.setAssignmentList(this.#e),this.#e.clear(),this._debugOutput(`	found a solution: ${this.#r}`),this.foundSolution(t,this.#r)){e=!0;break}if(this._targetDeg===null){if(e=!0,this.#r+this.#a>1)break;this.#r+=this.#r+this.#a>1?0:this.#a}else if(this._targetDeg<=this.#r){this._debugOutput("stop: current degree is above the target"),e=!0;break}for(let r of this.#t)r.solverObject.revealAll()}t.apply();for(let i of this.#t)i.solverObject=null;return e}};var W=class m extends d{static#t(t,e){let i=new Set(t);return i.add(e),i}static#e(t,e){let i=new Set(t);return i.delete(e),i}#i=0;#r=0;#s=0;#n=0;#o=0;constructor(t){super(t),this.#u()}name(){return"Flexible Local Changes"}#a(t,e){let i=new Map;for(let s of e)if(s.isDefined())for(let o of s)i.has(o)?i.set(o,(i.get(o)??0)+1):i.set(o,1);let r=[...t];r.sort((s,o)=>{let a=0,u=0;return i.has(s)&&(a=i.get(s)??0),i.has(o)&&(u=i.get(o)??0),a<u?1:a>u?-1:0});let n=new Set;for(let s of r){let o=!1;for(let a of e)if(a.isDefined()){o=!0;break}if(!o)break;s.clear(),n.add(s)}return n}#u(){let t=1,e=0;for(let i of this._pro.variables())for(let r of i){let n=r.lowestConsistencyDegree(),s=r.highestConsistencyDegree();n<t&&(t=n),s>e&&(e=s)}this.#r=t,this.#i=e}#l(t,e,i,r,n,s,o){let a=this.#a(e,s),u=m.#t(t,i),l=e.difference(a);return this.#h(u,l,a,r,Math.min(n,r),o)}#m(t,e,i,r,n,s){let o=this.#r;if(i.domain().size()===0)return o;let a=f.fromVariables(e),u=i.domain().at(0),l=f.fromVariables(e);for(let h=0;h<i.domain().size()&&o<n;++h){let b=i.domain().at(h);i.assign(b);let p=Math.min(r,this.#c(t,i,o,s));if(p>Math.max(o,s)){let g=new Set,D=Math.min(Math.min(p,n),this.#b(t,e,i,p,n,g));if(D>o&&(o=D,u=b,a=f.fromVariables(e)),g.size){let V=this.#l(t,e,i,p,n,g,Math.max(s,o));if(this.#o!==-1)return o;V>o&&(o=V,u=b,a=f.fromVariables(e)),l.apply()}}}return a.apply(),i.assign(u),o}#h(t,e,i,r,n,s){if(this._debugOutput(`X1 ${t.size}, X2' ${e.size}, X3' ${i.size}`),this._targetDeg!==null&&this._targetDeg<=this._pro.worstSatisfactionDegree())return this._debugOutput("stop: current degree is above the target"),this.#o=1,n;if(this._iterLimit&&this._iterLimit<this.#s++)return this._debugOutput("stop: number of iterations has reached the limit"),this.#o=0,n;if(this.#n<Date.now())return this._debugOutput("stop: time limit has been reached"),this.#o=0,n;if(i.size===0)return n;let o=i.values().next().value,a=this.#m(t,e,o,r,n,s);return this.#o!==-1?n:a<s?this.#r:(e=m.#t(e,o),i=m.#e(i,o),this.#h(t,e,i,r,a,s))}#f(t,e){let i=new Set;for(let n of t)for(let s of n)i.add(s);let r=1;for(let n of i){let s=n.satisfactionDegree();s!==c.UNDEFINED&&s<r&&(r=s)}for(let n of this._pro.constraints())n.lowestConsistencyDegree()<this.#i&&e.add(n);return r}#c(t,e,i,r){let n=1,s=new Set;for(let o of t){let a=this._pro.constraintsBetween(o,e);for(let u of a)s.add(u)}for(let o of s){let a=o.satisfactionDegree();if(a!==c.UNDEFINED&&(a<n&&(n=a),n<=i||n<=r))return n}return n}#b(t,e,i,r,n,s){let o=1,a=new Set;for(let u of t){let l=this._pro.constraintsBetween(u,i);for(let h of l)a.add(h)}for(let u of e){let l=this._pro.constraintsBetween(u,i);for(let h of l)a.add(h)}for(let u of a){let l=u.satisfactionDegree();l!==c.UNDEFINED&&l<o&&(o=l)}for(let u of a){let l=u.satisfactionDegree();l!==c.UNDEFINED&&(l<r||l<n)&&s.add(u)}return o}exec(){this.#n=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#s=0,this.#o=-1;let t=this._pro.worstSatisfactionDegree();this._pro.emptyVariableSize()===0&&this._pro.clearAllVariables();let e=new Set,i=new Set,r=new Set;for(let b of this._pro.variables())(b.isEmpty()?r:i).add(b);let n=new Set,s=this.#f(i,n),o,a=null;r.size===0?(o=s,a=f.fromVariables(i)):o=this.#r;let u=this.#a(i,n).union(r),l=i.difference(u),h=this.#h(e,l,u,this.#i,this.#i,o);return h<o&&a!==null&&a.apply(),h=this._pro.worstSatisfactionDegree(),h>t&&h>0&&(this.#o!==0||this._targetDeg===null)}};var G=class m extends d{static#t(t,e){let i=new Set(t);return i.add(e),i}#e=0;#i=0;#r=0;#s=0;#n=0;constructor(t){super(t),this.#a()}name(){return"Flexible Local Changes Ex"}#o(t,e){let i=new Map;for(let s of e)if(s.isDefined())for(let o of s)i.has(o)?i.set(o,(i.get(o)??0)+1):i.set(o,1);let r=[...t];r.sort((s,o)=>{let a=0,u=0;return i.has(s)&&(a=i.get(s)??0),i.has(o)&&(u=i.get(o)??0),a<u?1:a>u?-1:0});let n=new Set;for(let s of r){let o=!1;for(let a of e)if(a.isDefined()){o=!0;break}if(!o)break;s.clear(),n.add(s)}return n}#a(){let t=1,e=0;for(let i of this._pro.variables())for(let r of i){let n=r.lowestConsistencyDegree(),s=r.highestConsistencyDegree();n<t&&(t=n),s>e&&(e=s)}this.#i=t,this.#e=e}#u(t,e,i,r,n,s,o){let a=this.#o(e,s),u=m.#t(t,i),l=e.difference(a);return this.#m(u,l,a,r,Math.min(n,r),o)}#l(t,e,i,r,n,s){let o=this.#i;if(i.domain().size()===0)return o;let a=f.fromVariables(e),u=i.domain().at(0),l=f.fromVariables(e);for(let h=0;h<i.domain().size()&&o<n;++h){let b=i.domain().at(h);i.assign(b);let p=Math.min(r,this.#f(t,i,o,s));if(p>Math.max(o,s)){let g=new Set,D=Math.min(Math.min(p,n),this.#c(t,e,i,p,n,g));if(D>o&&(o=D,u=b,a=f.fromVariables(e)),g.size){let V=this.#u(t,e,i,p,n,g,Math.max(s,o));if(this.#n!==-1)return o;V>o&&(o=V,u=b,a=f.fromVariables(e)),l.apply()}}}return a.apply(),i.assign(u),o}#m(t,e,i,r,n,s){for(e=new Set(e),i=new Set(i);;){if(this._debugOutput(`X1 ${t.size}, X2' ${e.size}, X3' ${i.size}`),this._targetDeg!==null&&this._targetDeg<=this._pro.worstSatisfactionDegree())return this._debugOutput("stop: current degree is above the target"),this.#n=1,n;if(this._iterLimit&&this._iterLimit<this.#r++)return this._debugOutput("stop: number of iterations has reached the limit"),this.#n=0,n;if(this.#s<Date.now())return this._debugOutput("stop: time limit has been reached"),this.#n=0,n;if(i.size===0)return n;let o=i.values().next().value,a=this.#l(t,e,o,r,n,s);if(this.#n!==-1)return n;if(a<s)return this.#i;e.add(o),i.delete(o),n=a}}#h(t,e){let i=new Set;for(let n of t)for(let s of n)i.add(s);let r=1;for(let n of i){let s=n.satisfactionDegree();s!==c.UNDEFINED&&s<r&&(r=s)}for(let n of this._pro.constraints())n.lowestConsistencyDegree()<this.#e&&e.add(n);return r}#f(t,e,i,r){let n=1,s=new Set;for(let o of t){let a=this._pro.constraintsBetween(o,e);for(let u of a)s.add(u)}for(let o of s){let a=o.satisfactionDegree();if(a!==c.UNDEFINED&&(a<n&&(n=a),n<=i||n<=r))return n}return n}#c(t,e,i,r,n,s){let o=1,a=new Set;for(let u of t){let l=this._pro.constraintsBetween(u,i);for(let h of l)a.add(h)}for(let u of e){let l=this._pro.constraintsBetween(u,i);for(let h of l)a.add(h)}for(let u of a){let l=u.satisfactionDegree();l!==c.UNDEFINED&&l<o&&(o=l)}for(let u of a){let l=u.satisfactionDegree();l!==c.UNDEFINED&&(l<r||l<n)&&s.add(u)}return o}exec(){this.#s=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#r=0,this.#n=-1;let t=this._pro.worstSatisfactionDegree();this._pro.emptyVariableSize()===0&&this._pro.clearAllVariables();let e=new Set,i=new Set,r=new Set;for(let b of this._pro.variables())(b.isEmpty()?r:i).add(b);let n=new Set,s=this.#h(i,n),o,a=null;r.size===0?(o=s,a=f.fromVariables(i)):o=this.#i;let u=this.#o(i,n).union(r),l=i.difference(u),h=this.#m(e,l,u,this.#e,this.#e,o);return h<o&&a!==null&&a.apply(),h=this._pro.worstSatisfactionDegree(),h>t&&h>0&&(this.#n!==0||this._targetDeg===null)}};var Y=class extends d{#t=!0;#e;#i=0;constructor(t){super(t),this.#e=new Array(this._pro.constraintSize()),this.#e.fill(1)}name(){return"Fuzzy Breakout"}setRandomness(t){this.#t=t}#r(t,e){let i=0;for(let r of t){let n=r.value(),s=0;for(let o of r)s+=(1-o.satisfactionDegree())*this.#e[o.index()];t:for(let o of r.domain()){if(n===o)continue;r.assign(o);let a=s;for(let u of r)if(a-=(1-u.satisfactionDegree())*this.#e[u.index()],a<i)continue t;a>i?(i=a,e.clear(),e.addVariable(r,o)):i!==0&&e.addVariable(r,o)}r.assign(n)}}#s(t){let e=new Set;for(let i of t)for(let r of i)e.add(r);return Array.from(e)}exec(){let t=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,e=0;for(let s of this._pro.variables())s.isEmpty()&&s.assign(s.domain().at(0));let i=this._pro.worstSatisfactionDegree(),r=new f,n=new f;for(;;){let[s,o]=this._pro.constraintsWithWorstSatisfactionDegree();if(this._targetDeg!==null&&this._targetDeg<=o)return this._debugOutput("stop: current degree is above the target"),!0;if(this._iterLimit&&this._iterLimit<e++){this._debugOutput("stop: number of iterations has reached the limit");break}if(t<Date.now()){this._debugOutput("stop: time limit has been reached");break}if(this._debugOutput("worst satisfaction degree: "+o),this.#i<o&&(n.setProblem(this._pro),this.#i=o,this.foundSolution(n,this.#i)))return!0;if(this.#r(this.#s(s),r),0<r.size()){let a=this.#t?r.random():r.at(0);a.apply(),r.clear(),this._debugOutput("	"+a)}else{for(let a of s)this.#e[a.index()]+=1;this._debugOutput("breakout")}}return this._targetDeg===null&&i<this._pro.worstSatisfactionDegree()}};var q=class m extends d{static nextInt(t){return Math.floor(Math.random()*Math.floor(t))}#t=[];#e=[];#i;constructor(t,e=1){super(t),this.#i=e}name(){return"Fuzzy GENET"}#r(t){this._debugOutput("network creation start");let e=[];for(let i of this._pro.variables()){if(i.domain().size()===0)return!1;this.#t.push(new et(i))}for(let i of this._pro.constraints())if(i.size()===1){let r=i.at(0),n=this.#t[r.index()];for(let s=0;s<n.size();++s){let o=r.value();r.assign(n.get(s)._value),i.satisfactionDegree()<=t&&e.push(new J(i,n.get(s))),r.assign(o)}}else{let r=i.at(0),n=i.at(1),s=this.#t[r.index()],o=this.#t[n.index()];for(let a=0;a<s.size();++a){let u=r.value();r.assign(s.get(a)._value);for(let l=0;l<o.size();++l){let h=n.value();n.assign(o.get(l)._value),i.satisfactionDegree()<=t&&e.push(new J(i,s.get(a),o.get(l))),n.assign(h)}r.assign(u)}}for(let i of this.#t)for(let r of i._neurons)r.lockConnections();return this.#e=e,this._debugOutput("network creation complete"),!0}#s(t){for(let e=t.length;e>1;--e){let i=m.nextInt(e),r=t[e-1];t[e-1]=t[i],t[i]=r}return t}exec(){if(!this.#r(this.#i))throw new Error;let t=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,e=0,i=new f,r=[];for(let o=0;o<this.#t.length;++o)r.push(o);let n=this._pro.worstSatisfactionDegree(),s=!1;for(;;){if(this._iterLimit&&this._iterLimit<e++){this._debugOutput("stop: number of iterations has reached the limit");break}if(t<Date.now()){this._debugOutput("stop: time limit has been reached");break}let o=!1;for(let a of this.#s(r))this.#t[a].setActivityMaximumInput()&&(o=!0);if(o){for(let u of this.#t)u.applyToVariable();let a=this._pro.worstSatisfactionDegree();if(n<a){if(n=a,this._debugOutput(`worst satisfaction degree: ${a}`),i.setProblem(this._pro),this.foundSolution(i,a)){s=!0;break}if(this._targetDeg===null)s=!0;else if(this._targetDeg<=n){this._debugOutput("stop: current degree is above the target"),s=!0;break}}}else{for(let a of this.#e)a.refreshWeight();continue}}return i.apply(),s}},et=class m{static nextInt(t){return Math.floor(Math.random()*Math.floor(t))}#t;#e=0;#i=[];_neurons=[];constructor(t){this.#t=t;for(let e of t.domain())this._neurons.push(new it(e));this.#r(m.nextInt(this._neurons.length))}#r(t){for(let e of this._neurons)e._isActive=!1;this._neurons[t]._isActive=!0,this.#e=t}applyToVariable(){this.#t.assign(this._neurons[this.#e]._value)}get(t){return this._neurons[t]}neurons(){return this._neurons}setActivityMaximumInput(){this.#i.length=0;let t=Number.NEGATIVE_INFINITY,e=!1;for(let i=0;i<this._neurons.length;++i){let r=this._neurons[i].getInput();t<=r&&(t<r&&(t=r,this.#i.length=0,e=!1),this.#i.push(i),this.#e===i&&(e=!0))}return e||this.#i.length===0?!1:(this.#r(this.#i[m.nextInt(this.#i.length)]),!0)}size(){return this._neurons.length}},J=class{#t;#e;#i;_weight;constructor(t,e,i=null){this._weight=t.satisfactionDegree()-1,this.#t=t,this.#e=e,this.#e.addConnection(this),this.#i=i,this.#i!==null&&this.#i.addConnection(this)}getNeuron(t){return t===this.#e?this.#i:t===this.#i?this.#e:null}refreshWeight(){!this.#e._isActive||this.#i!==null&&!this.#i._isActive||(this.#t.size()===1?this._weight+=this.#t.fuzzyRelation().satisfactionDegree(this.#e._value)-1:this._weight+=this.#t.fuzzyRelation().satisfactionDegree(this.#e._value,this.#i._value)-1)}},it=class{#t=[];#e=[];_value;_isActive=!1;constructor(t){this._value=t}addConnection(t){this.#t.push(t)}lockConnections(){this.#e=[...this.#t],this.#t=null}getInput(){let t=0;for(let e of this.#e){let i=e.getNeuron(this);t+=e._weight*(i===null||i._isActive?1:0)}return t}};var x=class m extends d{static REPAIR_THRESHOLD=0;#t=new Set;#e=new Set;#i=[];#r=[];#s=new Set;#n=0;#o=0;#a=!0;constructor(t){super(t);for(let e of this._pro.constraints())this.#i.push(new rt(e)),this.#r.push(null)}name(){return"SRS 3"}#u(t){let e=t.index();return this.#r[e]===null&&(this.#r[e]=t.neighbors()),this.#r[e]}#l(t){this._debugOutput("repair");let e=new f,i=t.satisfactionDegree(),r=this._pro.worstSatisfactionDegree(),n=t.satisfactionDegree();for(let s of t){let o=s.value();t:for(let a of s.domain()){if(o===a)continue;s.assign(a);let u=t.satisfactionDegree();if(!(i>u||n-u>m.REPAIR_THRESHOLD)){for(let l of s){if(l===t)continue;let h=l.satisfactionDegree();if(h!==c.UNDEFINED&&h<r)continue t}u>n&&(n=u,e.clear()),e.addVariable(s,a)}}s.assign(o)}if(e.size()>0){let s=this.#a?e.random():e.at(0);return s.apply(),this._debugOutput("	"+s),!0}return!1}#m(t){this._debugOutput("shrink");let e=!1;for(;;){if(t=t.parent(),this.#s.delete(t)){e=!0;break}if(!this.#l(t.parent().getObject()))break}let i=[];t.getDescendants(i);for(let r of i)r.clear(),this.#e.delete(r),this.#t.delete(r);e||this.#e.add(t)}#h(t){this._debugOutput("spread"),this.#t.add(t);for(let e of this.#u(t.getObject())){let i=this.#i[e.index()];!this.#t.has(i)&&!this.#e.has(i)&&(t.add(i),this.#e.add(i))}}#f(){this._debugOutput("srs");let[t]=this._pro.constraintsWithWorstSatisfactionDegree();for(let e of t){let i=this.#i[e.index()];i.setParent(null),this.#s.add(i)}this.#t.clear(),this.#e.clear();for(let e of this.#s)this.#e.add(e);for(;this.#s.size&&this.#e.size;){if(this._iterLimit&&this._iterLimit<this.#n++)return this._debugOutput("stop: number of iterations has reached the limit"),!1;if(this.#o<Date.now())return this._debugOutput("stop: time limit has been reached"),!1;let e=this.#e.values().next().value;if(this.#e.delete(e),this.#l(e.getObject())){if(this.#s.delete(e))continue;if(this.#l(e.parent().getObject())){this.#m(e);continue}}this.#h(e)}return!0}exec(){if(this.#o=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#n=0,this._targetDeg&&this._targetDeg<=this._pro.worstSatisfactionDegree())return!0;let t=new f,e=!1;for(;!(!this.#f()||this.#s.size);){let r=this._pro.worstSatisfactionDegree();if(this._debugOutput(`	found a solution: ${r}	${this._targetDeg}`),t.setProblem(this._pro),this.foundSolution(t,r)){e=!0;break}if(this._targetDeg===null)e=!0;else if(this._targetDeg<=r){this._debugOutput("stop: current degree is above the target"),e=!0;break}}return e}setRandomness(t){this.#a=t}},rt=class{#t=[];#e;#i;constructor(t){this.#e=null,this.#i=t}add(t){t.#e=this,this.#t.push(t)}clear(){for(let t of this.#t)t.#e=null;this.#t.length=0}getDescendants(t){t.push(this);for(let e of this.#t)e.getDescendants(t)}getObject(){return this.#i}parent(){return this.#e}setParent(t){this.#e=t}};var K=class{static apply(t,e){console.log("start post-stabilization");let i,r=0;do{console.log("post-stabilization: count "+r++),i=!1;let n=t.worstSatisfactionDegree(),s=t.variables();for(let o=0;o<s.length;++o){let a=s[o],u=a.value(),l=e.at(o);u!==l.value()&&(l.apply(),t.worstSatisfactionDegree()>=n?i=!0:a.assign(u))}}while(i);return console.log("finish post-stabilization"),!0}};var Q=class extends x{constructor(t){super(t)}name(){return"SRS 3 + PF"}exec(){let t=0,e=0;this._debug&&(t=this._pro.worstSatisfactionDegree(),e=this._pro.emptyVariableSize());let i=new f;i.setProblem(this._pro);let r=super.exec();return r&&K.apply(this._pro,i),this._debugOutput(`result: ${r?"success":"failure"}`),this._debugOutput(`satisfaction degree: ${t} -> ${this._pro.worstSatisfactionDegree()}`),this._debugOutput(`unassigned size: ${e} -> ${this._pro.emptyVariableSize()}`),r}};var at=class m{static crispSolverNames(){return["Forward Checking","Max Forward Checking","Local Changes","Local Changes Ex","Breakout","GENET","Crisp SRS 3"]}static fuzzySolverNames(){return["Fuzzy Forward Checking","Fuzzy Forward Checking Bc","Flexible Local Changes","Flexible Local Changes Ex","Fuzzy Breakout","Fuzzy GENET","SRS 3","SRS 3 PF"]}static async createSolver(t,e){let i=await m.createCrispSolver(t,e);if(i)return i;let r=await m.createFuzzySolver(t,e);return r||null}static async createCrispSolver(t,e){switch(t.replaceAll(" ","")){case"ForwardChecking":case"forward-checking":return new T(e);case"MaxForwardChecking":case"max-forward-checking":return new R(e);case"LocalChanges":case"local-changes":return new I(e);case"LocalChangesEx":case"local-changes-ex":return new F(e);case"Breakout":case"breakout":return new M(e);case"GENET":case"genet":return new j(e);case"CrispSRS3":case"crisp-srs3":return new $(e)}return null}static async createFuzzySolver(t,e){switch(t.replaceAll(" ","")){case"FuzzyForwardChecking":case"fuzzy-forward-checking":return new H(e);case"FuzzyForwardCheckingBc":case"fuzzy-forward-checking-bc":return new B(e);case"FlexibleLocalChanges":case"flexible-local-changes":return new W(e);case"FlexibleLocalChangesEx":case"flexible-local-changes-ex":return new G(e);case"FuzzyBreakout":case"fuzzy-breakout":return new Y(e);case"FuzzyGENET":case"fuzzy-genet":return new q(e);case"SRS3":case"srs3":return new x(e);case"SRS3PF":case"SRS3_PF":case"srs3-pf":return new Q(e)}return null}};var ut=class m{static#t(t,e){for(let i of e.domain())if(e.assign(i),t.isSatisfied()===1)return!0;return!1}static#e(t,e,i){let r=e.value(),n=i.value(),s=e.domain(),o=[],a=t.constraintsBetween(e,i);t:for(let u of s){e.assign(u);for(let l of a)if(l.size()===2&&!m.#t(l,i))continue t;o.push(u)}if(e.assign(r),i.assign(n),o.length!==s.size()){let u=t.createDomain({values:o});return e.domain(u),console.log(s.size()+" -> "+u.size()),!0}return!1}static apply(t){let e=[];for(let i of t.constraints())i.size()===2&&e.push(i);for(;e.length;){let i=e.pop(),r=i.at(0),n=i.at(1);if(m.#e(t,r,n))for(let s of t.constraints())s.size()===2&&s.at(1)===r&&s.at(0)!==n&&e.unshift(s)}}};var lt=class{static applyToProblem(t,e){for(let i of t.variables()){let r=i.domain(),n=i.value(),s=[];for(let o of i)if(o.size()===1){for(let a of r)i.assign(a),o.satisfactionDegree()>=e&&s.push(a);t.removeConstraint(o)}if(i.assign(n),s.length===0)return!1;i.domain(t.createDomain({values:s}))}return!0}static applyToCrispProblem(t){for(let e of t.variables()){let i=e.domain(),r=e.value(),n=[];for(let s of e)if(s.size()===1){for(let o of i)e.assign(o),s.isSatisfied()===1&&n.push(o);t.removeConstraint(s)}if(e.assign(r),n.length===0)return!1;e.domain(t.createDomain({values:n}))}return!0}};var mt=class m{static#t(t,e,i,r,n){let s=[];for(let o of e)for(let a of o)i[a.index()]===Number.MAX_VALUE&&(s.push(a),i[a.index()]=r+1);for(let o of s)n.add(o);for(let o of s)m.#t(t,o,i,r+1,n)}static averagePathLength(t,e){let i=new Array(t.variableSize());i.fill(Number.MAX_VALUE);let r=new Set;r.add(e),i[e.index()]=0,m.#t(t,e,i,0,r);let n=0,s=0;for(let o=0;o<i.length;++o)i[o]!==Number.MAX_VALUE&&o!==e.index()&&(++n,s+=i[o]);return n===0?0:s/n}static averagePathLengths(t){let e=new Array(t.variableSize());for(let i of t.variables())e[i.index()]=m.averagePathLength(t,i);return e}static domains(t){let e=[];for(let i of t.variables())e.push(i.domain());return e}static possibleSatisfactionDegreesOfUnaryConstraints(t,e){for(let i of t.constraints()){if(i.size()!==1)continue;let r=i.at(0),n=r.value();for(let s of r.domain())r.assign(s),e.push(i.satisfactionDegree());r.assign(n)}return e}static setDomains(t,e){for(let i=0;i<e.length;++i)t.variableAt(i).domain(e[i])}static toViewAsCrispProblem(t,e){let i=new st;for(let r of t.variables())i.createVariable({variable:r});for(let r of t.constraints()){let n=[];for(let o of r)n.push(i.variableAt(o.index()));let s;r.isFuzzy()?s=new nt(r.fuzzyRelation(),e):s=r.crispRelation(),i.createConstraint({relation:s,variables:n})}return i}},st=class extends P{createVariable(t){let e=new k(t.variable);return this.addVariable(e),e}},nt=class{#t;#e;constructor(t,e){this.#e=t,this.#t=e}isSatisfied(...t){return this.#e.satisfactionDegree(...t)>=this.#t?1:0}};var ht=class{#t;#e;#i=[];#r=[];#s=0;constructor(t=30,e=3){this.#t=t,this.#e=e,this.#a()}#n(t,e){this.#i[this.#s]=t,this.#r[this.#s]=e,--this.#s===-1&&(this.#s=this.#i.length-1)}#o(){let t=new Array(this.#t),e=new Array(this.#t);t:for(let i=1;i<=this.#t;++i){let r=this.#s+1;for(let s=0;s<i;++s)s+r===this.#i.length&&(r-=this.#i.length),t[s]=this.#i[s+r],e[s]=this.#r[s+r];let n=i;for(let s=0;s<this.#e-1;++s){r=this.#s+1;for(let o=0;o<i;++o)if(n+o+r>=this.#i.length&&(r-=this.#i.length),this.#i[n+o+r]!==t[o]||this.#r[n+o+r]!==e[o])continue t;n+=i}return i}return 0}#a(){this.#i=new Array(this.#t*this.#e),this.#r=new Array(this.#t*this.#e),this.#i.fill(-1),this.#r.fill(-1),this.#s=this.#i.length-1}checkLoop(t,e){return this.#n(t,e),this.#o()}clear(){this.#i.fill(-1),this.#r.fill(-1)}iterationCount(){return this.#e}loopLength(){return this.#t}values(){return this.#r.slice()}variableIndices(){return this.#i.slice()}};export{ut as AC3,C as Assignment,f as AssignmentList,M as Breakout,c as Constraint,E as Constraint1,N as Constraint2,A as Constraint3,L as ConstraintN,P as CrispProblem,$ as CrispSRS3,w as Domain,z as DomainArbitrary,v as DomainPruner,y as DomainRanged,S as Element,W as FlexibleLocalChanges,G as FlexibleLocalChangesEx,T as ForwardChecking,Y as FuzzyBreakout,H as FuzzyForwardChecking,B as FuzzyForwardCheckingBc,q as FuzzyGENET,j as GENET,k as ImaginaryVariable,I as LocalChanges,F as LocalChangesEx,ht as LoopDetector,R as MaxForwardChecking,lt as NodeConsistency,ot as ObservableVariable,K as PostStabilization,O as Problem,mt as Problems,x as SRS3,Q as SRS3_PF,d as Solver,at as SolverFactory,_ as Variable};
//# sourceMappingURL=stlics.min.js.map

var w=class{#t=-1;#e="";userObject=null;solverObject=null;setIndex(t){this.#t=t}setName(t){this.#e=t}index(){return this.#t}name(){return this.#e}};var S=class u extends w{static#t=Number.MIN_VALUE;#e;#i;#s=u.#t;#r=[];constructor(t,e){super(),this.#e=t,this.#i=e}connect(t){if(this.has(t))throw new RangeError;this.#r.push(t)}disconnect(t){if(!this.has(t))throw new RangeError;this.#r=this.#r.filter(e=>e!==t)}assign(t){this.#s=t}clear(){this.assign(u.#t)}isEmpty(){return this.value()===u.#t}setDomain(t){this.#i=t,this.clear()}owner(){return this.#e}size(){return this.#r.length}at(t){return this.#r[t]}[Symbol.iterator](){return this.#r[Symbol.iterator]()}domain(){return this.#i}has(t){return this.#r.includes(t)}toString(){return`x${this.index()}${this.name()===""?"":`(${this.name()})`} = ${this.isEmpty()?"<empty>":this.value()}`}value(){return this.#s}neighbors(){let t=[];for(let e of this.#r)for(let i of e)i!==this&&t.push(i);return t}};var y=class{random(){return this.at(Math.floor(Math.random()*this.size()))}};var C=class extends y{#t;#e;constructor(t,e){super(),this.#t=t|0,this.#e=e|0}contains(t){return this.#t<=t&&t<=this.#e}indexOf(t){return this.#t<=t&&t<=this.#e?t-this.#t:-1}size(){return this.#e-this.#t+1}at(t){return this.#t+t}[Symbol.iterator](){let t=this.#t,e=this.#e;return{next(){return t<=e?{value:t++,done:!1}:{value:null,done:!0}}}}};var E=class extends y{#t;constructor(t){super(),this.#t=[...t]}contains(t){return this.#t.includes(t)}indexOf(t){return this.#t.indexOf(t)}size(){return this.#t.length}at(t){return this.#t[t]}[Symbol.iterator](){return this.#t[Symbol.iterator]()}};var m=class u extends w{static UNDEFINED=-1;rel;constructor(t){super(),this.rel=t}crispRelation(){return this.rel}fuzzyRelation(){return this.rel}isFuzzy(){return"satisfactionDegree"in this.rel}toString(){let t=this.satisfactionDegree();return`c${this.index()}${this.name()===""?"":`(${this.name()})`} = ${t===u.UNDEFINED?"UNDEFINED":t}`}};var x=class extends m{#t=[];constructor(t,e){super(t),this.#t=[e]}size(){return 1}at(t){if(t===0)return this.#t[0];throw new RangeError}[Symbol.iterator](){return this.#t[Symbol.iterator]()}has(t){return t===this.#t[0]}indexOf(t){return t===this.#t[0]?0:-1}emptyVariableSize(){return this.#t[0].isEmpty()?1:0}isDefined(){return!this.#t[0].isEmpty()}isSatisfied(){return this.#t[0].isEmpty()?m.UNDEFINED:this.crispRelation().isSatisfied(this.#t[0].value())?1:0}satisfactionDegree(){return this.#t[0].isEmpty()?m.UNDEFINED:this.fuzzyRelation().satisfactionDegree(this.#t[0].value())}neighbors(){let t=[];for(let e of this.#t[0])e!==this&&t.push(e);return t}highestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==m.UNDEFINED)return t;let e=0;for(let i of this.#t[0].domain()){let s=this.fuzzyRelation().satisfactionDegree(i);if(s>e&&(e=s),e===1)break}return e}lowestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==m.UNDEFINED)return t;let e=1;for(let i of this.#t[0].domain()){let s=this.fuzzyRelation().satisfactionDegree(i);if(s<e&&(e=s),e===0)break}return e}};var N=class extends m{#t=[];constructor(t,e,i){super(t),this.#t=[e,i]}size(){return 2}at(t){if(t===0)return this.#t[0];if(t===1)return this.#t[1];throw new RangeError}[Symbol.iterator](){return this.#t[Symbol.iterator]()}has(t){return this.#t[0]===t||this.#t[1]===t}indexOf(t){return t===this.#t[0]?0:t===this.#t[1]?1:-1}emptyVariableSize(){let t=0;return this.#t[0].isEmpty()&&++t,this.#t[1].isEmpty()&&++t,t}isDefined(){return!this.#t[0].isEmpty()&&!this.#t[1].isEmpty()}isSatisfied(){return this.#t[0].isEmpty()||this.#t[1].isEmpty()?m.UNDEFINED:this.crispRelation().isSatisfied(this.#t[0].value(),this.#t[1].value())?1:0}satisfactionDegree(){return this.#t[0].isEmpty()||this.#t[1].isEmpty()?m.UNDEFINED:this.fuzzyRelation().satisfactionDegree(this.#t[0].value(),this.#t[1].value())}neighbors(){let t=[];for(let e of this.#t[0])e!==this&&t.push(e);for(let e of this.#t[1])e!==this&&t.push(e);return t}highestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==m.UNDEFINED)return t;let e=0,i=this.#t[0].value(),s=this.#t[1].value(),o=this.#t[0].domain(),r=this.#t[1].domain();if(this.#t[0].isEmpty()&&!this.#t[1].isEmpty())for(let n of o){let a=this.fuzzyRelation().satisfactionDegree(n,s);if(a>e&&(e=a),e===1)break}else if(!this.#t[0].isEmpty()&&this.#t[1].isEmpty())for(let n of r){let a=this.fuzzyRelation().satisfactionDegree(i,n);if(a>e&&(e=a),e===1)break}else for(let n of o)for(let a of r){let l=this.fuzzyRelation().satisfactionDegree(n,a);if(l>e&&(e=l),e===1)break}return e}lowestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==m.UNDEFINED)return t;let e=1,i=this.#t[0].value(),s=this.#t[1].value(),o=this.#t[0].domain(),r=this.#t[1].domain();if(this.#t[0].isEmpty()&&!this.#t[1].isEmpty())for(let n of o){let a=this.fuzzyRelation().satisfactionDegree(n,s);if(a<e&&(e=a),e===0)break}else if(!this.#t[0].isEmpty()&&this.#t[1].isEmpty())for(let n of r){let a=this.fuzzyRelation().satisfactionDegree(i,n);if(a<e&&(e=a),e===0)break}else for(let n of o)for(let a of r){let l=this.fuzzyRelation().satisfactionDegree(n,a);if(l<e&&(e=l),e===0)break}return e}};var T=class extends m{#t=[];constructor(t,e,i,s){super(t),this.#t=[e,i,s]}size(){return 3}at(t){if(t===0)return this.#t[0];if(t===1)return this.#t[1];if(t===2)return this.#t[2];throw new RangeError}[Symbol.iterator](){return this.#t[Symbol.iterator]()}has(t){return this.#t[0]===t||this.#t[1]===t||this.#t[2]===t}indexOf(t){return t===this.#t[0]?0:t===this.#t[1]?1:t===this.#t[2]?2:-1}emptyVariableSize(){let t=0;return this.#t[0].isEmpty()&&++t,this.#t[1].isEmpty()&&++t,this.#t[2].isEmpty()&&++t,t}isDefined(){return!this.#t[0].isEmpty()&&!this.#t[1].isEmpty()&&!this.#t[2].isEmpty()}isSatisfied(){return this.#t[0].isEmpty()||this.#t[1].isEmpty()||this.#t[2].isEmpty()?-1:this.crispRelation().isSatisfied(this.#t[0].value(),this.#t[1].value(),this.#t[2].value())?1:0}satisfactionDegree(){return this.#t[0].isEmpty()||this.#t[1].isEmpty()||this.#t[2].isEmpty()?m.UNDEFINED:this.fuzzyRelation().satisfactionDegree(this.#t[0].value(),this.#t[1].value(),this.#t[2].value())}neighbors(){let t=[];for(let e of this.#t[0])e!==this&&t.push(e);for(let e of this.#t[1])e!==this&&t.push(e);for(let e of this.#t[2])e!==this&&t.push(e);return t}highestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==m.UNDEFINED)return t;let e=1,i=this.#t[0].value(),s=this.#t[1].value(),o=this.#t[2].value(),r=this.#t[0].domain(),n=this.#t[1].domain(),a=this.#t[2].domain();if(this.#t[0].isEmpty()&&!this.#t[1].isEmpty()&&!this.#t[2].isEmpty())for(let l of r){let h=this.fuzzyRelation().satisfactionDegree(l,s,o);if(h>e&&(e=h),e===1)break}else if(!this.#t[0].isEmpty()&&this.#t[1].isEmpty()&&!this.#t[2].isEmpty())for(let l of n){let h=this.fuzzyRelation().satisfactionDegree(i,l,o);if(h>e&&(e=h),e===1)break}else if(!this.#t[0].isEmpty()&&!this.#t[1].isEmpty()&&this.#t[2].isEmpty())for(let l of a){let h=this.fuzzyRelation().satisfactionDegree(i,s,l);if(h>e&&(e=h),e===1)break}else if(this.#t[0].isEmpty()&&this.#t[1].isEmpty()&&!this.#t[2].isEmpty())for(let l of r)for(let h of n){let c=this.fuzzyRelation().satisfactionDegree(l,h,o);if(c>e&&(e=c),e===1)break}else if(this.#t[0].isEmpty()&&!this.#t[1].isEmpty()&&this.#t[2].isEmpty())for(let l of r)for(let h of a){let c=this.fuzzyRelation().satisfactionDegree(l,s,h);if(c>e&&(e=c),e===1)break}else if(!this.#t[0].isEmpty()&&this.#t[1].isEmpty()&&this.#t[2].isEmpty())for(let l of n)for(let h of a){let c=this.fuzzyRelation().satisfactionDegree(i,l,h);if(c>e&&(e=c),e===1)break}else for(let l of r)for(let h of n)for(let c of a){let b=this.fuzzyRelation().satisfactionDegree(l,h,c);if(b>e&&(e=b),e===1)break}return e}lowestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==m.UNDEFINED)return t;let e=1,i=this.#t[0].value(),s=this.#t[1].value(),o=this.#t[2].value(),r=this.#t[0].domain(),n=this.#t[1].domain(),a=this.#t[2].domain();if(this.#t[0].isEmpty()&&!this.#t[1].isEmpty()&&!this.#t[2].isEmpty())for(let l of r){let h=this.fuzzyRelation().satisfactionDegree(l,s,o);if(h<e&&(e=h),e===0)break}else if(!this.#t[0].isEmpty()&&this.#t[1].isEmpty()&&!this.#t[2].isEmpty())for(let l of n){let h=this.fuzzyRelation().satisfactionDegree(i,l,o);if(h<e&&(e=h),e===0)break}else if(!this.#t[0].isEmpty()&&!this.#t[1].isEmpty()&&this.#t[2].isEmpty())for(let l of a){let h=this.fuzzyRelation().satisfactionDegree(i,s,l);if(h<e&&(e=h),e===0)break}else if(this.#t[0].isEmpty()&&this.#t[1].isEmpty()&&!this.#t[2].isEmpty())for(let l of r)for(let h of n){let c=this.fuzzyRelation().satisfactionDegree(l,h,o);if(c<e&&(e=c),e===0)break}else if(this.#t[0].isEmpty()&&!this.#t[1].isEmpty()&&this.#t[2].isEmpty())for(let l of r)for(let h of a){let c=this.fuzzyRelation().satisfactionDegree(l,s,h);if(c<e&&(e=c),e===0)break}else if(!this.#t[0].isEmpty()&&this.#t[1].isEmpty()&&this.#t[2].isEmpty())for(let l of n)for(let h of a){let c=this.fuzzyRelation().satisfactionDegree(i,l,h);if(c<e&&(e=c),e===0)break}else for(let l of r)for(let h of n)for(let c of a){let b=this.fuzzyRelation().satisfactionDegree(l,h,c);if(b<e&&(e=b),e===0)break}return e}};var L=class extends m{#t;#e;constructor(t,...e){super(t),this.#t=[...e],this.#e=new Array(this.#t.length)}size(){return this.#t.length}at(t){return this.#t[t]}[Symbol.iterator](){return this.#t[Symbol.iterator]()}has(t){return this.#t.includes(t)}indexOf(t){return this.#t.indexOf(t)}emptyVariableSize(){let t=0;for(let e of this.#t)e.isEmpty()&&++t;return t}isDefined(){for(let t of this.#t)if(t.isEmpty())return!1;return!0}isSatisfied(){for(let t=0;t<this.#t.length;++t){if(this.#t[t].isEmpty())return-1;this.#e[t]=this.#t[t].value()}return this.crispRelation().isSatisfied(...this.#e)?1:0}satisfactionDegree(){for(let t=0;t<this.#t.length;++t){let e=this.#t[t];if(e.isEmpty())return m.UNDEFINED;this.#e[t]=e.value()}return this.fuzzyRelation().satisfactionDegree(...this.#e)}neighbors(){let t=[];for(let e of this.#t)for(let i of e)i!==this&&t.push(i);return t}highestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==m.UNDEFINED)return t;let e=new Array(this.emptyVariableSize()),i=0;for(let s=0;s<this.#t.length;++s)this.#t[s].isEmpty()?e[i++]=s:this.#e[s]=this.#t[s].value();return this.checkHCD(e,0,0)}lowestConsistencyDegree(){let t=this.satisfactionDegree();if(t!==m.UNDEFINED)return t;let e=new Array(this.emptyVariableSize()),i=0;for(let s=0;s<this.#t.length;++s)this.#t[s].isEmpty()?e[i++]=s:this.#e[s]=this.#t[s].value();return this.checkLCD(e,0,1)}checkHCD(t,e,i){let s=t[e],o=this.#t[s].domain();if(e===t.length-1)for(let r of o){this.#e[s]=r;let n=this.fuzzyRelation().satisfactionDegree(...this.#e);if(n>i&&(i=n),i===1)break}else for(let r of o)this.#e[s]=r,i=this.checkLCD(t,e+1,i);return i}checkLCD(t,e,i){let s=t[e],o=this.#t[s].domain();if(e===t.length-1)for(let r of o){this.#e[s]=r;let n=this.fuzzyRelation().satisfactionDegree(...this.#e);if(n<i&&(i=n),i===0)break}else for(let r of o)this.#e[s]=r,i=this.checkLCD(t,e+1,i);return i}};var A=class{#t=(t,e)=>new S(t,e);#e=(t,e)=>e.length===1?new x(t,e[0]):e.length===2?new N(t,e[0],e[1]):e.length===3?new T(t,e[0],e[1],e[2]):new L(t,...e);_isFuzzy=!1;_vars=[];_cons=[];setVariableFactory(t){this.#t=t}setConstraintFactory(t){this.#e=t}addVariable(t){t.setIndex(this._vars.length),this._vars.push(t)}createDomain(t){return"values"in t?new E(t.values):"min"in t&&"max"in t?new C(t.min,t.max):null}createVariable(t){if("variable"in t){let e=this.#t(this,t.variable.domain());return this.addVariable(e),e.setName(e.name()),e.assign(e.value()),e}else{if(t.value!==void 0&&!t.domain.contains(t.value))throw new Error;let e=this.#t(this,t.domain);return this.addVariable(e),t.name&&e.setName(t.name),t.value&&e.assign(t.value),e}}createConstraint(t){for(let i of t.variables)if(i.owner()!==this)return null;let e=this.#e(t.relation,t.variables);e.setIndex(this._cons.length),this._cons.push(e);for(let i of t.variables)i.connect(e);return e.isFuzzy()&&(this._isFuzzy=!0),"name"in t&&e.setName(t.name),e}removeConstraint(t){let e=this._cons.indexOf(t);this._cons.splice(e,1);for(let i=e;i<this._cons.length;++i)this._cons[i].setIndex(i);for(let i of t)i.disconnect(t);this._isFuzzy=!1;for(let i of this._cons)if(i.isFuzzy()){this._isFuzzy=!0;break}}clearAllVariables(){for(let t of this._vars)t.clear()}reverseVariables(){this._vars.reverse();for(let t=0;t<this._vars.length;++t)this._vars[t].setIndex(t)}sortVariables(t){this._vars.sort(t);for(let e=0;e<this._vars.length;++e)this._vars[e].setIndex(e)}variableSize(){return this._vars.length}variableAt(t){return this._vars[t]}variableOf(t){for(let e of this._vars)if(e.name()===t)return e;return null}hasVariable(t){return this._vars.includes(t)}variables(){return this._vars}constraintSize(){return this._cons.length}constraintAt(t){return this._cons[t]}constraintOf(t){for(let e of this._cons)if(e.name()===t)return e;return null}hasConstraint(t){return this._cons.includes(t)}constraints(){return this._cons}constraintsBetween(t,e){let i=[];for(let s of t)s.has(e)&&i.push(s);return i}constraintsWithWorstSatisfactionDegree(){let t=[],e=1;for(let i of this._cons){let s=i.satisfactionDegree();s<e?(e=s,t.length=0,t.push(i)):s-e<Number.MIN_VALUE*10&&t.push(i)}return[t,e]}worstSatisfactionDegree(){let t=1;for(let e of this._cons){let i=e.satisfactionDegree();if(i===m.UNDEFINED)return m.UNDEFINED;i<t&&(t=i)}return t}averageSatisfactionDegree(){let t=0;for(let e of this._cons)t+=e.satisfactionDegree();return t=t/this._cons.length,t}emptyVariableSize(){let t=0;for(let e of this._vars)e.isEmpty()&&t++;return t}constraintDensity(){return this.constraintSize()/this.variableSize()}hasEmptyDomain(){for(let t of this._vars)if(t.domain().size()===0)return!0;return!1}isFuzzy(){return this._isFuzzy}};var O=class extends A{createConstraint(t){if("satisfactionDegree"in t.relation)throw new Error;return super.createConstraint(t)}isFuzzy(){return!1}satisfiedConstraintRate(){return this.satisfiedConstraintSize()/this._cons.length}satisfiedConstraintSize(){let t=0;for(let e of this._cons)e.isSatisfied()===1&&++t;return t}violatingConstraints(){let t=[];for(let e of this._cons)e.isSatisfied()===0&&t.push(e);return t}violatingConstraintSize(){let t=0;for(let e of this._cons)e.isSatisfied()===0&&++t;return t}};var ot=class extends S{#t;constructor(t,e,i){super(t,e),this.#t=i}assign(t){super.assign(t),this.#t&&this.#t(this,t)}};var at=class{#t;#e;#i;constructor(t,e){this.#t=[...t],this.#e=[...e],this.#i=new Array(e.length);let i=1;for(let s=this.#i.length-1;s>=0;--s)this.#i[s]=i,i*=e[s].size()}satisfactionDegree(...t){if(this.#i.length!==t.length)throw new RangeError;let e=0;for(let i=0;i<this.#i.length;++i)e+=this.#i[i]*this.#e[i].indexOf(t[i]);return this.#t[e]}};var lt=class{#t;constructor(t){this.#t=t}satisfactionDegree(...t){return this.#t(...t)}};var ut=class{#t;#e;#i;constructor(t,e){this.#t=[...t],this.#e=[...e],this.#i=new Array(e.length);let i=1;for(let s=this.#i.length-1;s>=0;--s)this.#i[s]=i,i*=e[s].size()}isSatisfied(...t){if(this.#i.length!==t.length)throw new RangeError;let e=0;for(let i=0;i<this.#i.length;++i)e+=this.#i[i]*this.#e[i].indexOf(t[i]);return this.#t[e]}};var ht=class{#t;constructor(t){this.#t=t}isSatisfied(...t){return this.#t(...t)}};var ct=class{#t;constructor(t){this.#t=t}isSatisfied(...t){return this.#t.satisfactionDegree(...t)===1?1:0}},ft=class{#t;constructor(t){this.#t=t}satisfactionDegree(...t){return this.#t.isSatisfied(...t)?1:0}};var d=class{_debug=!0;#t=t=>console.log(t);_pro;_iterLimit=null;_timeLimit=null;_targetDeg=.8;#e=[];constructor(t){this._pro=t}name(){return""}exec(){return!1}setIterationLimit(t=null){this._iterLimit=t}setTimeLimit(t=null){this._timeLimit=t}setTargetRate(t=null){this._targetDeg=t}solve(){return this.exec()}addListener(t){this.#e.push(t)}removeListener(t){this.#e.splice(this.#e.indexOf(t),1)}foundSolution(t,e){let i=!1;for(let s of this.#e)s.foundSolution(t,e)&&(i=!0);return i}setDebugMode(t){this._debug=t}setDebugOutput(t){this.#t=t}_debugOutput(t){this._debug&&this.#t(t)}};var D=class{#t;#e;constructor(t){if("assignment"in t)this.#t=t.assignment.variable(),this.#e=t.assignment.value();else if("variable"in t)this.#t=t.variable,this.#e=t.value??t.variable.value();else throw new RangeError}apply(){this.#t.assign(this.#e)}toString(){return`v${this.#t.index()} <- ${this.#e}`}value(){return this.#e}variable(){return this.#t}};var f=class u{static fromVariables(t){let e=new u;return e.setVariables(t),e}#t=[];constructor(){}setProblem(t){this.#t.length=0;for(let e of t.variables())this.#t.push(new D({variable:e,value:e.value()}))}setAssignmentList(t){this.#t.length=0;for(let e of t)this.#t.push(new D({variable:e.variable(),value:e.value()}))}setVariables(t){this.#t.length=0;for(let e of t)this.#t.push(new D({variable:e,value:e.value()}))}addVariable(t,e=null){this.#t.push(new D({variable:t,value:e}))}apply(){for(let t of this.#t)t.apply()}clear(){this.#t.length=0}isEmpty(){return this.#t.length===0}size(){return this.#t.length}differenceSize(){let t=0;for(let e of this.#t)e.variable().value()!==e.value()&&++t;return t}at(t){return this.#t[t]}[Symbol.iterator](){return this.#t[Symbol.iterator]()}random(){return this.#t[Math.floor(Math.random()*this.#t.length)]}};var _=class u{static#t=-1;#e;#i=0;constructor(t){this.#e=new Array(t),this.#e.fill(u.#t)}hiddenSize(){return this.#i}hide(t,e){this.#e[t]===u.#t&&++this.#i,this.#e[t]=e}isEmpty(){return this.#e.length===this.#i}isValueHidden(t){return this.#e[t]!==u.#t}reveal(t){for(let e=0;e<this.#e.length;++e)this.#e[e]===t&&(this.#e[e]=u.#t,--this.#i)}revealAll(){this.#e.fill(u.#t),this.#i=0}};var k=class extends d{#t;#e=new f;#i=[];#s=!1;#r=0;#n=0;constructor(t){super(t),this.#t=[...this._pro.variables()];for(let e of this.#t)e.solverObject=new _(e.domain().size());this.#o()}name(){return"Forward Checking"}#o(){this.#i=[];for(let t=0;t<this.#t.length;++t){this.#i.push(new Array(this.#t.length));for(let e=0;e<this.#t.length;++e)e<t&&(this.#i[t][e]=this._pro.constraintsBetween(this.#t[e],this.#t[t]))}}#a(t,e){return t<e?this.#i[e][t]:this.#i[t][e]}#l(t,e){for(let i of this.#t){if(!i.isEmpty())continue;let s=i.domain(),o=i.solverObject,r=this.#a(e,i.index());for(let n of r)if(n.emptyVariableSize()===1){for(let a=0,l=s.size();a<l;++a)o.isValueHidden(a)||(i.assign(s.at(a)),n.isSatisfied()===0&&o.hide(a,t));if(i.clear(),o.isEmpty())return!1}}return!0}#u(){let t=0,e=Number.MAX_VALUE;for(let i=0;i<this.#t.length;++i){let s=this.#t[i];if(!s.isEmpty())continue;let r=s.domain().size()-s.solverObject.hiddenSize();r<e&&(e=r,t=i)}return t}#h(t){if(this._iterLimit&&this._iterLimit<this.#r++)return this._debugOutput("stop: number of iterations has reached the limit"),!1;if(this.#n<Date.now())return this._debugOutput("stop: time limit has been reached"),!1;if(t===this._pro.variableSize())return this.#e.setProblem(this._pro),!0;let e=this.#s?this.#u():t,i=this.#t[e],s=i.domain(),o=i.solverObject;for(let r=0,n=s.size();r<n;++r)if(!o.isValueHidden(r)){if(i.assign(s.at(r)),this.#l(t,e)&&this.#h(t+1))return!0;for(let a of this.#t)a.solverObject.reveal(t)}return i.clear(),!1}exec(){this.#n=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#r=0,this._pro.clearAllVariables();let t=this.#h(0);for(let e of this.#e)e.apply(),e.variable().solverObject.revealAll();return t}setTargetRate(){}setUsingMinimumRemainingValuesHeuristics(t){this.#s=t}};var R=class extends d{#t;#e=new f;#i;#s=0;#r=new Set;#n=[];#o=0;#a=0;constructor(t){super(t),this.#t=[...this._pro.variables()];for(let e of this.#t)e.solverObject=new _(e.domain().size());this.#i=this._pro.constraintSize()}name(){return"Forward Checking for Max CSPs"}#l(t,e){if(this._iterLimit&&this._iterLimit<this.#o++||this.#a<Date.now())return!1;if(t===this._pro.variableSize()){let r=this._pro.violatingConstraintSize();return r<this.#i&&(this.#i=r,this.#e.setProblem(this._pro),this._debugOutput(`   refreshed ${this.#i}`),(this._targetDeg??1)<=this._pro.satisfiedConstraintRate())}let i=this.#t[t],s=i.domain(),o=i.solverObject;for(let r=0;r<s.size();++r)if(!o.isValueHidden(r)&&(i.assign(s.at(r)),this.#s=e+this.#h(t,i),!(this.#s>this.#i))){if(this.#u(t)&&this.#l(t+1,this.#s))return!0;for(let n of this.#t)n.solverObject.reveal(t)}return i.clear(),!1}#u(t){let e=this.#t[t];for(let i=t+1;i<this.#t.length;++i){let s=this.#t[i];this.#n=this._pro.constraintsBetween(e,s);for(let o of this.#n)if(o.emptyVariableSize()===1&&this.#c(s,o,t)&&s.solverObject.isEmpty())return!1}return!0}#h(t,e){let i=0;this.#r.clear();for(let s=0;s<t;++s){this.#n=this._pro.constraintsBetween(e,this.#t[s]);for(let o of this.#n)this.#r.has(o)||(o.isSatisfied()===0&&++i,this.#r.add(o))}return i}#c(t,e,i){let s=!1,o=t.domain(),r=t.solverObject;for(let n=0;n<o.size();++n)r.isValueHidden(n)||(t.assign(o.at(n)),e.isSatisfied()===0&&this.#s+1>this.#i&&(r.hide(n,i),s=!0));return s}exec(){this.#a=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#o=0,this._pro.clearAllVariables();let t=this.#l(0,0);t?this._debugOutput("stop: current degree is above the target"):(this._iterLimit&&this._iterLimit<this.#o&&this._debugOutput("stop: number of iterations has reached the limit"),this.#a<Date.now()&&this._debugOutput("stop: time limit has been reached"));for(let e of this.#e)e.apply(),e.variable().solverObject.revealAll();return t}};var P=class u extends d{static#t(t,e){let i=new Set(t);for(let s of e)i.add(s);return i}static#e(t,e){let i=new Set(t);for(let s of e)i.delete(s);return i}static#i(t,e){let i=new Set(t);return i.add(e),i}static#s(t,e){let i=new Set(t);return i.delete(e),i}#r=0;#n=0;#o=!1;constructor(t,e=!1){super(t),e&&this._pro.clearAllVariables()}name(){return"Local Changes"}#a(t,e,i){let s=new Set,o=new Set;for(let n of t){let a=this._pro.constraintsBetween(e,n);for(let l of a)o.add(l)}let r=e.value();e.assign(i);for(let n of o)if(n.isSatisfied()===0)for(let a of n)s.add(a);return e.assign(r),s.delete(e),s}#l(t,e,i){let s=new Set;for(let r of t){let n=this._pro.constraintsBetween(e,r);for(let a of n)s.add(a)}let o=e.value();e.assign(i);for(let r of s)if(r.isSatisfied()===0)return e.assign(o),!1;return e.assign(o),!0}#u(t,e,i,s){if(!this.#l(t,i,s))return!1;let o=u.#t(t,e);if(this.#l(o,i,s))return!0;let r=this.#a(o,i,s),n=u.#e(o,r);this.#l(n,i,s)||this._debugOutput("bug");for(let a of r)a.clear();return t=u.#i(t,i),e=u.#e(e,r),this.#c(t,e,r)}#h(t,e,i,s){if(s.size===0)return!1;let o=s.values().next().value,r=f.fromVariables(e);i.assign(o);let n=this.#u(t,e,i,o);return n||this.#o?n:(i.clear(),r.apply(),this.#h(t,e,i,u.#s(s,o)))}#c(t,e,i){if(this._debugOutput(`V1 ${t.size}, V2' ${e.size}, V3' ${i.size}`),(this._targetDeg??1)<=this._pro.satisfiedConstraintRate())return this._debugOutput("stop: current degree is above the target"),this.#o=!0,!0;if(this._iterLimit&&this._iterLimit<this.#r++)return this._debugOutput("stop: number of iterations has reached the limit"),this.#o=!0,!1;if(this.#n<Date.now())return this._debugOutput("stop: time limit has been reached"),this.#o=!0,!1;if(i.size===0)return!0;let s=i.values().next().value,o=new Set;for(let n of s.domain())o.add(n);let r=this.#h(t,e,s,o);return!r||this.#o?r:(e=u.#i(e,s),i=u.#s(i,s),this.#c(t,e,i))}exec(){this.#n=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#r=0,this.#o=!1,this._pro.emptyVariableSize()===0&&this._pro.clearAllVariables();let t=new Set,e=new Set;for(let i of this._pro.variables())(i.isEmpty()?e:t).add(i);return this.#c(new Set,t,e)}};var I=class u extends d{static#t(t,e){let i=new Set(t);for(let s of e)i.add(s);return i}static#e(t,e){let i=new Set(t);for(let s of e)i.delete(s);return i}static#i(t,e){let i=new Set(t);return i.add(e),i}#s=0;#r=0;#n=!1;constructor(t,e=!1){super(t),e&&this._pro.clearAllVariables()}name(){return"Local Changes Ex"}#o(t,e,i){let s=new Set,o=new Set;for(let n of t){let a=this._pro.constraintsBetween(e,n);for(let l of a)o.add(l)}let r=e.value();e.assign(i);for(let n of o)if(n.isSatisfied()===0)for(let a of n)s.add(a);return e.assign(r),s.delete(e),s}#a(t,e,i){let s=new Set;for(let r of t){let n=this._pro.constraintsBetween(e,r);for(let a of n)s.add(a)}let o=e.value();e.assign(i);for(let r of s)if(r.isSatisfied()===0)return e.assign(o),!1;return e.assign(o),!0}#l(t,e,i){if(!this.#a(t,i,i.value()))return!1;let s=u.#t(t,e);if(this.#a(s,i,i.value()))return!0;let o=this.#o(s,i,i.value());return e=u.#e(e,o),t=u.#i(t,i),this.#h(t,e,o)}#u(t,e,i){for(let s of i.domain()){let o=f.fromVariables(e);i.assign(s);let r=this.#l(t,e,i);if(r||this.#n)return r;i.clear(),o.apply()}return!1}#h(t,e,i){for(e=new Set(e),i=new Set(i);;){if(this._debugOutput(`V1 ${t.size}, V2' ${e.size}, V3' ${i.size}`),(this._targetDeg??1)<=this._pro.satisfiedConstraintRate())return this._debugOutput("stop: current degree is above the target"),this.#n=!0,!0;if(this._iterLimit&&this._iterLimit<this.#s++)return this._debugOutput("stop: number of iterations has reached the limit"),this.#n=!0,!1;if(this.#r<Date.now())return this._debugOutput("stop: time limit has been reached"),this.#n=!0,!1;if(i.size===0)return!0;let s=i.values().next().value,o=this.#u(t,e,s);if(!o||this.#n)return o;e.add(s),i.delete(s)}}exec(){this.#r=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#s=0,this.#n=!1,this._pro.emptyVariableSize()===0&&this._pro.clearAllVariables();let t=new Set,e=new Set;for(let i of this._pro.variables())(i.isEmpty()?e:t).add(i);return this.#h(new Set,t,e)}};var F=class extends d{#t;#e=!0;constructor(t){super(t),this.#t=new Array(this._pro.constraintSize()),this.#t.fill(1)}name(){return"Breakout"}#i(t,e){let i=0;for(let s of t){let o=s.value(),r=0;for(let n of s)r+=(1-n.isSatisfied())*this.#t[n.index()];t:for(let n of s.domain()){if(o===n)continue;s.assign(n);let a=r;for(let l of s)if(a-=(1-l.isSatisfied())*this.#t[l.index()],a<i)continue t;a>i?(i=a,e.clear(),e.addVariable(s,n)):i!==0&&e.addVariable(s,n)}s.assign(o)}}#s(t){let e=new Set;for(let i of t)for(let s of i)e.add(s);return Array.from(e)}exec(){let t=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,e=0;for(let s of this._pro.variables())s.isEmpty()&&s.assign(s.domain().at(0));let i=new f;for(;;){let s=this._pro.violatingConstraints();if((this._targetDeg??1)<=this._pro.satisfiedConstraintRate())return this._debugOutput("stop: current degree is above the target"),!0;if(this._iterLimit&&this._iterLimit<e++)return this._debugOutput("stop: number of iterations has reached the limit"),!1;if(t<Date.now())return this._debugOutput("stop: time limit has been reached"),!1;if(this._debugOutput(s.length+" violations"),this.#i(this.#s(s),i),0<i.size()){let o=this.#e?i.random():i.at(0);o.apply(),i.clear(),this._debugOutput("	"+o)}else{for(let o of s)this.#t[o.index()]+=1;this._debugOutput("breakout")}}}setRandomness(t){this.#e=t}};var M=class u extends d{static nextInt(t){return Math.floor(Math.random()*Math.floor(t))}#t=[];#e=[];constructor(t){super(t)}name(){return"GENET"}#i(){this._debugOutput("network creation start");let t=[];for(let e of this._pro.variables()){if(e.domain().size()===0)return!1;this.#t.push(new Q(e))}for(let e of this._pro.constraints())if(e.size()===1){let i=e.at(0),s=this.#t[e.at(0).index()];for(let o=0;o<s.size();++o){let r=i.value();i.assign(s.get(o)._value),e.isSatisfied()===0&&t.push(new j(s.get(o))),i.assign(r)}}else{let i=e.at(0),s=e.at(1),o=this.#t[e.at(0).index()],r=this.#t[e.at(1).index()];for(let n=0;n<o.size();++n){let a=i.value();i.assign(o.get(n)._value);for(let l=0;l<r.size();++l){let h=s.value();s.assign(r.get(l)._value),e.isSatisfied()===0&&t.push(new j(o.get(n),r.get(l))),s.assign(h)}i.assign(a)}}for(let e of this.#t)for(let i of e._neurons)i.lockConnections();return this.#e=t,this._debugOutput("network creation complete"),!0}#s(t){for(let e=t.length;e>1;--e){let i=u.nextInt(e),s=t[e-1];t[e-1]=t[i],t[i]=s}return t}exec(){if(!this.#i())throw new Error;let t=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,e=0,i=new f,s=[];for(let n=0;n<this.#t.length;++n)s.push(n);let o=this._pro.satisfiedConstraintRate(),r=!1;for(;;){if(this._iterLimit&&this._iterLimit<e++){this._debugOutput("stop: number of iterations has reached the limit");break}if(t<Date.now()){this._debugOutput("stop: time limit has been reached");break}let n=!1;for(let a of this.#s(s))this.#t[a].setActivityMaximumInput()&&(n=!0);if(n){for(let l of this.#t)l.applyToVariable();let a=this._pro.satisfiedConstraintRate();if(o<a){if(o=a,this._debugOutput(`satisfied constraint rate: ${a}`),i.setProblem(this._pro),this.foundSolution(i,a)){r=!0;break}if(this._targetDeg??1<=o){this._debugOutput("stop: current degree is above the target"),r=!0;break}}}else for(let a of this.#e)a.refreshWeight()}return i.apply(),r}},Q=class u{static nextInt(t){return Math.floor(Math.random()*Math.floor(t))}#t;#e=0;#i=[];_neurons=[];constructor(t){this.#t=t;for(let e of t.domain())this._neurons.push(new Z(e));this.#s(u.nextInt(this._neurons.length))}#s(t){for(let e of this._neurons)e._isActive=!1;this._neurons[t]._isActive=!0,this.#e=t}applyToVariable(){this.#t.assign(this._neurons[this.#e]._value)}get(t){return this._neurons[t]}neurons(){return this._neurons}setActivityMaximumInput(){this.#i.length=0;let t=Number.NEGATIVE_INFINITY,e=!1;for(let i=0;i<this._neurons.length;++i){let s=this._neurons[i].getInput();t<=s&&(t<s&&(t=s,this.#i.length=0,e=!1),this.#i.push(i),this.#e===i&&(e=!0))}return e||this.#i.length===0?!1:(this.#s(this.#i[u.nextInt(this.#i.length)]),!0)}size(){return this._neurons.length}},j=class{#t;#e;_weight;constructor(t,e=null){this._weight=-1,this.#t=t,this.#t.addConnection(this),this.#e=e,this.#e&&this.#e.addConnection(this)}getNeuron(t){return t===this.#t?this.#e:t===this.#e?this.#t:null}refreshWeight(){!this.#t._isActive||this.#e!==null&&!this.#e._isActive||(this._weight+=-1)}},Z=class{#t=[];#e=[];_value;_isActive=!1;constructor(t){this._value=t}addConnection(t){this.#t.push(t)}lockConnections(){this.#e=[...this.#t],this.#t=null}getInput(){let t=0;for(let e of this.#e){let i=e.getNeuron(this);t+=e._weight*(i===null||i._isActive?1:0)}return t}};var U=class extends d{#t=new Set;#e=new Set;#i=[];#s=[];#r=!0;constructor(t){super(t);for(let e of this._pro.constraints())this.#i.push(new X(e)),this.#s.push(null)}name(){return"SRS 3 for Crisp CSPs"}#n(t){let e=t.index();return this.#s[e]===null&&(this.#s[e]=t.neighbors()),this.#s[e]}#o(t){this._debugOutput("repair");let e=new f,i=0;for(let s of t){let o=s.value(),r=0;for(let n of s)r+=1-n.isSatisfied();t:for(let n of s.domain()){if(o===n||(s.assign(n),t.isSatisfied()!==1))continue;let a=r;for(let l of s)if(a-=1-l.isSatisfied(),a<i)continue t;a>i?(i=a,e.clear(),e.addVariable(s,n)):i!==0&&e.addVariable(s,n)}s.assign(o)}if(e.size()>0){let s=this.#r?e.random():e.at(0);return s.apply(),this._debugOutput("	"+s),!0}return!1}#a(t,e){let i=[],s=t;for(;;){s=s.parent(),i.length=0,s.getDescendants(i),s.clear();for(let o of e)this.#e.delete(o),this.#t.delete(o);if(e.delete(s)||(this.#e.add(s),s.parent()!==null&&!this.#o(s.parent().getObject())))break}}#l(t){this._debugOutput("spread"),this.#t.add(t);for(let e of this.#n(t.getObject())){let i=this.#i[e.index()];!this.#t.has(i)&&!this.#e.has(i)&&(i.clear(),t.add(i),this.#e.add(i))}}#u(t){this._debugOutput("srs");let e=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,i=0;this.#t.clear(),this.#e.clear();for(let s of t)this.#e.add(s);for(;t.size&&this.#e.size;){if((this._targetDeg??1)<=this._pro.satisfiedConstraintRate())return this._debugOutput("stop: current degree is above the target"),!0;if(this._iterLimit&&this._iterLimit<i++)return this._debugOutput("stop: number of iterations has reached the limit"),!1;if(e<Date.now())return this._debugOutput("stop: time limit has been reached"),!1;let s=this.#e.values().next().value;this.#e.delete(s),this.#o(s.getObject())?t.delete(s)||(s.parent()!==null&&this.#o(s.parent().getObject())?this.#a(s,t):this.#l(s)):this.#l(s)}return!1}exec(){let t=this._pro.violatingConstraints(),e=new Set;for(let i of t){let s=this.#i[i.index()];e.add(s)}return this.#u(e)?!0:e.size===0}setRandomness(t){this.#r=t}},X=class{#t=[];#e;#i;constructor(t){this.#e=null,this.#i=t}add(t){t.#e=this,this.#t.push(t)}clear(){for(let t of this.#t)t.#e=null;this.#t.length=0}getDescendants(t){t.push(this);for(let e of this.#t)e.getDescendants(t)}getObject(){return this.#i}parent(){return this.#e}};var $=class u extends d{static CONTINUE=0;static TERMINATE=1;#t;#e=new f;#i=[];#s=0;#r=0;#n=0;#o=!1;#a=0;#l;#u;#h;#c=!1;constructor(t,e=null){super(t),this.#t=[...this._pro.variables()],this.#l=new Array(this._pro.variableSize()),this.#m(),this.#h=new Array(this._pro.constraintSize());let i=[];for(let s of this._pro.constraints())s.size()===1&&i.push(s);this.#u=[...i],e&&(this.#s=e)}name(){return"Forward Checking for Fuzzy CSPs"}#m(){this.#i=[];for(let t=0;t<this.#t.length;++t){this.#i.push(new Array(this.#t.length));for(let e=0;e<this.#t.length;++e)e<t&&(this.#i[t][e]=this._pro.constraintsBetween(this.#t[e],this.#t[t]))}}#f(t,e){return t<e?this.#i[e][t]:this.#i[t][e]}#b(){for(let t of this.#u){let e=t.at(0),i=e.value(),s=e.domain(),o=e.solverObject;for(let r=0,n=s.size();r<n;++r)e.assign(s.at(r)),t.satisfactionDegree()<=this.#s&&o.hide(r,-1);if(e.assign(i),o.isEmpty())return!1}return!0}#d(t,e,i){let s=e.domain(),o=e.solverObject;for(let r=0,n=s.size();r<n;++r)o.isValueHidden(r)||(e.assign(s.at(r)),i.satisfactionDegree()<=this.#s&&o.hide(r,t));return e.clear(),!o.isEmpty()}#p(t,e,i){let s=e.domain(),o=e.solverObject,r=null;for(let l of i)if(l.isEmpty()&&l!==e){r=l;break}let n=r.domain(),a=r.solverObject;t:for(let l=0,h=s.size();l<h;++l)if(!o.isValueHidden(l)){e.assign(s.at(l));for(let c=0,b=n.size();c<b;++c){if(a.isValueHidden(c))continue;if(r.assign(n.at(c)),i.satisfactionDegree()>this.#s)continue t}o.hide(l,t)}return r.clear(),e.clear(),!o.isEmpty()}#_(t,e,i){let s=e.domain(),o=e.solverObject,r=null,n=null;for(let b of i)if(b.isEmpty()&&b!==e)if(r===null)r=b;else{n=b;break}let a=r.domain(),l=n.domain(),h=r.solverObject,c=n.solverObject;t:for(let b=0,p=s.size();b<p;++b)if(!o.isValueHidden(b)){e.assign(s.at(b));for(let g=0,V=a.size();g<V;++g)if(!h.isValueHidden(g)){r.assign(a.at(g));for(let v=0,vt=l.size();v<vt;++v){if(c.isValueHidden(v))continue;if(n.assign(l.at(v)),i.satisfactionDegree()>this.#s)continue t}}o.hide(b,t)}return n.clear(),r.clear(),e.clear(),!o.isEmpty()}#V(t,e,i,s){let o=e.domain(),r=e.solverObject,n=new Array(s-1),a=0;for(let h of i)h.isEmpty()&&h!==e&&(n[a++]=h);let l=new Array(n.length);t:for(let h=0,c=o.size();h<c;++h)if(!r.isValueHidden(h)){e.assign(o.at(h)),l.fill(0);e:for(;;){let b=!1;for(let p=0;p<n.length;++p){let g=n[p].domain();if(n[p].solverObject.isValueHidden(l[p])){b=!0;break}n[p].assign(g.at(l[p]))}if(!b&&i.satisfactionDegree()>this.#s)continue t;for(let p=0;p<n.length&&(l[p]+=1,!(l[p]<n[p].domain().size()));++p)if(l[p]=0,p===n.length-1)break e}r.hide(h,t)}for(let h of n)h.clear();return e.clear(),!r.isEmpty()}#S(t,e){for(let i of this.#t){if(!i.isEmpty())continue;let s=this.#f(e,i.index());for(let o of s){let r=o.emptyVariableSize();if(r===1){if(!this.#d(t,i,o))return!1}else if(this.#c){if(r===2){if(!this.#p(t,i,o))return!1}else if(r===3){if(!this.#_(t,i,o))return!1}else if(r>3&&!this.#V(t,i,o,r))return!1}}}return!0}#D(t){this.#h.fill(!1);for(let e=0;e<this.#t.length;++e){let i=this.#t[e];if(i===t||i.isEmpty())continue;let s=this.#f(t.index(),e);for(let o of s){if(this.#h[o.index()])continue;let r=o.satisfactionDegree();if(r!==m.UNDEFINED&&r<=this.#s)return!1;this.#h[o.index()]=!0}}return!0}#w(){for(let t=0;t<this.#l.length;++t){let e=this.#l[t].index();for(let i=t+1;i<this.#l.length;++i){let s=this.#l[i],o=this.#f(e,s.index());for(let r of o){let n=s.value(),a=s.domain(),l=s.solverObject;for(let h=0,c=a.size();h<c;++h)l.isValueHidden(h)||(s.assign(a.at(h)),r.satisfactionDegree()<=this.#s&&l.hide(h,t));s.assign(n)}}}}#g(){let t=0,e=Number.MAX_VALUE;for(let i=0;i<this.#t.length;++i){let s=this.#t[i];if(!s.isEmpty())continue;let r=s.domain().size()-s.solverObject.hiddenSize();r<e&&(e=r,t=i)}return t}#v(t){let e=u.CONTINUE,i=this.#o?this.#g():t,s=this.#t[i],o=s.domain(),r=s.solverObject;this.#l[t]=s;for(let n=0,a=o.size();n<a;++n){if(r.isValueHidden(n))continue;if(this._iterLimit&&this._iterLimit<this.#r++||this.#n<Date.now()){e=u.TERMINATE;break}s.assign(o.at(n));for(let h of this.#t)h.solverObject.reveal(t);if(!this.#D(s)||!this.#S(t,i))continue;let l=t+1;if(e=l===this.#t.length-1?this.#y(l):this.#v(l),e===u.TERMINATE)break}if(e===u.CONTINUE)for(let n of this.#t)n.solverObject.reveal(t);return s.clear(),e}#y(t){let e=u.CONTINUE,i=this.#t[this.#o?this.#g():t],s=i.domain(),o=i.solverObject;this.#l[t]=i;for(let r=0,n=s.size();r<n;++r){if(o.isValueHidden(r))continue;if(this._iterLimit&&this._iterLimit<this.#r++||this.#n<Date.now()){e=u.TERMINATE;break}i.assign(s.at(r));let a=this._pro.worstSatisfactionDegree();if(a>this.#s){if(this.#s=a,this.#e.setProblem(this._pro),e=u.TERMINATE,this._targetDeg!==null&&this._targetDeg<=this.#s)break;this.#b(),this.#w()}}return i.clear(),e}exec(){this.#n=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#r=0;for(let e of this.#t)e.solverObject=new _(e.domain().size());if(this._pro.clearAllVariables(),!this.#b())return!1;let t=!1;for(;;){if(this.#v(0)===u.TERMINATE){if(this._iterLimit&&this._iterLimit<this.#r++){this._debugOutput("stop: number of iterations has reached the limit");break}if(this.#n<Date.now()){this._debugOutput("stop: time limit has been reached");break}}if(this.#e.isEmpty())break;if(this._debugOutput(`	found a solution: ${this.#s}`),this.foundSolution(this.#e,this.#s)){t=!0;break}if(this._targetDeg===null)t=!0,this.#s+=this.#a;else if(this._targetDeg<=this.#s){this._debugOutput("stop: current degree is above the target"),t=!0;break}for(let i of this.#t)i.solverObject.revealAll()}this.#e.apply();for(let e of this.#t)e.solverObject=null;return t}setTargetRate(t=null){if(this._targetDeg=t,this._targetDeg===null)this.#s=0;else{let e=Number.MIN_VALUE;for(this.#s=this._targetDeg-e;this.#s>=this._targetDeg;)e*=10,this.#s=this._targetDeg-e}}setUsingMinimumRemainingValuesHeuristics(t){this.#o=t}setIncrementStepOfWorstSatisfactionDegree(t){this.#a=t}setIntensivePruning(t){this.#c=t}};var H=class u extends d{static CONTINUE=0;static TERMINATE=1;#t;#e=new f;#i=[];#s=0;#r=0;#n=0;#o=!1;#a=0;constructor(t,e=null){super(t),this.#t=[...this._pro.variables()],this.#l(),this.#s=Math.max(0,t.worstSatisfactionDegree()),e&&(this.#s=e)}name(){return"Forward Checking for Fuzzy CSPs of Binary Constraints"}#l(){this.#i=[];for(let t=0;t<this.#t.length;++t){this.#i.push(new Array(this.#t.length));for(let e=0;e<this.#t.length;++e)e<t&&(this.#i[t][e]=this._pro.constraintsBetween(this.#t[e],this.#t[t]))}}#u(t,e){return t<e?this.#i[e][t]:this.#i[t][e]}#h(t,e,i){let s=e.domain(),o=e.solverObject;for(let r=0,n=s.size();r<n;++r)o.isValueHidden(r)||(e.assign(s.at(r)),i.satisfactionDegree()<=this.#s&&o.hide(r,t));return e.clear(),!o.isEmpty()}#c(t,e){for(let i of this.#t){if(!i.isEmpty())continue;let s=this.#u(e,i.index());for(let o of s)if(o.size()===2&&!this.#h(t,i,o))return!1}return!0}#m(){let t=0,e=Number.MAX_VALUE;for(let i=0;i<this.#t.length;++i){let s=this.#t[i];if(!s.isEmpty())continue;let r=s.domain().size()-s.solverObject.hiddenSize();r<e&&(e=r,t=i)}return t}#f(t){let e=u.CONTINUE,i=this.#o?this.#m():t,s=this.#t[i],o=s.domain(),r=s.solverObject;for(let n=0,a=o.size();n<a;++n){if(r.isValueHidden(n))continue;if(this._iterLimit&&this._iterLimit<this.#r++||this.#n<Date.now()){e=u.TERMINATE;break}s.assign(o.at(n));for(let h of this.#t)h.solverObject.reveal(t);if(!this.#c(t,i))continue;let l=t+1;if(e=l===this.#t.length-1?this.#b(l):this.#f(l),e===u.TERMINATE)break}if(e===u.CONTINUE)for(let n of this.#t)n.solverObject.reveal(t);return s.clear(),e}#b(t){let e=u.CONTINUE,i=this.#t[this.#o?this.#m():t],s=i.domain(),o=i.solverObject;for(let r=0,n=s.size();r<n;++r){if(o.isValueHidden(r))continue;if(this._iterLimit&&this._iterLimit<this.#r++||this.#n<Date.now()){e=u.TERMINATE;break}i.assign(s.at(r));let a=this._pro.worstSatisfactionDegree();if(a>this.#s&&(this.#s=a,this.#e.setProblem(this._pro),e=u.TERMINATE,this._targetDeg!==null&&this._targetDeg<=this.#s))break}return i.clear(),e}exec(){this.#n=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#r=0;for(let i of this.#t)i.solverObject=new _(i.domain().size());this._pro.clearAllVariables();let t=new f,e=!1;for(;;){if(this.#f(0)===u.TERMINATE){if(this._iterLimit&&this._iterLimit<this.#r++){this._debugOutput("stop: number of iterations has reached the limit");break}if(this.#n<Date.now()){this._debugOutput("stop: time limit has been reached");break}}if(this.#e.isEmpty())break;if(t.setAssignmentList(this.#e),this.#e.clear(),this._debugOutput(`	found a solution: ${this.#s}`),this.foundSolution(t,this.#s)){e=!0;break}if(this._targetDeg===null){if(e=!0,this.#s+this.#a>1)break;this.#s+=this.#s+this.#a>1?0:this.#a}else if(this._targetDeg<=this.#s){this._debugOutput("stop: current degree is above the target"),e=!0;break}for(let s of this.#t)s.solverObject.revealAll()}t.apply();for(let i of this.#t)i.solverObject=null;return e}setTargetRate(t=null){if(this._targetDeg=t,this._targetDeg===null)this.#s=0;else{let e=Number.MIN_VALUE;for(this.#s=this._targetDeg-e;this.#s>=this._targetDeg;)e*=10,this.#s=this._targetDeg-e}}setUsingMinimumRemainingValuesHeuristics(t){this.#o=t}setIncrementStepOfWorstSatisfactionDegree(t){this.#a=t}};var B=class u extends d{static#t(t,e){let i=new Set(t);for(let s of e)i.add(s);return i}static#e(t,e){let i=new Set(t);for(let s of e)i.delete(s);return i}static#i(t,e){let i=new Set(t);return i.add(e),i}static#s(t,e){let i=new Set(t);return i.delete(e),i}#r=0;#n=0;#o=0;#a=0;#l=0;constructor(t){super(t),this.#h()}name(){return"Flexible Local Changes"}#u(t,e){let i=new Map;for(let r of e)if(r.isDefined())for(let n of r)i.has(n)?i.set(n,i.get(n)+1):i.set(n,1);let s=[...t];s.sort((r,n)=>{let a=0,l=0;return i.has(r)&&(a=i.get(r)),i.has(n)&&(l=i.get(n)),a<l?1:a>l?-1:0});let o=new Set;for(let r of s){let n=!1;for(let a of e)if(a.isDefined()){n=!0;break}if(!n)break;r.clear(),o.add(r)}return o}#h(){let t=1,e=0;for(let i of this._pro.variables())for(let s of i){let o=s.lowestConsistencyDegree(),r=s.highestConsistencyDegree();o<t&&(t=o),r>e&&(e=r)}this.#n=t,this.#r=e}#c(t,e,i,s,o,r,n){let a=this.#u(e,r),l=u.#i(t,i),h=u.#e(e,a);return this.#f(l,h,a,s,Math.min(o,s),n)}#m(t,e,i,s,o,r){let n=this.#n;if(i.domain().size()===0)return n;let a=f.fromVariables(e),l=i.domain().at(0),h=f.fromVariables(e);for(let c=0;c<i.domain().size()&&n<o;++c){let b=i.domain().at(c);i.assign(b);let p=Math.min(s,this.#d(t,i,n,r));if(p>Math.max(n,r)){let g=new Set,V=Math.min(Math.min(p,o),this.#p(t,e,i,p,o,g));if(V>n&&(n=V,l=b,a=f.fromVariables(e)),g.size){let v=this.#c(t,e,i,p,o,g,Math.max(r,n));if(this.#l!==-1)return n;v>n&&(n=v,l=b,a=f.fromVariables(e)),h.apply()}}}return a.apply(),i.assign(l),n}#f(t,e,i,s,o,r){if(this._debugOutput(`X1 ${t.size}, X2' ${e.size}, X3' ${i.size}`),this._targetDeg!==null&&this._targetDeg<=this._pro.worstSatisfactionDegree())return this._debugOutput("stop: current degree is above the target"),this.#l=1,o;if(this._iterLimit&&this._iterLimit<this.#o++)return this._debugOutput("stop: number of iterations has reached the limit"),this.#l=0,o;if(this.#a<Date.now())return this._debugOutput("stop: time limit has been reached"),this.#l=0,o;if(i.size===0)return o;let n=i.values().next().value,a=this.#m(t,e,n,s,o,r);return this.#l!==-1?o:a<r?this.#n:(e=u.#i(e,n),i=u.#s(i,n),this.#f(t,e,i,s,a,r))}#b(t,e){let i=new Set;for(let o of t)for(let r of o)i.add(r);let s=1;for(let o of i){let r=o.satisfactionDegree();r!==m.UNDEFINED&&r<s&&(s=r)}for(let o of this._pro.constraints())o.lowestConsistencyDegree()<this.#r&&e.add(o);return s}#d(t,e,i,s){let o=1,r=new Set;for(let n of t){let a=this._pro.constraintsBetween(n,e);for(let l of a)r.add(l)}for(let n of r){let a=n.satisfactionDegree();if(a!==m.UNDEFINED&&(a<o&&(o=a),o<=i||o<=s))return o}return o}#p(t,e,i,s,o,r){let n=1,a=new Set;for(let l of t){let h=this._pro.constraintsBetween(l,i);for(let c of h)a.add(c)}for(let l of e){let h=this._pro.constraintsBetween(l,i);for(let c of h)a.add(c)}for(let l of a){let h=l.satisfactionDegree();h!==m.UNDEFINED&&h<n&&(n=h)}for(let l of a){let h=l.satisfactionDegree();h!==m.UNDEFINED&&(h<s||h<o)&&r.add(l)}return n}exec(){this.#a=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#o=0,this.#l=-1;let t=this._pro.worstSatisfactionDegree();this._pro.emptyVariableSize()===0&&this._pro.clearAllVariables();let e=new Set,i=new Set,s=new Set;for(let b of this._pro.variables())(b.isEmpty()?s:i).add(b);let o=new Set,r=this.#b(i,o),n,a=null;s.size===0?(n=r,a=f.fromVariables(i)):n=this.#n;let l=u.#t(this.#u(i,o),s),h=u.#e(i,l),c=this.#f(e,h,l,this.#r,this.#r,n);return c<n&&a!==null&&a.apply(),c=this._pro.worstSatisfactionDegree(),c>t&&c>0&&(this.#l!==0||this._targetDeg===null)}};var W=class u extends d{static#t(t,e){let i=new Set(t);for(let s of e)i.add(s);return i}static#e(t,e){let i=new Set(t);for(let s of e)i.delete(s);return i}static#i(t,e){let i=new Set(t);return i.add(e),i}#s=0;#r=0;#n=0;#o=0;#a=0;constructor(t){super(t),this.#u()}name(){return"Flexible Local Changes Ex"}#l(t,e){let i=new Map;for(let r of e)if(r.isDefined())for(let n of r)i.has(n)?i.set(n,i.get(n)+1):i.set(n,1);let s=[...t];s.sort((r,n)=>{let a=0,l=0;return i.has(r)&&(a=i.get(r)),i.has(n)&&(l=i.get(n)),a<l?1:a>l?-1:0});let o=new Set;for(let r of s){let n=!1;for(let a of e)if(a.isDefined()){n=!0;break}if(!n)break;r.clear(),o.add(r)}return o}#u(){let t=1,e=0;for(let i of this._pro.variables())for(let s of i){let o=s.lowestConsistencyDegree(),r=s.highestConsistencyDegree();o<t&&(t=o),r>e&&(e=r)}this.#r=t,this.#s=e}#h(t,e,i,s,o,r,n){let a=this.#l(e,r),l=u.#i(t,i),h=u.#e(e,a);return this.#m(l,h,a,s,Math.min(o,s),n)}#c(t,e,i,s,o,r){let n=this.#r;if(i.domain().size()===0)return n;let a=f.fromVariables(e),l=i.domain().at(0),h=f.fromVariables(e);for(let c=0;c<i.domain().size()&&n<o;++c){let b=i.domain().at(c);i.assign(b);let p=Math.min(s,this.#b(t,i,n,r));if(p>Math.max(n,r)){let g=new Set,V=Math.min(Math.min(p,o),this.#d(t,e,i,p,o,g));if(V>n&&(n=V,l=b,a=f.fromVariables(e)),g.size){let v=this.#h(t,e,i,p,o,g,Math.max(r,n));if(this.#a!==-1)return n;v>n&&(n=v,l=b,a=f.fromVariables(e)),h.apply()}}}return a.apply(),i.assign(l),n}#m(t,e,i,s,o,r){for(e=new Set(e),i=new Set(i);;){if(this._debugOutput(`X1 ${t.size}, X2' ${e.size}, X3' ${i.size}`),this._targetDeg!==null&&this._targetDeg<=this._pro.worstSatisfactionDegree())return this._debugOutput("stop: current degree is above the target"),this.#a=1,o;if(this._iterLimit&&this._iterLimit<this.#n++)return this._debugOutput("stop: number of iterations has reached the limit"),this.#a=0,o;if(this.#o<Date.now())return this._debugOutput("stop: time limit has been reached"),this.#a=0,o;if(i.size===0)return o;let n=i.values().next().value,a=this.#c(t,e,n,s,o,r);if(this.#a!==-1)return o;if(a<r)return this.#r;e.add(n),i.delete(n),o=a}}#f(t,e){let i=new Set;for(let o of t)for(let r of o)i.add(r);let s=1;for(let o of i){let r=o.satisfactionDegree();r!==m.UNDEFINED&&r<s&&(s=r)}for(let o of this._pro.constraints())o.lowestConsistencyDegree()<this.#s&&e.add(o);return s}#b(t,e,i,s){let o=1,r=new Set;for(let n of t){let a=this._pro.constraintsBetween(n,e);for(let l of a)r.add(l)}for(let n of r){let a=n.satisfactionDegree();if(a!==m.UNDEFINED&&(a<o&&(o=a),o<=i||o<=s))return o}return o}#d(t,e,i,s,o,r){let n=1,a=new Set;for(let l of t){let h=this._pro.constraintsBetween(l,i);for(let c of h)a.add(c)}for(let l of e){let h=this._pro.constraintsBetween(l,i);for(let c of h)a.add(c)}for(let l of a){let h=l.satisfactionDegree();h!==m.UNDEFINED&&h<n&&(n=h)}for(let l of a){let h=l.satisfactionDegree();h!==m.UNDEFINED&&(h<s||h<o)&&r.add(l)}return n}exec(){this.#o=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#n=0,this.#a=-1;let t=this._pro.worstSatisfactionDegree();this._pro.emptyVariableSize()===0&&this._pro.clearAllVariables();let e=new Set,i=new Set,s=new Set;for(let b of this._pro.variables())(b.isEmpty()?s:i).add(b);let o=new Set,r=this.#f(i,o),n,a=null;s.size===0?(n=r,a=f.fromVariables(i)):n=this.#r;let l=u.#t(this.#l(i,o),s),h=u.#e(i,l),c=this.#m(e,h,l,this.#s,this.#s,n);return c<n&&a!==null&&a.apply(),c=this._pro.worstSatisfactionDegree(),c>t&&c>0&&(this.#a!==0||this._targetDeg===null)}};var G=class extends d{#t;#e=0;#i=!0;constructor(t){super(t),this.#t=new Array(this._pro.constraintSize()),this.#t.fill(1)}name(){return"Fuzzy Breakout"}#s(t,e){let i=0;for(let s of t){let o=s.value(),r=0;for(let n of s)r+=(1-n.satisfactionDegree())*this.#t[n.index()];t:for(let n of s.domain()){if(o===n)continue;s.assign(n);let a=r;for(let l of s)if(a-=(1-l.satisfactionDegree())*this.#t[l.index()],a<i)continue t;a>i?(i=a,e.clear(),e.addVariable(s,n)):i!==0&&e.addVariable(s,n)}s.assign(o)}}#r(t){let e=new Set;for(let i of t)for(let s of i)e.add(s);return Array.from(e)}exec(){let t=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,e=0;for(let r of this._pro.variables())r.isEmpty()&&r.assign(r.domain().at(0));let i=this._pro.worstSatisfactionDegree(),s=new f,o=new f;for(;;){let[r,n]=this._pro.constraintsWithWorstSatisfactionDegree();if(this._targetDeg!==null&&this._targetDeg<=n)return this._debugOutput("stop: current degree is above the target"),!0;if(this._iterLimit&&this._iterLimit<e++){this._debugOutput("stop: number of iterations has reached the limit");break}if(t<Date.now()){this._debugOutput("stop: time limit has been reached");break}if(this._debugOutput("worst satisfaction degree: "+n),this.#e<n&&(o.setProblem(this._pro),this.#e=n,this.foundSolution(o,this.#e)))return!0;if(this.#s(this.#r(r),s),0<s.size()){let a=this.#i?s.random():s.at(0);a.apply(),s.clear(),this._debugOutput("	"+a)}else{for(let a of r)this.#t[a.index()]+=1;this._debugOutput("breakout")}}return this._targetDeg===null&&i<this._pro.worstSatisfactionDegree()}setRandomness(t){this.#i=t}};var Y=class u extends d{static nextInt(t){return Math.floor(Math.random()*Math.floor(t))}#t=[];#e=[];#i;constructor(t,e=1){super(t),this.#i=e}name(){return"Fuzzy GENET"}#s(t){this._debugOutput("network creation start");let e=[];for(let i of this._pro.variables()){if(i.domain().size()===0)return!1;this.#t.push(new tt(i))}for(let i of this._pro.constraints())if(i.size()===1){let s=i.at(0),o=this.#t[i.at(0).index()];for(let r=0;r<o.size();++r){let n=s.value();s.assign(o.get(r)._value),i.satisfactionDegree()<=t&&e.push(new q(i,o.get(r))),s.assign(n)}}else{let s=i.at(0),o=i.at(1),r=this.#t[i.at(0).index()],n=this.#t[i.at(1).index()];for(let a=0;a<r.size();++a){let l=s.value();s.assign(r.get(a)._value);for(let h=0;h<n.size();++h){let c=o.value();o.assign(n.get(h)._value),i.satisfactionDegree()<=t&&e.push(new q(i,r.get(a),n.get(h))),o.assign(c)}s.assign(l)}}for(let i of this.#t)for(let s of i._neurons)s.lockConnections();return this.#e=e,this._debugOutput("network creation complete"),!0}#r(t){for(let e=t.length;e>1;--e){let i=u.nextInt(e),s=t[e-1];t[e-1]=t[i],t[i]=s}return t}exec(){if(!this.#s(this.#i))throw new Error;let t=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,e=0,i=new f,s=[];for(let n=0;n<this.#t.length;++n)s.push(n);let o=this._pro.worstSatisfactionDegree(),r=!1;for(;;){if(this._iterLimit&&this._iterLimit<e++){this._debugOutput("stop: number of iterations has reached the limit");break}if(t<Date.now()){this._debugOutput("stop: time limit has been reached");break}let n=!1;for(let a of this.#r(s))this.#t[a].setActivityMaximumInput()&&(n=!0);if(n){for(let l of this.#t)l.applyToVariable();let a=this._pro.worstSatisfactionDegree();if(o<a){if(o=a,this._debugOutput(`worst satisfaction degree: ${a}`),i.setProblem(this._pro),this.foundSolution(i,a)){r=!0;break}if(this._targetDeg===null)r=!0;else if(this._targetDeg<=o){this._debugOutput("stop: current degree is above the target"),r=!0;break}}}else{for(let a of this.#e)a.refreshWeight();continue}}return i.apply(),r}},tt=class u{static nextInt(t){return Math.floor(Math.random()*Math.floor(t))}#t;#e=0;#i=[];_neurons=[];constructor(t){this.#t=t;for(let e of t.domain())this._neurons.push(new et(e));this.#s(u.nextInt(this._neurons.length))}#s(t){for(let e of this._neurons)e._isActive=!1;this._neurons[t]._isActive=!0,this.#e=t}applyToVariable(){this.#t.assign(this._neurons[this.#e]._value)}get(t){return this._neurons[t]}neurons(){return this._neurons}setActivityMaximumInput(){this.#i.length=0;let t=Number.NEGATIVE_INFINITY,e=!1;for(let i=0;i<this._neurons.length;++i){let s=this._neurons[i].getInput();t<=s&&(t<s&&(t=s,this.#i.length=0,e=!1),this.#i.push(i),this.#e===i&&(e=!0))}return e||this.#i.length===0?!1:(this.#s(this.#i[u.nextInt(this.#i.length)]),!0)}size(){return this._neurons.length}},q=class{#t;#e;#i;_weight;constructor(t,e,i=null){this._weight=t.satisfactionDegree()-1,this.#t=t,this.#e=e,this.#e.addConnection(this),this.#i=i,this.#i!==null&&this.#i.addConnection(this)}getNeuron(t){return t===this.#e?this.#i:t===this.#i?this.#e:null}refreshWeight(){!this.#e._isActive||this.#i!==null&&!this.#i._isActive||(this.#t.size()===1?this._weight+=this.#t.fuzzyRelation().satisfactionDegree(this.#e._value)-1:this._weight+=this.#t.fuzzyRelation().satisfactionDegree(this.#e._value,this.#i._value)-1)}},et=class{#t=[];#e=[];_value;_isActive=!1;constructor(t){this._value=t}addConnection(t){this.#t.push(t)}lockConnections(){this.#e=[...this.#t],this.#t=null}getInput(){let t=0;for(let e of this.#e){let i=e.getNeuron(this);t+=e._weight*(i===null||i._isActive?1:0)}return t}};var z=class u extends d{static REPAIR_THRESHOLD=0;#t=new Set;#e=new Set;#i=[];#s=[];#r=new Set;#n=0;#o=0;#a=!0;constructor(t){super(t);for(let e of this._pro.constraints())this.#i.push(new it(e)),this.#s.push(null)}name(){return"SRS 3"}#l(t){let e=t.index();return this.#s[e]===null&&(this.#s[e]=t.neighbors()),this.#s[e]}#u(t){this._debugOutput("repair");let e=new f,i=t.satisfactionDegree(),s=this._pro.worstSatisfactionDegree(),o=t.satisfactionDegree();for(let r of t){let n=r.value();t:for(let a of r.domain()){if(n===a)continue;r.assign(a);let l=t.satisfactionDegree();if(!(i>l||o-l>u.REPAIR_THRESHOLD)){for(let h of r){if(h===t)continue;let c=h.satisfactionDegree();if(c!==m.UNDEFINED&&c<s)continue t}l>o&&(o=l,e.clear()),e.addVariable(r,a)}}r.assign(n)}if(e.size()>0){let r=this.#a?e.random():e.at(0);return r.apply(),this._debugOutput("	"+r),!0}return!1}#h(t){this._debugOutput("shrink");let e=!1;for(;;){if(t=t.parent(),this.#r.delete(t)){e=!0;break}if(!this.#u(t.parent().getObject()))break}let i=[];t.getDescendants(i);for(let s of i)s.clear(),this.#e.delete(s),this.#t.delete(s);e||this.#e.add(t)}#c(t){this._debugOutput("spread"),this.#t.add(t);for(let e of this.#l(t.getObject())){let i=this.#i[e.index()];!this.#t.has(i)&&!this.#e.has(i)&&(t.add(i),this.#e.add(i))}}#m(){this._debugOutput("srs");let[t]=this._pro.constraintsWithWorstSatisfactionDegree();for(let e of t){let i=this.#i[e.index()];i.setParent(null),this.#r.add(i)}this.#t.clear(),this.#e.clear();for(let e of this.#r)this.#e.add(e);for(;this.#r.size&&this.#e.size;){if(this._iterLimit&&this._iterLimit<this.#n++)return this._debugOutput("stop: number of iterations has reached the limit"),!1;if(this.#o<Date.now())return this._debugOutput("stop: time limit has been reached"),!1;let e=this.#e.values().next().value;if(this.#e.delete(e),this.#u(e.getObject())){if(this.#r.delete(e))continue;if(this.#u(e.parent().getObject())){this.#h(e);continue}}this.#c(e)}return!0}exec(){if(this.#o=this._timeLimit===null?Number.MAX_VALUE:Date.now()+this._timeLimit,this.#n=0,this._targetDeg&&this._targetDeg<=this._pro.worstSatisfactionDegree())return!0;let t=new f,e=!1;for(;!(!this.#m()||this.#r.size);){let s=this._pro.worstSatisfactionDegree();if(this._debugOutput(`	found a solution: ${s}	${this._targetDeg}`),t.setProblem(this._pro),this.foundSolution(t,s)){e=!0;break}if(this._targetDeg===null)e=!0;else if(this._targetDeg<=s){this._debugOutput("stop: current degree is above the target"),e=!0;break}}return e}setRandomness(t){this.#a=t}},it=class{#t=[];#e;#i;constructor(t){this.#e=null,this.#i=t}add(t){t.#e=this,this.#t.push(t)}clear(){for(let t of this.#t)t.#e=null;this.#t.length=0}getDescendants(t){t.push(this);for(let e of this.#t)e.getDescendants(t)}getObject(){return this.#i}parent(){return this.#e}setParent(t){this.#e=t}};var J=class{static apply(t,e){console.log("start post-stabilization");let i,s=0;do{console.log("post-stabilization: count "+s++),i=!1;let o=t.worstSatisfactionDegree(),r=t.variables();for(let n=0;n<r.length;++n){let a=r[n],l=a.value(),h=e.at(n);l!==h.value()&&(h.apply(),t.worstSatisfactionDegree()>=o?i=!0:a.assign(l))}}while(i);return console.log("finish post-stabilization"),!0}};var K=class extends z{constructor(t){super(t)}name(){return"SRS 3 + PF"}exec(){let t=0,e=0;this._debug&&(t=this._pro.worstSatisfactionDegree(),e=this._pro.emptyVariableSize());let i=new f;i.setProblem(this._pro);let s=super.exec();return s&&J.apply(this._pro,i),this._debugOutput(`result: ${s?"success":"failure"}`),this._debugOutput(`satisfaction degree: ${t} -> ${this._pro.worstSatisfactionDegree()}`),this._debugOutput(`unassigned size: ${e} -> ${this._pro.emptyVariableSize()}`),s}};var mt=class u{static crispSolverNames(){return["Forward Checking","Max Forward Checking","Local Changes","Local Changes Ex","Breakout","GENET","Crisp SRS 3"]}static fuzzySolverNames(){return["Fuzzy Forward Checking","Fuzzy Forward Checking Bc","Flexible Local Changes","Flexible Local Changes Ex","Fuzzy Breakout","Fuzzy GENET","SRS 3","SRS 3 PF"]}static async createSolver(t,e){let i=await u.createCrispSolver(t,e);if(i)return i;let s=await u.createFuzzySolver(t,e);return s||null}static async createCrispSolver(t,e){switch(t.replaceAll(" ","")){case"ForwardChecking":case"forward-checking":return new k(e);case"MaxForwardChecking":case"max-forward-checking":return new R(e);case"LocalChanges":case"local-changes":return new P(e);case"LocalChangesEx":case"local-changes-ex":return new I(e);case"Breakout":case"breakout":return new F(e);case"GENET":case"genet":return new M(e);case"CrispSRS3":case"crisp-srs3":return new U(e)}return null}static async createFuzzySolver(t,e){switch(t.replaceAll(" ","")){case"FuzzyForwardChecking":case"fuzzy-forward-checking":return new $(e);case"FuzzyForwardCheckingBc":case"fuzzy-forward-checking-bc":return new H(e);case"FlexibleLocalChanges":case"flexible-local-changes":return new B(e);case"FlexibleLocalChangesEx":case"flexible-local-changes-ex":return new W(e);case"FuzzyBreakout":case"fuzzy-breakout":return new G(e);case"FuzzyGENET":case"fuzzy-genet":return new Y(e);case"SRS3":case"srs3":return new z(e);case"SRS3PF":case"SRS3_PF":case"srs3-pf":return new K(e)}return null}};var bt=class u{static#t(t,e){for(let i of e.domain())if(e.assign(i),t.isSatisfied()===1)return!0;return!1}static#e(t,e,i){let s=e.value(),o=i.value(),r=e.domain(),n=[],a=t.constraintsBetween(e,i);t:for(let l of r){e.assign(l);for(let h of a)if(h.size()===2&&!u.#t(h,i))continue t;n.push(l)}if(e.assign(s),i.assign(o),n.length!==r.size()){let l=t.createDomain({values:n});return e.setDomain(l),console.log(r.size()+" -> "+l.size()),!0}return!1}static apply(t){let e=[];for(let i of t.constraints())i.size()===2&&e.push(i);for(;e.length;){let i=e.pop(),s=i.at(0),o=i.at(1);if(u.#e(t,s,o))for(let r of t.constraints())r.size()===2&&r.at(1)===s&&r.at(0)!==o&&e.unshift(r)}}};var dt=class{static applyToProblem(t,e){for(let i of t.variables()){let s=i.domain(),o=i.value(),r=[];for(let n of i)if(n.size()===1){for(let a of s)i.assign(a),n.satisfactionDegree()>=e&&r.push(a);t.removeConstraint(n)}if(i.assign(o),r.length===0)return!1;i.setDomain(t.createDomain({values:r}))}return!0}static applyToCrispProblem(t){for(let e of t.variables()){let i=e.domain(),s=e.value(),o=[];for(let r of e)if(r.size()===1){for(let n of i)e.assign(n),r.isSatisfied()===1&&o.push(n);t.removeConstraint(r)}if(e.assign(s),o.length===0)return!1;e.setDomain(t.createDomain({values:o}))}return!0}};var pt=class u{static#t(t,e,i,s,o){let r=[];for(let n of e)for(let a of n)i[a.index()]===Number.MAX_VALUE&&(r.push(a),i[a.index()]=s+1);for(let n of r)o.add(n);for(let n of r)u.#t(t,n,i,s+1,o)}static averagePathLength(t,e){let i=new Array(t.variableSize());i.fill(Number.MAX_VALUE);let s=new Set;s.add(e),i[e.index()]=0,u.#t(t,e,i,0,s);let o=0,r=0;for(let n=0;n<i.length;++n)i[n]!==Number.MAX_VALUE&&n!==e.index()&&(++o,r+=i[n]);return o===0?0:r/o}static averagePathLengths(t){let e=new Array(t.variableSize());for(let i of t.variables())e[i.index()]=u.averagePathLength(t,i);return e}static domains(t){let e=[];for(let i of t.variables())e.push(i.domain());return e}static possibleSatisfactionDegreesOfUnaryConstraints(t,e){for(let i of t.constraints()){if(i.size()!==1)continue;let s=i.at(0),o=s.value();for(let r of s.domain())s.assign(r),e.push(i.satisfactionDegree());s.assign(o)}return e}static setDomains(t,e){for(let i=0;i<e.length;++i)t.variableAt(i).setDomain(e[i])}static toViewAsCrispProblem(t,e){let i=new st;for(let s of t.variables())i.createVariable({variable:s});for(let s of t.constraints()){let o=[];for(let n of s)o.push(i.variableAt(n.index()));let r;s.isFuzzy()?r=new rt(s.fuzzyRelation(),e):r=s.crispRelation(),i.createConstraint({relation:r,variables:o})}return i}},st=class extends O{createVariable(t){let e=new nt(t.variable);return this.addVariable(e),e}},rt=class{#t;#e;constructor(t,e){this.#e=t,this.#t=e}isSatisfied(...t){return this.#e.satisfactionDegree(...t)>=this.#t?1:0}},nt=class extends S{#t;constructor(t){super(t.owner(),t.domain()),this.#t=t,this.setName(t.name()),this.assign(t.value())}assign(t){this.#t.assign(t)}domain(){return this.#t.domain()}setDomain(t){this.#t.setDomain(t)}value(){return this.#t.value()}};var gt=class{#t=[];#e=[];#i;#s;#r=0;constructor(t=30,e=3){this.#i=t,this.#s=e,this.#a()}#n(t,e){this.#t[this.#r]=t,this.#e[this.#r]=e,--this.#r===-1&&(this.#r=this.#t.length-1)}#o(){let t=new Array(this.#i),e=new Array(this.#i);t:for(let i=1;i<=this.#i;++i){let s=this.#r+1;for(let r=0;r<i;++r)r+s===this.#t.length&&(s-=this.#t.length),t[r]=this.#t[r+s],e[r]=this.#e[r+s];let o=i;for(let r=0;r<this.#s-1;++r){s=this.#r+1;for(let n=0;n<i;++n)if(o+n+s>=this.#t.length&&(s-=this.#t.length),this.#t[o+n+s]!==t[n]||this.#e[o+n+s]!==e[n])continue t;o+=i}return i}return 0}#a(){this.#t=new Array(this.#i*this.#s),this.#e=new Array(this.#i*this.#s),this.#t.fill(-1),this.#e.fill(-1),this.#r=this.#t.length-1}checkLoop(t,e){return this.#n(t,e),this.#o()}clear(){this.#t.fill(-1),this.#e.fill(-1)}iterationCount(){return this.#s}loopLength(){return this.#i}values(){return this.#e.slice()}variableIndices(){return this.#t.slice()}};export{bt as AC3,D as Assignment,f as AssignmentList,F as Breakout,m as Constraint,x as Constraint1,N as Constraint2,T as Constraint3,L as ConstraintN,O as CrispProblem,ht as CrispRelationFunction,ct as CrispRelationView,U as CrispSRS3,ut as CrispTabledRelation,y as Domain,E as DomainArbitrary,_ as DomainPruner,C as DomainRanged,w as Element,B as FlexibleLocalChanges,W as FlexibleLocalChangesEx,k as ForwardChecking,G as FuzzyBreakout,$ as FuzzyForwardChecking,H as FuzzyForwardCheckingBc,Y as FuzzyGENET,lt as FuzzyRelationFunction,ft as FuzzyRelationView,at as FuzzyTabledRelation,M as GENET,P as LocalChanges,I as LocalChangesEx,gt as LoopDetector,R as MaxForwardChecking,dt as NodeConsistency,ot as ObservableVariable,J as PostStabilization,A as Problem,pt as Problems,z as SRS3,K as SRS3_PF,d as Solver,mt as SolverFactory,S as Variable};
//# sourceMappingURL=stlics.min.js.map

var b=i=>{throw TypeError(i)};var g=(i,e,t)=>e.has(i)||b("Cannot "+t);var u=(i,e,t)=>(g(i,e,"read from private field"),t?t.call(i):e.get(i)),m=(i,e,t)=>e.has(i)?b("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),x=(i,e,t,o)=>(g(i,e,"write to private field"),o?o.call(i,t):e.set(i,t),t),p=(i,e,t)=>(g(i,e,"access private method"),t);import{S as A,A as w}from"./assignment-list-DmhfKDOP.js";import"./worker-WSPT47b9.js";var c,a,f,S,k,y;class B extends A{constructor(){super();m(this,f);m(this,c,!0);m(this,a)}setRandomness(t){x(this,c,t)}name(){return"Breakout"}preprocess(){x(this,a,new Array(this.pro.constraintSize())),u(this,a).fill(1);for(const t of this.pro.variables())t.isEmpty()&&t.assign(t.domain().at(0));this.monitor.initialize()}exec(){const t=this.pro.ratio(),o=new w;let s=t;const r=new w;let l=null;for(;;){const h=this.pro.violatingConstraints(),n=this.pro.ratio();if(this.monitor.outputDebugString(`Evaluation: ${n}`),s<n&&(o.setProblem(this.pro),s=n,this.monitor.solutionFound(o,s)))return!0;if((l=this.monitor.check(n))!==null)break;p(this,f,S).call(this,h,r)}return l===!1&&!this.monitor.isTargetAssigned()&&t<s&&(o.apply(),l=!0),l}}c=new WeakMap,a=new WeakMap,f=new WeakSet,S=function(t,o){if(p(this,f,k).call(this,p(this,f,y).call(this,t),o),0<o.size()){const s=u(this,c)?o.random():o.at(0);s.apply(),o.clear(),this.monitor.outputDebugString("	"+s)}else{for(const s of t)u(this,a)[s.index()]+=1;this.monitor.outputDebugString("Breakout")}},k=function(t,o){let s=0;for(const r of t){const l=r.value();let h=0;for(const n of r)h+=(1-n.status())*u(this,a)[n.index()];t:for(const n of r.domain()){if(l===n)continue;r.assign(n);let d=h;for(const v of r)if(d-=(1-v.status())*u(this,a)[v.index()],d<s)continue t;s<d?(s=d,o.clear(),o.addVariable(r,n)):s!==0&&o.addVariable(r,n)}r.assign(l)}},y=function(t){const o=new Set;for(const s of t)for(const r of s)o.add(r);return Array.from(o)};export{B as Breakout};

var C=r=>{throw TypeError(r)};var w=(r,e,t)=>e.has(r)||C("Cannot "+t);var i=(r,e,t)=>(w(r,e,"read from private field"),t?t.call(r):e.get(r)),m=(r,e,t)=>e.has(r)?C("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),l=(r,e,t,s)=>(w(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t),d=(r,e,t)=>(w(r,e,"access private method"),t);import{S as R,A as V}from"./assignment-list-N3wsQUdu.js";import{c as D,D as E,i as _}from"./problems-NShnYMbn.js";import"./worker-CSQVwver.js";var u,b,f,x,p,k,a,z,S,A,F,M;class T extends R{constructor(){super();m(this,a);m(this,u);m(this,b);m(this,f);m(this,x);m(this,p);m(this,k,!0)}setUsingMinimumRemainingValuesHeuristics(t){l(this,k,t)}name(){return"Max Forward Checking"}preprocess(){l(this,u,[...this.pro.variables()]),l(this,b,D(this.pro,i(this,u))),l(this,f,Array.from(i(this,u),t=>new E(t.domain().size()))),l(this,x,new V),l(this,p,this.pro.constraintSize()),this.pro.clearAllVariables(),this.monitor.initialize()}exec(){const t=d(this,a,z).call(this,0);return i(this,x).apply(),t===!0}}u=new WeakMap,b=new WeakMap,f=new WeakMap,x=new WeakMap,p=new WeakMap,k=new WeakMap,a=new WeakSet,z=function(t,s=0){if(t===this.pro.variableSize()){const o=this.pro.ratio();return i(this,x).setProblem(this.pro),this.monitor.outputDebugString(`	Evaluation ${o}`),s<i(this,p)&&(l(this,p,s),this.monitor.solutionFound(i(this,x),o))?!0:this.monitor.check(o)}let n=null;if((n=this.monitor.check())!==null)return n;const h=i(this,u)[i(this,k)?_(i(this,u),i(this,f)):t],g=h.domain(),c=i(this,f)[h.index()];for(let o=0,v=g.size();o<v;++o){if(c.isPruned(o))continue;h.assign(g.at(o));const y=s+d(this,a,M).call(this,h);if(!(i(this,p)<=y)){if((s+1<i(this,p)||d(this,a,S).call(this,t,h))&&(n=d(this,a,z).call(this,t+1,y),n!==null))break;for(const P of i(this,f))P.recover(t)}}if(n===null){for(const o of i(this,f))o.recover(t);h.clear()}return n},S=function(t,s){for(const n of i(this,u)){if(!n.isEmpty())continue;const h=d(this,a,A).call(this,s.index(),n.index()),g=i(this,f)[n.index()],c=n.domain();for(const o of h)if(o.emptySize()===1&&!d(this,a,F).call(this,t,n,c,g,o))return!1}return!0},A=function(t,s){return t<s?i(this,b)[s][t]:i(this,b)[t][s]},F=function(t,s,n,h,g){for(let c=0,o=n.size();c<o;++c)h.isPruned(c)||(s.assign(n.at(c)),g.status()===0&&h.prune(c,t));return s.clear(),!h.isEmpty()},M=function(t){let s=0;for(const n of t)n.status()===0&&++s;return s};export{T as MaxForwardChecking};

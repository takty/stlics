var bt=Object.defineProperty;var ut=r=>{throw TypeError(r)};var yt=(r,e,t)=>e in r?bt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Q=(r,e,t)=>yt(r,typeof e!="symbol"?e+"":e,t),it=(r,e,t)=>e.has(r)||ut("Cannot "+t);var s=(r,e,t)=>(it(r,e,"read from private field"),t?t.call(r):e.get(r)),o=(r,e,t)=>e.has(r)?ut("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),a=(r,e,t,i)=>(it(r,e,"write to private field"),i?i.call(r,t):e.set(r,t),t),lt=(r,e,t)=>(it(r,e,"access private method"),t);var rt=(r,e,t,i)=>({set _(n){a(r,e,n,t)},get _(){return s(r,e,i)}});var I,B;class mt{constructor(){o(this,I,-1);o(this,B,"");Q(this,"userObject",null)}setIndex(e){a(this,I,e)}setName(e){a(this,B,e)}index(){return s(this,I)}name(){return s(this,B)}}I=new WeakMap,B=new WeakMap;var k,G,N,_,p;const D=class D extends mt{constructor(t,i){super();o(this,G);o(this,N);o(this,_,s(D,k));o(this,p,[]);a(this,G,t),a(this,N,i)}toString(){const t=this.name(),i=t?`(${t})`:"",n=this.isEmpty()?"<empty>":""+this.value();return`x${this.index()}${i} = ${n}`}size(){return s(this,p).length}at(t){return s(this,p).at(t)}has(t){return s(this,p).includes(t)}indexOf(t){return s(this,p).indexOf(t)}neighbors(){const t=[];for(const i of s(this,p))for(const n of i)n!==this&&t.push(n);return t}[Symbol.iterator](){return s(this,p)[Symbol.iterator]()}owner(){return s(this,G)}connect(t){if(s(this,p).includes(t))throw new RangeError;s(this,p).push(t)}disconnect(t){if(!s(this,p).includes(t))throw new RangeError;a(this,p,s(this,p).filter(i=>i!==t))}domain(t){if(t===void 0)return s(this,N);a(this,N,t),this.clear()}assign(t){a(this,_,t)}clear(){this.assign(s(D,k))}value(){return s(this,_)}isEmpty(){return this.value()===s(D,k)}};k=new WeakMap,G=new WeakMap,N=new WeakMap,_=new WeakMap,p=new WeakMap,o(D,k,Number.MIN_VALUE);let at=D;class Y{static createRangedDomain(e,t){return new St(e,t)}static createArbitraryDomain(e){return new wt(e)}random(){return this.at(Math.floor(Math.random()*this.size()))}}var S;class wt extends Y{constructor(t){super();o(this,S);a(this,S,[...t])}contains(t){return s(this,S).includes(t)}indexOf(t){return s(this,S).indexOf(t)}size(){return s(this,S).length}at(t){return s(this,S)[t]}[Symbol.iterator](){return s(this,S)[Symbol.iterator]()}}S=new WeakMap;var w,E;class St extends Y{constructor(t,i){super();o(this,w);o(this,E);a(this,w,t|0),a(this,E,i|0)}contains(t){return s(this,w)<=t&&t<=s(this,E)}indexOf(t){return s(this,w)<=t&&t<=s(this,E)?t-s(this,w):-1}size(){return s(this,E)-s(this,w)+1}at(t){return s(this,w)+t}[Symbol.iterator](){let t=s(this,w);const i=s(this,E);return{next(){return t<=i?{value:t++,done:!1}:{value:null,done:!0}}}}}w=new WeakMap,E=new WeakMap;class xt{}class dt extends xt{isSatisfied(...e){const t=this.degree(...e);return 0<t&&t<1?0:t}}class K extends mt{constructor(t){super();Q(this,"rel");this.rel=t}static create(t,i){return i.length===1?new Et(t,i[0]):i.length===2?new zt(t,i[0],i[1]):i.length===3?new vt(t,i[0],i[1],i[2]):new Ct(t,...i)}relation(){return this.rel}isFuzzy(){return this.rel instanceof dt}toString(){const t=this.name(),i=t?`(${t})`:"",n=this.degree(),u=n<0?"UNDEFINED":""+n;return`c${this.index()}${i} = ${u}`}}var g;class Et extends K{constructor(t,i){super(t);o(this,g,[]);a(this,g,[i])}size(){return 1}at(t){return s(this,g).at(t)}has(t){return t===s(this,g)[0]}indexOf(t){return t===s(this,g)[0]?0:-1}neighbors(){const t=[];for(const i of s(this,g)[0])i!==this&&t.push(i);return t}[Symbol.iterator](){return s(this,g)[Symbol.iterator]()}emptyVariableSize(){return s(this,g)[0].isEmpty()?1:0}isDefined(){return!s(this,g)[0].isEmpty()}isSatisfied(){return s(this,g)[0].isEmpty()?-1:this.rel.isSatisfied(s(this,g)[0].value())?1:0}degree(){return s(this,g)[0].isEmpty()?-1:this.rel.degree(s(this,g)[0].value())}}g=new WeakMap;var c;class zt extends K{constructor(t,i,n){super(t);o(this,c,[]);a(this,c,[i,n])}size(){return 2}at(t){return s(this,c).at(t)}has(t){return s(this,c)[0]===t||s(this,c)[1]===t}indexOf(t){return t===s(this,c)[0]?0:t===s(this,c)[1]?1:-1}neighbors(){const t=[];for(const i of s(this,c))for(const n of i)n!==this&&t.push(n);return t}[Symbol.iterator](){return s(this,c)[Symbol.iterator]()}emptyVariableSize(){let t=0;return s(this,c)[0].isEmpty()&&++t,s(this,c)[1].isEmpty()&&++t,t}isDefined(){return!s(this,c)[0].isEmpty()&&!s(this,c)[1].isEmpty()}isSatisfied(){return s(this,c)[0].isEmpty()||s(this,c)[1].isEmpty()?-1:this.rel.isSatisfied(s(this,c)[0].value(),s(this,c)[1].value())?1:0}degree(){return s(this,c)[0].isEmpty()||s(this,c)[1].isEmpty()?-1:this.rel.degree(s(this,c)[0].value(),s(this,c)[1].value())}}c=new WeakMap;var h;class vt extends K{constructor(t,i,n,u){super(t);o(this,h,[]);a(this,h,[i,n,u])}size(){return 3}at(t){return s(this,h).at(t)}has(t){return s(this,h)[0]===t||s(this,h)[1]===t||s(this,h)[2]===t}indexOf(t){return t===s(this,h)[0]?0:t===s(this,h)[1]?1:t===s(this,h)[2]?2:-1}neighbors(){const t=[];for(const i of s(this,h))for(const n of i)n!==this&&t.push(n);return t}[Symbol.iterator](){return s(this,h)[Symbol.iterator]()}emptyVariableSize(){let t=0;return s(this,h)[0].isEmpty()&&++t,s(this,h)[1].isEmpty()&&++t,s(this,h)[2].isEmpty()&&++t,t}isDefined(){return!s(this,h)[0].isEmpty()&&!s(this,h)[1].isEmpty()&&!s(this,h)[2].isEmpty()}isSatisfied(){return s(this,h)[0].isEmpty()||s(this,h)[1].isEmpty()||s(this,h)[2].isEmpty()?-1:this.rel.isSatisfied(s(this,h)[0].value(),s(this,h)[1].value(),s(this,h)[2].value())?1:0}degree(){return s(this,h)[0].isEmpty()||s(this,h)[1].isEmpty()||s(this,h)[2].isEmpty()?-1:this.rel.degree(s(this,h)[0].value(),s(this,h)[1].value(),s(this,h)[2].value())}}h=new WeakMap;var m,z;class Ct extends K{constructor(t,...i){super(t);o(this,m);o(this,z);a(this,m,[...i]),a(this,z,new Array(s(this,m).length))}size(){return s(this,m).length}at(t){return s(this,m).at(t)}has(t){return s(this,m).includes(t)}indexOf(t){return s(this,m).indexOf(t)}neighbors(){const t=[];for(const i of s(this,m))for(const n of i)n!==this&&t.push(n);return t}[Symbol.iterator](){return s(this,m)[Symbol.iterator]()}emptyVariableSize(){let t=0;for(const i of s(this,m))t+=i.isEmpty()?1:0;return t}isDefined(){for(const t of s(this,m))if(t.isEmpty())return!1;return!0}isSatisfied(){for(let t=0;t<s(this,m).length;++t){const i=s(this,m)[t];if(i.isEmpty())return-1;s(this,z)[t]=i.value()}return this.rel.isSatisfied(...s(this,z))?1:0}degree(){for(let t=0;t<s(this,m).length;++t){const i=s(this,m)[t];if(i.isEmpty())return-1;s(this,z)[t]=i.value()}return this.rel.degree(...s(this,z))}}m=new WeakMap,z=new WeakMap;var A,$,F,f,l;class Ft{constructor(){o(this,A,(e,t)=>new at(e,t));o(this,$,(e,t)=>K.create(e,t));o(this,F,!1);o(this,f,[]);o(this,l,[])}setVariableFactory(e){a(this,A,e)}setConstraintFactory(e){a(this,$,e)}addVariable(e){e.setIndex(s(this,f).length),s(this,f).push(e)}createDomain(e){return"values"in e?Y.createArbitraryDomain(e.values):"min"in e&&"max"in e?Y.createRangedDomain(e.min,e.max):null}createVariable(e){if("variable"in e){const t=s(this,A).call(this,this,e.variable.domain());return this.addVariable(t),t.setName(t.name()),t.assign(t.value()),t}else{if(e.value!==void 0&&!e.domain.contains(e.value))throw new Error;const t=s(this,A).call(this,this,e.domain);return this.addVariable(t),e.name&&t.setName(e.name),e.value&&t.assign(e.value),t}}createConstraint(e){for(const i of e.variables)if(i.owner()!==this)return null;const t=s(this,$).call(this,e.relation,e.variables);t.setIndex(s(this,l).length),s(this,l).push(t);for(const i of e.variables)i.connect(t);return t.isFuzzy()&&a(this,F,!0),"name"in e&&t.setName(e.name),t}removeConstraint(e){const t=s(this,l).indexOf(e);s(this,l).splice(t,1);for(let i=t;i<s(this,l).length;++i)s(this,l)[i].setIndex(i);for(const i of e)i.disconnect(e);a(this,F,!1);for(const i of s(this,l))if(i.isFuzzy()){a(this,F,!0);break}}clearAllVariables(){for(const e of s(this,f))e.clear()}reverseVariables(){s(this,f).reverse();for(let e=0;e<s(this,f).length;++e)s(this,f)[e].setIndex(e)}sortVariables(e){s(this,f).sort(e);for(let t=0;t<s(this,f).length;++t)s(this,f)[t].setIndex(t)}variables(){return s(this,f)}variableSize(){return s(this,f).length}variableAt(e){return s(this,f)[e]}variableOf(e){for(const t of s(this,f))if(t.name()===e)return t;return null}hasVariable(e){return s(this,f).includes(e)}constraints(){return s(this,l)}constraintSize(){return s(this,l).length}constraintAt(e){return s(this,l)[e]}constraintOf(e){for(const t of s(this,l))if(t.name()===e)return t;return null}hasConstraint(e){return s(this,l).includes(e)}constraintsBetween(e,t){const i=[];for(const n of e)n.has(t)&&i.push(n);return i}isFuzzy(){return s(this,F)}constraintDensity(){return s(this,l).length/s(this,f).length}emptyVariableSize(){let e=0;for(const t of s(this,f))e+=t.isEmpty()?1:0;return e}hasEmptyDomain(){for(const e of s(this,f))if(e.domain().size()===0)return!0;return!1}degree(){let e=1;for(const t of s(this,l)){const i=t.degree();if(i<0)return i;i<e&&(e=i)}return e}constraintsWithDegree(){const e=[];let t=1;for(const i of s(this,l)){const n=i.degree();n<t?(t=n,e.length=0,e.push(i)):n-t<Number.MIN_VALUE*10&&e.push(i)}return[e,t]}averageDegree(){let e=0;for(const t of s(this,l))e+=t.degree();return e/s(this,l).length}ratio(){return this.satisfiedConstraintSize()/s(this,l).length}satisfiedConstraintSize(){let e=0;for(const t of s(this,l))e+=t.isSatisfied()===1?1:0;return e}violatingConstraintSize(){return s(this,l).length-this.satisfiedConstraintSize()}satisfiedConstraints(){const e=[];for(const t of s(this,l))t.isSatisfied()===1&&e.push(t);return e}violatingConstraints(){const e=[];for(const t of s(this,l))t.isSatisfied()===0&&e.push(t);return e}}A=new WeakMap,$=new WeakMap,F=new WeakMap,f=new WeakMap,l=new WeakMap;var L,P,U,X,R,v,O,j,q,W,H;class Mt{constructor(){o(this,L,!0);o(this,P,e=>console.log(e));o(this,U,()=>!1);o(this,X,Number.MAX_SAFE_INTEGER);o(this,R,null);o(this,v,.8);o(this,O,null);o(this,j,0);o(this,q,0);o(this,W,-1);o(this,H,0)}initialize(){a(this,j,s(this,R)===null?Number.MAX_VALUE:Date.now()+s(this,R)),a(this,q,0)}check(e=null){if(e!==null&&s(this,v)!==null&&s(this,v)<=e)return this.outputDebugString("Stop: Current evaluation value is above the target"),!0;if(s(this,X)<rt(this,q)._++)return this.outputDebugString("Stop: Number of iterations has reached the limit"),!1;if(s(this,j)<Date.now())return this.outputDebugString("Stop: Time limit has been reached"),!1;if(e!==null&&s(this,O)!==null)if(e!==-1&&s(this,W)===e){if(s(this,O)<rt(this,H)._++)return this.outputDebugString("Stop: Evaluation value has not changed for a certain number of times"),!1}else a(this,W,e),a(this,H,0);return null}solutionFound(e,t){return s(this,U).call(this,e,t)}outputDebugString(e){s(this,L)&&s(this,P).call(this,e)}isDebugMode(){return s(this,L)}isTargetAssigned(){return s(this,v)!==null}getTarget(){return s(this,v)}setIterationLimit(e=null){a(this,X,e===null?Number.MAX_SAFE_INTEGER:e)}setTimeLimit(e=null){a(this,R,e)}setTarget(e=null){a(this,v,e)}setSameEvaluationLimit(e=null){a(this,O,e)}setListener(e){a(this,U,e)}setDebugMode(e){a(this,L,e)}setDebugOutput(e){a(this,P,e)}}L=new WeakMap,P=new WeakMap,U=new WeakMap,X=new WeakMap,R=new WeakMap,v=new WeakMap,O=new WeakMap,j=new WeakMap,q=new WeakMap,W=new WeakMap,H=new WeakMap;class V{static crispSolverNames(){return["Forward Checking","Max Forward Checking","Local Changes","Local Changes Ex","Breakout","GENET","Crisp SRS3"]}static fuzzySolverNames(){return["Full Checking","Fuzzy Forward Checking","Flexible Local Changes","Flexible Local Changes Ex","Fuzzy Breakout","Fuzzy GENET","SRS3","SRS3 PF"]}static async createSolver(e){const t=await V.createCrispSolver(e);if(t)return t;const i=await V.createFuzzySolver(e);return i||null}static async createCrispSolver(e){switch(e.replaceAll(" ","")){case"ForwardChecking":case"forward-checking":const{ForwardChecking:t}=await import("./forward-checking-CBr_eVRf.js");return new t;case"MaxForwardChecking":case"max-forward-checking":const{MaxForwardChecking:i}=await import("./max-forward-checking-C37kxL0r.js");return new i;case"LocalChanges":case"local-changes":const{LocalChanges:n}=await import("./local-changes-BvjbUka_.js");return new n;case"LocalChangesEx":case"local-changes-ex":const{LocalChangesEx:u}=await import("./local-changes-ex-CMJsYXKk.js");return new u;case"Breakout":case"breakout":const{Breakout:d}=await import("./breakout-Bs9RQdqd.js");return new d;case"GENET":case"genet":const{GENET:C}=await import("./genet-K21bMA6n.js");return new C;case"CrispSRS3":case"crisp-srs3":const{CrispSRS3:T}=await import("./crisp-srs3-djo2_PK0.js");return new T}return null}static async createFuzzySolver(e){switch(e.replaceAll(" ","")){case"FullChecking":case"full-checking":const{FullChecking:t}=await import("./full-checking-CmW0mpKV.js");return new t;case"FuzzyForwardChecking":case"fuzzy-forward-checking":const{FuzzyForwardChecking:i}=await import("./fuzzy-forward-checking-BUS1jBMg.js");return new i;case"FlexibleLocalChanges":case"flexible-local-changes":const{FlexibleLocalChanges:n}=await import("./flexible-local-changes-LNt2g9Zz.js");return new n;case"FlexibleLocalChangesEx":case"flexible-local-changes-ex":const{FlexibleLocalChangesEx:u}=await import("./flexible-local-changes-ex-_vy1HTv9.js");return new u;case"FuzzyBreakout":case"fuzzy-breakout":const{FuzzyBreakout:d}=await import("./fuzzy-breakout-Dae4yjT4.js");return new d;case"FuzzyGENET":case"fuzzy-genet":const{FuzzyGENET:C}=await import("./fuzzy-genet-CUiAQ8QY.js");return new C;case"SRS3":case"srs3":const{SRS3:T}=await import("./srs3-Cy-pPNPn.js");return new T;case"SRS3PF":case"SRS3_PF":case"srs3-pf":{const{SRS3:et}=await import("./srs3-Cy-pPNPn.js"),{wrapWithPostStabilizer:st}=await import("./post-stabilizer-BGTxKLBw.js");return st(new et)}}return null}}function Dt(r,e){const t=ct(r);return t/(t+ct(e))}function ct(r){let e,t,i,n,u;if(1<r){e=Math.sqrt(2*r-1);do do{do{do t=Math.random(),i=2*Math.random()-1;while(1<=t*t+i*i||t===0);i=i/t,t=e*i+r-1}while(t<=0);n=(r-1)*Math.log(t/(r-1))-e*i}while(n<=-50);while((1+i*i)*Math.exp(n)<=Math.random())}else{e=Math.E/(r+Math.E);do Math.random()<e?(t=0,i=1,u=Math.random(),0<u&&(t=Math.exp(Math.log(u)/r),i=Math.exp(-t))):(u=Math.random(),t=1,i=0,0<u&&(t=1-Math.log(u),i=Math.exp((r-1)*Math.log(t))));while(Math.random()>=i)}return t}var Z;class kt{constructor(){Q(this,"_debug",!0);o(this,Z,e=>console.log(e))}setDebugMode(e){this._debug=e}setDebugOutput(e){this._debugOutput=e}_debugOutput(e){this._debug&&s(this,Z).call(this,e)}}Z=new WeakMap;var b,M,x,y,tt,gt;class Nt extends kt{constructor(t,i,n,u=null){super();o(this,tt);o(this,b);o(this,M);o(this,x);o(this,y);a(this,b,t),a(this,M,i),a(this,x,n),a(this,y,u??t)}getVariableCount(){return s(this,b)}setVariableCount(t){a(this,b,t)}getDensity(){return s(this,M)}setDensity(t){a(this,M,t)}getAverageTightness(){return s(this,x)}setAverageTightness(t){a(this,x,t)}getDomainSize(){return s(this,y)}setDomainSize(t){a(this,y,t)}isFuzzy(){return!0}createProblem(t){const i=s(this,M)*((s(this,b)*s(this,b)-s(this,b))/2)|0,n=[];for(let u=0;u<s(this,b);++u){const d=t.createVariable({domain:t.createDomain({min:0,max:s(this,y)-1}),value:0,name:""});n.push(d)}for(;t.constraintSize()<i;){const u=ft(s(this,b)),d=ft(s(this,b));u!==d&&t.constraintsBetween(n[u],n[d]).length===0&&t.createConstraint({relation:new At(lt(this,tt,gt).call(this)),variables:[n[u],n[d]]})}return t}}b=new WeakMap,M=new WeakMap,x=new WeakMap,y=new WeakMap,tt=new WeakSet,gt=function(){const t=[];for(let i=0;i<s(this,y);++i)t.push(new Array(s(this,y)));for(let i=0;i<s(this,y);++i)for(let n=0;n<s(this,y);++n){const u=s(this,x)===0?Number.MAX_VALUE:(1-s(this,x))/s(this,x);t[i][n]=Dt(1,u)}return t};function ft(r){return Math.floor(Math.random()*Math.floor(r))}var J;class At extends dt{constructor(t){super();o(this,J);a(this,J,t)}degree(t,i){return s(this,J)[t][i]}}J=new WeakMap;onmessage=async r=>{const{task:e,args:t}=r.data;switch(e){case"create":Lt(...t);break;case"solve":Rt(...t);break}};let nt=null,ot=null,ht=!1;function Lt(r,e,t){nt=new Nt(r,e,t),nt.setDebugOutput(pt),ot=nt.createProblem(new Ft)}async function Rt(r,e,t,i){const n=Date.now(),u=V.fuzzySolverNames()[r],d=new Mt;d.setTarget(e===-1?null:e),d.setTimeLimit(t===-1?null:t),d.setDebugOutput(pt),d.setDebugMode(i);const C=await V.createSolver(u);ht=i;const T=C.solve(ot,d),et=Date.now()-n,st=ot.degree();ht=!0,postMessage({result:T,time:et,ev:st,solver:C.name()})}function pt(r){ht&&postMessage({log:r})}export{Mt as M};

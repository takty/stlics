var at=Object.defineProperty;var _=n=>{throw TypeError(n)};var ot=(n,e,t)=>e in n?at(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var w=(n,e,t)=>ot(n,typeof e!="symbol"?e+"":e,t),J=(n,e,t)=>e.has(n)||_("Cannot "+t);var r=(n,e,t)=>(J(n,e,"read from private field"),t?t.call(n):e.get(n)),a=(n,e,t)=>e.has(n)?_("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),o=(n,e,t,s)=>(J(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),tt=(n,e,t)=>(J(n,e,"access private method"),t);var K=(n,e,t,s)=>({set _(i){o(n,e,i,t)},get _(){return r(n,e,s)}});var A,T;class rt{constructor(){a(this,A,-1);a(this,T,"");w(this,"userObject",null)}setIndex(e){o(this,A,e)}setName(e){o(this,T,e)}index(){return r(this,A)}name(){return r(this,T)}}A=new WeakMap,T=new WeakMap;var x;const v=class v extends rt{constructor(t){super();w(this,"d");w(this,"es",[]);w(this,"v",r(v,x));this.d=t}toString(){const t=this.name(),s=t?`(${t})`:"",i=this.isEmpty()?"<empty>":""+this.value();return`x${this.index()}${s} = ${i}`}size(){return this.es.length}at(t){return this.es.at(t)}has(t){return this.es.includes(t)}indexOf(t){return this.es.indexOf(t)}neighbors(){const t=[];for(const s of this.es)for(const i of s)i!==this&&t.push(i);return t}[Symbol.iterator](){return this.es[Symbol.iterator]()}connect(t){if(this.es.includes(t))throw new RangeError;this.es.push(t)}disconnect(t){if(!this.es.includes(t))throw new RangeError;this.es=this.es.filter(s=>s!==t)}domain(t){if(t===void 0)return this.d;this.d=t,this.clear()}assign(t){this.v=t}clear(){this.assign(r(v,x))}value(){return this.v}isEmpty(){return this.value()===r(v,x)}};x=new WeakMap,a(v,x,Number.MIN_VALUE);let X=v;class k{static create(e,t=null){if(Array.isArray(e))return new ht(e);if(t!==null)return new ut(e,t);throw new RangeError}}var d;class ht extends k{constructor(t){super();a(this,d);o(this,d,[...t])}contains(t){return r(this,d).includes(t)}indexOf(t){return r(this,d).indexOf(t)}size(){return r(this,d).length}at(t){return r(this,d)[t]}[Symbol.iterator](){return r(this,d)[Symbol.iterator]()}}d=new WeakMap;var m,y;class ut extends k{constructor(t,s){super();a(this,m);a(this,y);o(this,m,t|0),o(this,y,s|0)}contains(t){return r(this,m)<=t&&t<=r(this,y)}indexOf(t){return r(this,m)<=t&&t<=r(this,y)?t-r(this,m):-1}size(){return r(this,y)-r(this,m)+1}at(t){return r(this,m)+t}[Symbol.iterator](){let t=r(this,m);const s=r(this,y);return{next(){return t<=s?{value:t++,done:!1}:{value:null,done:!0}}}}}m=new WeakMap,y=new WeakMap;class U extends rt{constructor(t){super();w(this,"r");w(this,"es",[]);this.r=t}static create(t,s){return s.length===1?new lt(t,s[0]):s.length===2?new ct(t,s[0],s[1]):s.length===3?new ft(t,s[0],s[1],s[2]):new gt(t,...s)}toString(){const t=this.name(),s=t?`(${t})`:"",i=this.degree(),h=i<0?"UNDEFINED":""+i;return`c${this.index()}${s} = ${h}`}size(){return this.es.length}at(t){return this.es.at(t)}has(t){return this.es.includes(t)}indexOf(t){return this.es.indexOf(t)}neighbors(){const t=[];for(const s of this.es)for(const i of s)i!==this&&t.push(i);return t}[Symbol.iterator](){return this.es[Symbol.iterator]()}relation(){return this.r}}class lt extends U{constructor(e,t){super(e),this.es=[t]}emptySize(){return this.es[0].isEmpty()?1:0}isDefined(){return!this.es[0].isEmpty()}status(){return this.es[0].isEmpty()?-1:this.r(this.es[0].value())===1?1:0}degree(){return this.es[0].isEmpty()?-1:this.r(this.es[0].value())}}class ct extends U{constructor(e,t,s){super(e),this.es=[t,s]}emptySize(){let e=0;return this.es[0].isEmpty()&&++e,this.es[1].isEmpty()&&++e,e}isDefined(){return!this.es[0].isEmpty()&&!this.es[1].isEmpty()}status(){return this.es[0].isEmpty()||this.es[1].isEmpty()?-1:this.r(this.es[0].value(),this.es[1].value())===1?1:0}degree(){return this.es[0].isEmpty()||this.es[1].isEmpty()?-1:this.r(this.es[0].value(),this.es[1].value())}}class ft extends U{constructor(e,t,s,i){super(e),this.es=[t,s,i]}emptySize(){let e=0;return this.es[0].isEmpty()&&++e,this.es[1].isEmpty()&&++e,this.es[2].isEmpty()&&++e,e}isDefined(){return!this.es[0].isEmpty()&&!this.es[1].isEmpty()&&!this.es[2].isEmpty()}status(){return this.es[0].isEmpty()||this.es[1].isEmpty()||this.es[2].isEmpty()?-1:this.r(this.es[0].value(),this.es[1].value(),this.es[2].value())===1?1:0}degree(){return this.es[0].isEmpty()||this.es[1].isEmpty()||this.es[2].isEmpty()?-1:this.r(this.es[0].value(),this.es[1].value(),this.es[2].value())}}var E;class gt extends U{constructor(t,...s){super(t);a(this,E);this.es=[...s],o(this,E,new Array(this.es.length))}emptySize(){let t=0;for(const s of this.es)t+=s.isEmpty()?1:0;return t}isDefined(){for(const t of this.es)if(t.isEmpty())return!1;return!0}status(){for(let t=0;t<this.es.length;++t){const s=this.es[t];if(s.isEmpty())return-1;r(this,E)[t]=s.value()}return this.r(...r(this,E))===1?1:0}degree(){for(let t=0;t<this.es.length;++t){const s=this.es[t];if(s.isEmpty())return-1;r(this,E)[t]=s.value()}return this.r(...r(this,E))}}E=new WeakMap;var C,O,l,u;class mt{constructor(){a(this,C,e=>new X(e));a(this,O,(e,t)=>U.create(e,t));a(this,l,[]);a(this,u,[])}setVariableFactory(e){o(this,C,e)}setConstraintFactory(e){o(this,O,e)}addVariable(e){e.setIndex(r(this,l).length),r(this,l).push(e)}createDomain(e,t=null){if(Array.isArray(e))return k.create(e);if(t!==null)return k.create(e,t);throw new RangeError}createVariable(e,t=null,s){if(e instanceof X){const i=r(this,C).call(this,e.domain());return this.addVariable(i),i.setName(i.name()),i.assign(i.value()),i}else if(e instanceof k){if(t!==null&&!e.contains(t))throw new Error;const i=r(this,C).call(this,e);return this.addVariable(i),t!==null&&i.assign(t),s&&i.setName(s),i}throw new RangeError}createConstraint(e,t,s){const i=r(this,O).call(this,e,t);i.setIndex(r(this,u).length),r(this,u).push(i);for(const h of t)h.connect(i);return s&&i.setName(s),i}removeConstraint(e){const t=r(this,u).indexOf(e);r(this,u).splice(t,1);for(let s=t;s<r(this,u).length;++s)r(this,u)[s].setIndex(s);for(const s of e)s.disconnect(e)}clearAllVariables(){for(const e of r(this,l))e.clear()}reverseVariables(){r(this,l).reverse();for(let e=0;e<r(this,l).length;++e)r(this,l)[e].setIndex(e)}sortVariables(e){r(this,l).sort(e);for(let t=0;t<r(this,l).length;++t)r(this,l)[t].setIndex(t)}variables(){return r(this,l)}variableSize(){return r(this,l).length}variableAt(e){return r(this,l)[e]}variableOf(e){for(const t of r(this,l))if(t.name()===e)return t;return null}hasVariable(e){return r(this,l).includes(e)}constraints(){return r(this,u)}constraintSize(){return r(this,u).length}constraintAt(e){return r(this,u)[e]}constraintOf(e){for(const t of r(this,u))if(t.name()===e)return t;return null}hasConstraint(e){return r(this,u).includes(e)}constraintsBetween(e,t){const s=[];for(const i of e)i.has(t)&&s.push(i);return s}constraintDensity(){return r(this,u).length/r(this,l).length}emptySize(){let e=0;for(const t of r(this,l))e+=t.isEmpty()?1:0;return e}hasEmptyDomain(){for(const e of r(this,l))if(e.domain().size()===0)return!0;return!1}degree(){let e=1;for(const t of r(this,u)){const s=t.degree();if(s<0)return s;s<e&&(e=s)}return e}constraintsWithDegree(){const e=[];let t=1;for(const s of r(this,u)){const i=s.degree();i<t?(t=i,e.length=0,e.push(s)):i-t<Number.MIN_VALUE*10&&e.push(s)}return[e,t]}averageDegree(){let e=0;for(const t of r(this,u))e+=t.degree();return e/r(this,u).length}ratio(){return this.satisfiedConstraintSize()/r(this,u).length}satisfiedConstraintSize(){let e=0;for(const t of r(this,u))e+=t.status()===1?1:0;return e}violatingConstraintSize(){return r(this,u).length-this.satisfiedConstraintSize()}satisfiedConstraints(){const e=[];for(const t of r(this,u))t.status()===1&&e.push(t);return e}violatingConstraints(){const e=[];for(const t of r(this,u))t.status()===0&&e.push(t);return e}}C=new WeakMap,O=new WeakMap,l=new WeakMap,u=new WeakMap;var M,L,R,V,D,b,F,I,B,G,$;class dt{constructor(){a(this,M,!0);a(this,L,e=>console.log(e));a(this,R,()=>!1);a(this,V,Number.MAX_SAFE_INTEGER);a(this,D,null);a(this,b,.8);a(this,F,null);a(this,I,0);a(this,B,0);a(this,G,-1);a(this,$,0)}initialize(){o(this,I,r(this,D)===null?Number.MAX_VALUE:Date.now()+r(this,D)),o(this,B,0)}check(e=null){if(e!==null&&r(this,b)!==null&&r(this,b)<=e)return this.outputDebugString("Stop: Current evaluation value is above the target"),!0;if(r(this,V)<K(this,B)._++)return this.outputDebugString("Stop: Number of iterations has reached the limit"),!1;if(r(this,I)<Date.now())return this.outputDebugString("Stop: Time limit has been reached"),!1;if(e!==null&&r(this,F)!==null)if(e!==-1&&r(this,G)===e){if(r(this,F)<K(this,$)._++)return this.outputDebugString("Stop: Evaluation value has not changed for a certain number of times"),!1}else o(this,G,e),o(this,$,0);return null}solutionFound(e,t){return r(this,R).call(this,e,t)}outputDebugString(e){r(this,M)&&r(this,L).call(this,e)}isDebugMode(){return r(this,M)}isTargetAssigned(){return r(this,b)!==null}getTarget(){return r(this,b)}setIterationLimit(e=null){o(this,V,e===null?Number.MAX_SAFE_INTEGER:e)}setTimeLimit(e=null){o(this,D,e)}setTarget(e=null){o(this,b,e)}setSameEvaluationLimit(e=null){o(this,F,e)}setListener(e){o(this,R,e)}setDebugMode(e){o(this,M,e)}setDebugOutput(e){o(this,L,e)}}M=new WeakMap,L=new WeakMap,R=new WeakMap,V=new WeakMap,D=new WeakMap,b=new WeakMap,F=new WeakMap,I=new WeakMap,B=new WeakMap,G=new WeakMap,$=new WeakMap;class N{static crispSolverNames(){return["Forward Checking","Max Forward Checking","Local Changes","Breakout","GENET","Crisp SRS3"]}static fuzzySolverNames(){return["Full Checking","Fuzzy Forward Checking","Flexible Local Changes","Fuzzy Breakout","Fuzzy GENET","SRS3"]}static async createSolver(e){const t=await N.createCrispSolver(e);if(t)return t;const s=await N.createFuzzySolver(e);return s||null}static async createCrispSolver(e){switch(e.replaceAll(" ","")){case"ForwardChecking":case"forward-checking":const{ForwardChecking:t}=await import("./forward-checking-DNwZbBKm.js");return new t;case"MaxForwardChecking":case"max-forward-checking":const{MaxForwardChecking:s}=await import("./max-forward-checking-DSe8ybV5.js");return new s;case"LocalChanges":case"local-changes":const{LocalChanges:i}=await import("./local-changes-BxjdlJEe.js");return new i;case"Breakout":case"breakout":const{Breakout:h}=await import("./breakout-CO4D-Hta.js");return new h;case"GENET":case"genet":const{GENET:c}=await import("./genet-D2aHMGMG.js");return new c;case"CrispSRS3":case"crisp-srs3":const{CrispSRS3:S}=await import("./crisp-srs3-BZ1nCkBt.js");return new S}return null}static async createFuzzySolver(e){switch(e.replaceAll(" ","")){case"FullChecking":case"full-checking":const{FullChecking:t}=await import("./full-checking-Bu3lkn98.js");return new t;case"FuzzyForwardChecking":case"fuzzy-forward-checking":const{FuzzyForwardChecking:s}=await import("./fuzzy-forward-checking-BawU6poU.js");return new s;case"FlexibleLocalChanges":case"flexible-local-changes":const{FlexibleLocalChanges:i}=await import("./flexible-local-changes-rB_g-q6j.js");return new i;case"FuzzyBreakout":case"fuzzy-breakout":const{FuzzyBreakout:h}=await import("./fuzzy-breakout-C1zHpAdB.js");return new h;case"FuzzyGENET":case"fuzzy-genet":const{FuzzyGENET:c}=await import("./fuzzy-genet-qEjh2mlj.js");return new c;case"SRS3":case"srs3":const{SRS3:S}=await import("./srs3-Dd9DW4oI.js");return new S}return null}}function pt(n,e){const t=et(n);return t/(t+et(e))}function et(n){let e,t,s,i,h;if(1<n){e=Math.sqrt(2*n-1);do do{do{do t=Math.random(),s=2*Math.random()-1;while(1<=t*t+s*s||t===0);s=s/t,t=e*s+n-1}while(t<=0);i=(n-1)*Math.log(t/(n-1))-e*s}while(i<=-50);while((1+s*s)*Math.exp(i)<=Math.random())}else{e=Math.E/(n+Math.E);do Math.random()<e?(t=0,s=1,h=Math.random(),0<h&&(t=Math.exp(Math.log(h)/n),s=Math.exp(-t))):(h=Math.random(),t=1,s=0,0<h&&(t=1-Math.log(h),s=Math.exp((n-1)*Math.log(t))));while(Math.random()>=s)}return t}var j;class wt{constructor(){w(this,"_debug",!0);a(this,j,e=>console.log(e))}setDebugMode(e){this._debug=e}setDebugOutput(e){this._debugOutput=e}_debugOutput(e){this._debug&&r(this,j).call(this,e)}}j=new WeakMap;var f,z,p,g,P,it;class yt extends wt{constructor(t,s,i,h=null){super();a(this,P);a(this,f);a(this,z);a(this,p);a(this,g);o(this,f,t),o(this,z,s),o(this,p,i),o(this,g,h??t)}getVariableCount(){return r(this,f)}setVariableCount(t){o(this,f,t)}getDensity(){return r(this,z)}setDensity(t){o(this,z,t)}getAverageTightness(){return r(this,p)}setAverageTightness(t){o(this,p,t)}getDomainSize(){return r(this,g)}setDomainSize(t){o(this,g,t)}createProblem(t){const s=r(this,z)*((r(this,f)*r(this,f)-r(this,f))/2)|0,i=[];for(let h=0;h<r(this,f);++h)i.push(t.createVariable(t.createDomain(0,r(this,g)-1),0));for(;t.constraintSize()<s;){const h=st(r(this,f)),c=st(r(this,f));if(h!==c&&t.constraintsBetween(i[h],i[c]).length===0){const q=tt(this,P,it).call(this);t.createConstraint((W,H)=>q[W][H],[i[h],i[c]])}}return t}}f=new WeakMap,z=new WeakMap,p=new WeakMap,g=new WeakMap,P=new WeakSet,it=function(){const t=[];for(let s=0;s<r(this,g);++s)t.push(new Array(r(this,g)));for(let s=0;s<r(this,g);++s)for(let i=0;i<r(this,g);++i){const h=r(this,p)===0?Number.MAX_VALUE:(1-r(this,p))/r(this,p);t[s][i]=pt(1,h)}return t};function st(n){return Math.floor(Math.random()*Math.floor(n))}onmessage=async n=>{const{task:e,args:t}=n.data;switch(e){case"create":Et(...t);break;case"solve":bt(...t);break}};let Q=null,Y=null,Z=!1;function Et(n,e,t){Q=new yt(n,e,t),Q.setDebugOutput(nt),Y=Q.createProblem(new mt)}async function bt(n,e,t,s){const i=Date.now(),h=N.fuzzySolverNames()[n],c=new dt;c.setTarget(e===-1?null:e),c.setTimeLimit(t===-1?null:t),c.setDebugOutput(nt),c.setDebugMode(s);const S=await N.createSolver(h);Z=s;const q=S.solve(Y,c),W=Date.now()-i,H=Y.degree();Z=!0,postMessage({result:q,time:W,ev:H,solver:S.name()})}function nt(n){Z&&postMessage({log:n})}export{dt as M,X as V};

var y=r=>{throw TypeError(r)};var k=(r,e,i)=>e.has(r)||y("Cannot "+i);var t=(r,e,i)=>(k(r,e,"read from private field"),i?i.call(r):e.get(r)),l=(r,e,i)=>e.has(r)?y("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,i),m=(r,e,i,s)=>(k(r,e,"write to private field"),s?s.call(r,i):e.set(r,i),i),p=(r,e,i)=>(k(r,e,"access private method"),i);import{S as P,A as R}from"./assignment-list-6f7qSbJH.js";import{c as D,D as E,i as _}from"./problems-NShnYMbn.js";import"./worker-BjB7NO1g.js";var u,b,f,x,d,S,a,w,C,A,F,M;class T extends P{constructor(){super();l(this,a);l(this,u);l(this,b);l(this,f);l(this,x);l(this,d);l(this,S,!0)}setUsingMinimumRemainingValuesHeuristics(i){m(this,S,i)}name(){return"Max Forward Checking"}preprocess(){m(this,u,[...this.pro.variables()]),m(this,b,D(this.pro,t(this,u))),m(this,f,Array.from(t(this,u),i=>new E(i.domain().size()))),m(this,x,new R),m(this,d,this.pro.constraintSize()),this.pro.clearAllVariables(),this.monitor.initialize()}exec(){const i=p(this,a,w).call(this,0);return t(this,x).apply(),i===!0}}u=new WeakMap,b=new WeakMap,f=new WeakMap,x=new WeakMap,d=new WeakMap,S=new WeakMap,a=new WeakSet,w=function(i,s=0){if(i===this.pro.variableSize()){const o=this.pro.ratio();return t(this,x).setProblem(this.pro),this.monitor.outputDebugString(`	Evaluation ${o}`),s<t(this,d)&&(m(this,d,s),this.monitor.solutionFound(t(this,x),o))?!0:this.monitor.check(o)}let n=null;if((n=this.monitor.check())!==null)return n;const h=t(this,u)[t(this,S)?_(t(this,u),t(this,f)):i],g=h.domain(),c=t(this,f)[h.index()];for(let o=0,V=g.size();o<V;++o){if(c.isPruned(o))continue;h.assign(g.at(o));const z=s+p(this,a,M).call(this,h);if(!(t(this,d)<=z)){if((s+1<t(this,d)||p(this,a,C).call(this,i,h))&&(n=p(this,a,w).call(this,i+1,z),n!==null))break;for(const v of t(this,f))v.recover(i)}}if(n===null){for(const o of t(this,f))o.recover(i);h.clear()}return n},C=function(i,s){for(const n of t(this,u)){if(!n.isEmpty())continue;const h=p(this,a,A).call(this,s.index(),n.index()),g=t(this,f)[n.index()],c=n.domain();for(const o of h)if(o.emptyVariableSize()===1&&!p(this,a,F).call(this,i,n,c,g,o))return!1}return!0},A=function(i,s){return i<s?t(this,b)[s][i]:t(this,b)[i][s]},F=function(i,s,n,h,g){for(let c=0,o=n.size();c<o;++c)h.isPruned(c)||(s.assign(n.at(c)),g.isSatisfied()===0&&h.prune(c,i));return s.clear(),!h.isEmpty()},M=function(i){let s=0;for(const n of i)n.isSatisfied()===0&&++s;return s};export{T as MaxForwardChecking};
